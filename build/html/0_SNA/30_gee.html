

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GEE &mdash; EveryThing 2.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="EveryThing 2.0.0 documentation" href="../index.html"/>
        <link rel="next" title="Scientific Plots" href="50_plots.html"/>
        <link rel="prev" title="Sphinx" href="10_sphinx_rst.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> EveryThing
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption" role="heading"><span class="caption-text">SNA</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="10_sphinx_rst.html">Sphinx</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">GEE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#documents">Documents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#imagecollection">ImageCollection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#imagecollection-visualization">ImageCollection Visualization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gaia">GAIA 处理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">下载GAIA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">如何上传到gee</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">gee 投影</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">矢量与栅格总面积是不是相等的？</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">栅格区域太大时切片计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">造掩膜填空</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">GAIA 数据提取</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">焦点统计 密度计算 转矢量</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">层级焦点统计</a></li>
<li class="toctree-l3"><a class="reference internal" href="#buffer">城市中心与Buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#function">function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">获取中心</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">下载数据</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gallery">Gallery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id12">区域均值</a></li>
<li class="toctree-l3"><a class="reference internal" href="#landsat">landsat可视化</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ndvi">NDVI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">火灾</a></li>
<li class="toctree-l3"><a class="reference internal" href="#function-compute-area">function compute area</a></li>
<li class="toctree-l3"><a class="reference internal" href="#function-compute-ndvi">function compute NDVI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#focal">focal 斑块</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">双变量循环</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iterate">iterate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#courses">Courses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#string">string</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dictionary">dictionary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reducer">reducer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kernel">kernel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#apps">APPs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">获取landsat 数据列表与统计</a></li>
<li class="toctree-l3"><a class="reference internal" href="#landsat-ndvi">Landsat NDVI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#global-urban-extent-from-landsat">Global Urban Extent from Landsat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="50_plots.html">Scientific Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="51_pandas.html">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="52_matplotlib.html">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="53_R.html">R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Snippet/R.html">R</a></li>
<li class="toctree-l1"><a class="reference internal" href="31_Arcgis%26Frag.html">Arcgis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Snippet/python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="54_Javascript.html">Javascript</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discussion</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../2_DIS/11_debate.html">辩行记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_DIS/12_toc.html">TOC</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EveryThing</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>GEE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/0_SNA/30_gee.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gee">
<h1>GEE<a class="headerlink" href="#gee" title="Permalink to this headline">¶</a></h1>
<div class="section" id="documents">
<h2>Documents<a class="headerlink" href="#documents" title="Permalink to this headline">¶</a></h2>
<div class="section" id="imagecollection">
<h3>ImageCollection<a class="headerlink" href="#imagecollection" title="Permalink to this headline">¶</a></h3>
<div class="section" id="imagecollection-visualization">
<h4>ImageCollection Visualization<a class="headerlink" href="#imagecollection-visualization" title="Permalink to this headline">¶</a></h4>
<div class="section" id="collection-preparation">
<h5>Collection preparation<a class="headerlink" href="#collection-preparation" title="Permalink to this headline">¶</a></h5>
<div class="section" id="filtering">
<h6>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h6>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="gaia">
<h2>GAIA 处理<a class="headerlink" href="#gaia" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>下载GAIA<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">requests</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">re</span>
<span class="linenos"> 3</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://data.ess.tsinghua.edu.cn/data/GAIA/GAIA_1985_2018_00_008.tif&#39;</span>
<span class="linenos"> 4</span><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="c1">#if r.headers.get( &#39;Content-Type&#39;)== &#39;Content-Type&#39;:</span>
<span class="linenos"> 6</span><span class="n">r</span><span class="o">.</span><span class="n">content</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;demo.txt&quot;</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="linenos">10</span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;GAIA_1985_2018(_\-?\d</span><span class="si">{2}</span><span class="s2">)(_\-?\d</span><span class="si">{3}</span><span class="s2">).tif&quot;</span><span class="p">)</span>
<span class="linenos">13</span><span class="n">result</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
<span class="linenos">16</span>    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://data.ess.tsinghua.edu.cn/data/GAIA/GAIA_1985_2018&quot;</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.tif&quot;</span>
<span class="linenos">17</span>    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">18</span>    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;GAIA_1985_2018&quot;</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.tif&quot;</span>
<span class="linenos">19</span>    <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../GAIA_Data/&quot;</span><span class="o">+</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>如何上传到gee<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>!pip install --upgrade google-cloud-storage
<span class="linenos"> 2</span>!gsutil ls gs://gaia-zzz/
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>project_id = &#39;groovy-bay-266911&#39;
<span class="linenos"> 5</span>import uuid
<span class="linenos"> 6</span>bucket_name = &#39;colab-sample-bucket-&#39; + str(uuid.uuid1())
<span class="linenos"> 7</span>from google.colab import auth
<span class="linenos"> 8</span>auth.authenticate_user()
<span class="linenos"> 9</span>
<span class="linenos">10</span>!gcloud config set project {project_id}
<span class="linenos">11</span>
<span class="linenos">12</span>## test
<span class="linenos">13</span>with open(&#39;/tmp/to_upload_-01.txt&#39;, &#39;w&#39;) as f:
<span class="linenos">14</span>f.write(&#39;my sample file&#39;)
<span class="linenos">15</span>print(&#39;/tmp/to_upload.txt contains:&#39;)
<span class="linenos">16</span>!cat /tmp/to_upload_-01.txt
<span class="linenos">17</span>!gsutil cp /tmp/to_upload_-01.txt gs://gaia-zzz/
<span class="linenos">18</span>
<span class="linenos">19</span>lats = []
<span class="linenos">20</span>lats.append(&quot;%02d&quot;% 0 )
<span class="linenos">21</span>for i in range(1,80):
<span class="linenos">22</span>    lats.append(&quot;%02d&quot; % i)
<span class="linenos">23</span>    lats.append(&quot;%03d&quot; % -i)
<span class="linenos">24</span>for lat in lats:
<span class="linenos">25</span>    AssetID = &#39;users/zhouzz400/GAIA_2018_lat/GAIA_1985_2018_&#39;+lat
<span class="linenos">26</span>    ImageFile = &#39;gs://gaia-zzz/GAIA_1985_2018_&#39; + lat + &#39;.tif&#39;
<span class="linenos">27</span>    #print(ImageFile,AssetID)
<span class="linenos">28</span>    line = &quot;earthengine --no-use_cloud_api upload image --asset_id={AssetID} --nodata_value=255 {ImageFile}&quot;.format(AssetID=AssetID,ImageFile=ImageFile)
<span class="linenos">29</span>    print(line)
<span class="linenos">30</span>    !eval {line}
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>gee 投影<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>gee 使用geotools 库 不支持Interrupted_Goode_Homolosine
可以使用mollwide
<a class="reference external" href="https://gis.stackexchange.com/questions/272818/google-earth-engine-reprojection-to-non-epsg-defined-crs">https://gis.stackexchange.com/questions/272818/google-earth-engine-reprojection-to-non-epsg-defined-crs</a></p>
<dl class="simple">
<dt><a class="reference external" href="https://spatialreference.org/ref/sr-org/7619">https://spatialreference.org/ref/sr-org/7619</a></dt><dd><p>python接口会支持吗？</p>
</dd>
</dl>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">region</span> <span class="o">=</span> <span class="s2">&quot;SPA&quot;</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">boun</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/worldRegion&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;Abbrv&quot;</span><span class="p">,</span><span class="nx">region</span><span class="p">)).</span><span class="nx">geometry</span><span class="p">()</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">GAIA</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/GAIA&quot;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">boun</span><span class="p">).</span><span class="nx">mosaic</span><span class="p">().</span><span class="nx">clip</span><span class="p">(</span><span class="nx">boun</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="kd">var</span> <span class="nx">GAIA_year</span> <span class="o">=</span> <span class="nx">GAIA</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">4</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kd">var</span> <span class="nx">GAIA_viz</span> <span class="o">=</span> <span class="p">{</span><span class="nx">min</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">34</span><span class="p">,</span><span class="nx">palette</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;000000&quot;</span><span class="p">,</span><span class="s2">&quot;ff0000&quot;</span><span class="p">]}</span>
<span class="linenos">10</span><span class="c1">//Map.addLayer(GAIA,GAIA_viz)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="kd">function</span> <span class="nx">getArea</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="nx">boun</span><span class="p">){</span>
<span class="linenos">13</span><span class="kd">var</span> <span class="nx">area_imag</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">pixelArea</span><span class="p">())</span>
<span class="linenos">14</span><span class="kd">var</span> <span class="nx">sumarea</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">area_imag</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">(</span>
<span class="linenos">15</span>                <span class="p">{</span><span class="s2">&quot;reducer&quot;</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">(),</span>
<span class="linenos">16</span>                <span class="s2">&quot;scale&quot;</span><span class="o">:</span> <span class="mf">30</span><span class="p">,</span>
<span class="linenos">17</span>                <span class="s2">&quot;geometry&quot;</span><span class="o">:</span><span class="nx">boun</span>
<span class="linenos">18</span>                <span class="p">})</span>
<span class="linenos">19</span>                <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">20</span><span class="k">return</span> <span class="nx">sumarea</span><span class="p">}</span>
<span class="linenos">21</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">getArea</span><span class="p">(</span><span class="nx">GAIA_year</span><span class="p">,</span><span class="nx">boun</span><span class="p">)</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="c1">//Lambert cylindrical projection epsg:9843</span>
<span class="linenos">24</span><span class="c1">// WKT string</span>
<span class="linenos">25</span><span class="kd">var</span> <span class="nx">wkt</span> <span class="o">=</span> <span class="s1">&#39; \</span>
<span class="linenos">26</span><span class="s1">PROJCS[&quot;World_Mollweide&quot;, \</span>
<span class="linenos">27</span><span class="s1">    GEOGCS[&quot;GCS_WGS_1984&quot;, \</span>
<span class="linenos">28</span><span class="s1">    DATUM[&quot;WGS_1984&quot;, \</span>
<span class="linenos">29</span><span class="s1">        SPHEROID[&quot;WGS_1984&quot;,6378137,298.257223563]], \</span>
<span class="linenos">30</span><span class="s1">    PRIMEM[&quot;Greenwich&quot;,0], \</span>
<span class="linenos">31</span><span class="s1">    UNIT[&quot;Degree&quot;,0.017453292519943295]], \</span>
<span class="linenos">32</span><span class="s1">    PROJECTION[&quot;Mollweide&quot;], \</span>
<span class="linenos">33</span><span class="s1">    PARAMETER[&quot;False_Easting&quot;,0], \</span>
<span class="linenos">34</span><span class="s1">    PARAMETER[&quot;False_Northing&quot;,0], \</span>
<span class="linenos">35</span><span class="s1">    PARAMETER[&quot;Central_Meridian&quot;,0], \</span>
<span class="linenos">36</span><span class="s1">    UNIT[&quot;Meter&quot;,1], \</span>
<span class="linenos">37</span><span class="s1">    AUTHORITY[&quot;EPSG&quot;,&quot;54009&quot;]]&#39;</span><span class="p">;</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="kd">var</span> <span class="nx">proj_mollweide</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Projection</span><span class="p">(</span><span class="nx">wkt</span><span class="p">);</span>
<span class="linenos">40</span><span class="kd">var</span> <span class="nx">boun_moll</span> <span class="o">=</span> <span class="nx">boun</span><span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="nx">proj_mollweide</span><span class="p">,</span>
<span class="linenos">41</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">10</span><span class="p">))</span>
<span class="linenos">42</span><span class="nx">print</span><span class="p">(</span><span class="nx">boun_moll</span><span class="p">.</span><span class="nx">area</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">1000</span><span class="p">)))</span><span class="c1">//5010868555175.95</span>
<span class="linenos">43</span><span class="nx">print</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">area</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">1000</span><span class="p">)))</span><span class="c1">//5010868555175.796</span>
<span class="linenos">44</span><span class="nx">print</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">area</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">10</span><span class="p">),</span><span class="nx">proj_mollweide</span><span class="p">))</span><span class="c1">//5022090468716.392</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>矢量与栅格总面积是不是相等的？<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">boun2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/China_Provinces&quot;</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span><span class="s2">&quot;湖北省&quot;</span><span class="p">)).</span><span class="nx">geometry</span><span class="p">()</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kd">var</span> <span class="nx">GAIA</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/GAIA&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">boun2</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">GAIA</span><span class="p">.</span><span class="nx">mosaic</span><span class="p">().</span><span class="nx">clip</span><span class="p">(</span><span class="nx">boun2</span><span class="p">))</span>
<span class="linenos"> 8</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">boun2</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;mosaic area:&quot;</span><span class="p">,</span><span class="nx">getArea</span><span class="p">(</span><span class="nx">GAIA</span><span class="p">.</span><span class="nx">mosaic</span><span class="p">()))</span> <span class="c1">//185940066188.5224</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="kd">function</span> <span class="nx">getArea</span><span class="p">(</span><span class="nx">image</span><span class="p">){</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">image</span><span class="p">).</span><span class="nx">gte</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">boun2</span><span class="p">)</span>
<span class="linenos">13</span><span class="kd">var</span> <span class="nx">area_imag</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">pixelArea</span><span class="p">())</span>
<span class="linenos">14</span><span class="kd">var</span> <span class="nx">sumarea</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">area_imag</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">(</span>
<span class="linenos">15</span>                <span class="p">{</span><span class="s2">&quot;reducer&quot;</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">(),</span>
<span class="linenos">16</span>                <span class="s2">&quot;scale&quot;</span><span class="o">:</span> <span class="mf">300</span><span class="p">,</span>
<span class="linenos">17</span>                <span class="s2">&quot;geometry&quot;</span><span class="o">:</span><span class="nx">boun2</span>
<span class="linenos">18</span>                <span class="p">})</span>
<span class="linenos">19</span>                <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">20</span><span class="k">return</span> <span class="nx">sumarea</span>
<span class="linenos">21</span><span class="p">}</span>
<span class="linenos">22</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">GAIA</span><span class="p">.</span><span class="nx">toList</span><span class="p">(</span><span class="mf">10</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">getArea</span><span class="p">).</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">())</span>
<span class="linenos">23</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;map imgcol area:&quot;</span><span class="p">,</span><span class="nx">area</span><span class="p">)</span><span class="c1">//185905517767.81976</span>
<span class="linenos">24</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;boun area:&quot;</span><span class="p">,</span><span class="nx">boun2</span><span class="p">.</span><span class="nx">area</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">1</span><span class="p">)))</span><span class="c1">//186114667454.5676</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="c1">// peojection area</span>
<span class="linenos">27</span><span class="kd">var</span> <span class="nx">wkt</span> <span class="o">=</span> <span class="s1">&#39; \</span>
<span class="linenos">28</span><span class="s1">PROJCS[&quot;World_Mollweide&quot;, [&quot;GCS_WGS_1984&quot;, [&quot;WGS_1984&quot;,SPHEROID[&quot;WGS_1984&quot;,6378137,298.257223563]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.017453292519943295]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;False_Easting&quot;,0],PARAMETER[&quot;False_Northing&quot;,0],PARAMETER[&quot;Central_Meridian&quot;,0],UNIT[&quot;Meter&quot;,1],AUTHORITY[&quot;EPSG&quot;,&quot;54009&quot;]]&#39;</span><span class="p">;</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="kd">var</span> <span class="nx">proj_mollweide</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Projection</span><span class="p">(</span><span class="nx">wkt</span><span class="p">);</span>
<span class="linenos">31</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;boun transform area:&quot;</span><span class="p">,</span><span class="nx">boun2</span><span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="nx">proj_mollweide</span><span class="p">,</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">area</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">1</span><span class="p">)))</span> <span class="c1">//186114667454.5346</span>
<span class="linenos">32</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;boun areapro area:&quot;</span><span class="p">,</span><span class="nx">boun2</span><span class="p">.</span><span class="nx">area</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">10</span><span class="p">),</span><span class="nx">proj_mollweide</span><span class="p">))</span><span class="c1">//186531461977.6914</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="kd">function</span> <span class="nx">getAreaProject</span><span class="p">(</span><span class="nx">image</span><span class="p">){</span>
<span class="linenos">35</span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">image</span><span class="p">).</span><span class="nx">gte</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">reproject</span><span class="p">(</span><span class="nx">proj_mollweide</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">boun2</span><span class="p">)</span>
<span class="linenos">36</span><span class="kd">var</span> <span class="nx">area_imag</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">pixelArea</span><span class="p">())</span>
<span class="linenos">37</span><span class="kd">var</span> <span class="nx">sumarea</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">area_imag</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">(</span>
<span class="linenos">38</span>                <span class="p">{</span><span class="s2">&quot;reducer&quot;</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">(),</span>
<span class="linenos">39</span>                <span class="s2">&quot;scale&quot;</span><span class="o">:</span> <span class="mf">30</span><span class="p">,</span>
<span class="linenos">40</span>                <span class="s2">&quot;geometry&quot;</span><span class="o">:</span><span class="nx">boun2</span>
<span class="linenos">41</span>                <span class="p">})</span>
<span class="linenos">42</span>                <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">43</span><span class="k">return</span> <span class="nx">sumarea</span>
<span class="linenos">44</span><span class="p">}</span>
<span class="linenos">45</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">GAIA</span><span class="p">.</span><span class="nx">toList</span><span class="p">(</span><span class="mf">70</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">getArea</span><span class="p">).</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">())</span>
<span class="linenos">46</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;img reproject area:&quot;</span><span class="p">,</span><span class="nx">area</span><span class="p">)</span><span class="c1">//185905517767.81976</span>
<span class="linenos">47</span>
<span class="linenos">48</span><span class="nx">mosaic</span> <span class="nx">area</span><span class="o">:</span>
<span class="linenos">49</span><span class="mf">185940066188.5224</span>
<span class="linenos">50</span><span class="nx">map</span> <span class="nx">imgcol</span> <span class="nx">area</span><span class="o">:</span>
<span class="linenos">51</span><span class="mf">185905517767.81976</span>
<span class="linenos">52</span><span class="nx">boun</span> <span class="nx">area</span><span class="o">:</span>
<span class="linenos">53</span><span class="mf">186114667454.5676</span>
<span class="linenos">54</span><span class="nx">boun</span> <span class="nx">transform</span> <span class="nx">area</span><span class="o">:</span>
<span class="linenos">55</span><span class="mf">186114667454.5346</span>
<span class="linenos">56</span><span class="nx">boun</span> <span class="nx">areapro</span> <span class="nx">area</span><span class="o">:</span>
<span class="linenos">57</span><span class="mf">186531461977.6914</span>
<span class="linenos">58</span><span class="nx">img</span> <span class="nx">reproject</span> <span class="nx">area</span><span class="o">:</span>
<span class="linenos">59</span><span class="mf">185905517767.81976</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>栅格区域太大时切片计算<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Array</span><span class="p">(</span><span class="nx">lslat</span><span class="p">).</span><span class="nx">reshape</span><span class="p">([</span><span class="mf">60</span><span class="p">,</span><span class="mf">1</span><span class="p">])</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">region</span> <span class="o">=</span> <span class="s2">&quot;SPA&quot;</span>
<span class="linenos"> 3</span><span class="kd">var</span> <span class="nx">boun</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/worldRegion&quot;</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;Abbrv&quot;</span><span class="p">,</span><span class="nx">region</span><span class="p">)).</span><span class="nx">geometry</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">bound</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">().</span><span class="nx">coordinates</span><span class="p">().</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span>
<span class="linenos"> 6</span><span class="kd">var</span> <span class="nx">pro</span> <span class="o">=</span> <span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">().</span><span class="nx">projection</span><span class="p">()</span>
<span class="linenos"> 7</span><span class="nx">print</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">().</span><span class="nx">coordinates</span><span class="p">())</span>
<span class="linenos"> 8</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">())</span>
<span class="linenos"> 9</span><span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">floor</span><span class="p">()</span>
<span class="linenos">10</span><span class="kd">var</span> <span class="nx">right</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">ceil</span><span class="p">()</span>
<span class="linenos">11</span><span class="kd">var</span> <span class="nx">down</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">floor</span><span class="p">()</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">up</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">2</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">ceil</span><span class="p">()</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1">//92,236,-30,29</span>
<span class="linenos">15</span><span class="kd">var</span> <span class="nx">rec</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">([</span><span class="nx">left</span><span class="p">,</span> <span class="nx">down</span><span class="p">,</span><span class="nx">right</span><span class="p">,</span> <span class="nx">up</span><span class="p">],</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="c1">// var ls = ee.List([])</span>
<span class="linenos">18</span><span class="c1">// for(var i = left; i &lt; right; i++) {</span>
<span class="linenos">19</span><span class="c1">//   for (var j = down; i&lt; up; i++){</span>
<span class="linenos">20</span><span class="c1">//     var rec = ee.Geometry.Rectangle([i, j,i.add(1), j.add(1)],null,false)</span>
<span class="linenos">21</span><span class="c1">//     ls.evaluate(function(rec){  //行不通，push不进去</span>
<span class="linenos">22</span><span class="c1">//       ls.add(rec)</span>
<span class="linenos">23</span><span class="c1">//       return ls})</span>
<span class="linenos">24</span><span class="c1">//   }</span>
<span class="linenos">25</span><span class="c1">// }</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="c1">// var lslat = ee.List.sequence(down,up)</span>
<span class="linenos">28</span><span class="c1">// var lslng = ee.List.sequence(left,right)</span>
<span class="linenos">29</span><span class="kd">var</span> <span class="nx">down</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<span class="linenos">30</span><span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="mf">90</span><span class="p">)</span>
<span class="linenos">31</span><span class="kd">var</span> <span class="nx">lslat</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">.</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">down</span><span class="p">,</span><span class="nx">down</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">10</span><span class="p">))</span>
<span class="linenos">32</span><span class="kd">var</span> <span class="nx">lslng</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">.</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span><span class="nx">left</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">10</span><span class="p">))</span>
<span class="linenos">33</span><span class="kd">var</span> <span class="nx">ls</span> <span class="o">=</span> <span class="nx">lslat</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">lat</span><span class="p">){</span>
<span class="linenos">34</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">lslng</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">lng</span><span class="p">){</span>
<span class="linenos">35</span><span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="nx">lat</span><span class="p">,</span><span class="nx">lng</span><span class="p">])</span>
<span class="linenos">36</span><span class="p">})</span>
<span class="linenos">37</span><span class="k">return</span> <span class="nx">y</span>
<span class="linenos">38</span><span class="p">})</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="c1">//var array = ee.Array(ls).reshape([8700,2])</span>
<span class="linenos">41</span><span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Array</span><span class="p">(</span><span class="nx">ls</span><span class="p">).</span><span class="nx">reshape</span><span class="p">([</span><span class="mf">121</span><span class="p">,</span><span class="mf">2</span><span class="p">])</span>
<span class="linenos">42</span><span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">toList</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">point</span><span class="p">){</span>
<span class="linenos">43</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">point</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span>
<span class="linenos">44</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">point</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">))</span>
<span class="linenos">45</span><span class="kd">var</span> <span class="nx">rec</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">([</span><span class="nx">y</span><span class="p">,</span><span class="nx">x</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span> <span class="p">,</span><span class="nx">y</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span> <span class="nx">x</span><span class="p">],</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
<span class="linenos">46</span><span class="k">return</span> <span class="nx">rec</span>
<span class="linenos">47</span><span class="p">})</span>
<span class="linenos">48</span><span class="c1">//var rectg = ee.List(ee.Geometry.MultiPolygon(rect))</span>
<span class="linenos">49</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">MultiPolygon</span><span class="p">(</span><span class="nx">rect</span><span class="p">))</span>
<span class="linenos">50</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">rect</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fets</span><span class="p">){</span>
<span class="linenos">51</span><span class="kd">var</span> <span class="nx">fet</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">(</span><span class="nx">fets</span><span class="p">)</span>
<span class="linenos">52</span><span class="kd">var</span> <span class="nx">GAIA</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/GAIA&quot;</span><span class="p">)</span>
<span class="linenos">53</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">fet</span><span class="p">).</span><span class="nx">mosaic</span><span class="p">().</span><span class="nx">clip</span><span class="p">(</span><span class="nx">fet</span><span class="p">).</span><span class="nx">gte</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<span class="linenos">54</span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">GAIA</span><span class="p">)</span>
<span class="linenos">55</span><span class="kd">var</span> <span class="nx">area_imag</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">pixelArea</span><span class="p">())</span>
<span class="linenos">56</span><span class="kd">var</span> <span class="nx">sumarea</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">area_imag</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">(</span>
<span class="linenos">57</span>            <span class="p">{</span><span class="s2">&quot;reducer&quot;</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">(),</span>
<span class="linenos">58</span>            <span class="s2">&quot;scale&quot;</span><span class="o">:</span> <span class="mf">300</span><span class="p">,</span>
<span class="linenos">59</span>            <span class="s2">&quot;geometry&quot;</span><span class="o">:</span><span class="nx">fet</span>
<span class="linenos">60</span>            <span class="p">})</span>
<span class="linenos">61</span>            <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">62</span><span class="k">return</span> <span class="nx">sumarea</span>
<span class="linenos">63</span><span class="p">})</span>
<span class="linenos">64</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">area</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">())</span>
<span class="linenos">65</span><span class="nx">print</span><span class="p">(</span><span class="nx">area</span><span class="p">)</span>
<span class="linenos">66</span><span class="c1">//3151140115.2027273</span>
<span class="linenos">67</span><span class="c1">//6305539433.349972</span>
<span class="linenos">68</span><span class="c1">//1482707901266.5425</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>造掩膜填空<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">region</span> <span class="o">=</span> <span class="s2">&quot;SPA&quot;</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">boun</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/worldRegion&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;Abbrv&quot;</span><span class="p">,</span><span class="nx">region</span><span class="p">)).</span><span class="nx">geometry</span><span class="p">()</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">GAIA</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/GAIA&quot;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">boun</span><span class="p">).</span><span class="nx">mosaic</span><span class="p">().</span><span class="nx">clip</span><span class="p">(</span><span class="nx">boun</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="kd">var</span> <span class="nx">GAIA_viz</span> <span class="o">=</span> <span class="p">{</span><span class="nx">min</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">34</span><span class="p">,</span><span class="nx">palette</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;000000&quot;</span><span class="p">,</span><span class="s2">&quot;ff0000&quot;</span><span class="p">]}</span>
<span class="linenos"> 8</span><span class="c1">//Map.addLayer(GAIA,GAIA_viz)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kd">var</span> <span class="nx">GAIA_masked</span> <span class="o">=</span> <span class="nx">GAIA</span><span class="p">.</span><span class="nx">updateMask</span><span class="p">(</span><span class="nx">GAIA</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">1</span><span class="p">))</span>
<span class="linenos">11</span><span class="kd">var</span> <span class="nx">emp</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">constant</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">select</span><span class="p">([</span><span class="s2">&quot;constant&quot;</span><span class="p">],[</span><span class="s2">&quot;b1&quot;</span><span class="p">])</span>
<span class="linenos">12</span><span class="c1">//print(emp.get(&quot;system:band_names&quot;))</span>
<span class="linenos">13</span><span class="c1">//print(emp.propertyNames())</span>
<span class="linenos">14</span><span class="nx">print</span><span class="p">(</span><span class="nx">emp</span><span class="p">)</span>
<span class="linenos">15</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">([</span><span class="nx">GAIA_masked</span><span class="p">,</span><span class="nx">emp</span><span class="p">]).</span><span class="nx">mosaic</span><span class="p">()</span>
<span class="linenos">16</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">x</span><span class="p">,{</span><span class="nx">min</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">1</span><span class="p">,</span><span class="nx">palette</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;000000&quot;</span><span class="p">,</span><span class="s2">&quot;ff0000&quot;</span><span class="p">]})</span>
<span class="linenos">17</span><span class="nx">print</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">region</span> <span class="o">=</span> <span class="s2">&quot;SPA&quot;</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">boun</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/worldRegion&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;Abbrv&quot;</span><span class="p">,</span><span class="nx">region</span><span class="p">)).</span><span class="nx">geometry</span><span class="p">()</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">GAIA</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/GAIA&quot;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">boun</span><span class="p">).</span><span class="nx">mosaic</span><span class="p">()</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kd">var</span> <span class="nx">emp</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">1</span><span class="p">).</span><span class="nx">select</span><span class="p">([</span><span class="s2">&quot;constant&quot;</span><span class="p">],[</span><span class="s2">&quot;b1&quot;</span><span class="p">])</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kd">var</span> <span class="nx">GAIA_mask</span> <span class="o">=</span> <span class="nx">GAIA</span><span class="p">.</span><span class="nx">mask</span><span class="p">().</span><span class="nx">toUint8</span><span class="p">()</span>
<span class="linenos">11</span><span class="kd">var</span> <span class="nx">mask</span><span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">([</span><span class="nx">GAIA_mask</span><span class="p">,</span><span class="nx">GAIA</span><span class="p">]).</span><span class="nx">mosaic</span><span class="p">().</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">min</span><span class="p">())</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="nx">GAIA</span><span class="p">.</span><span class="nx">updateMask</span><span class="p">(</span><span class="nx">mask</span><span class="p">)</span>
<span class="linenos">13</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">g</span><span class="p">,{</span><span class="nx">min</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">34</span><span class="p">,</span><span class="nx">palette</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;000000&quot;</span><span class="p">,</span><span class="s2">&quot;ff0000&quot;</span><span class="p">]})</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="kd">var</span> <span class="nx">bound</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">().</span><span class="nx">coordinates</span><span class="p">().</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span>
<span class="linenos">16</span><span class="kd">var</span> <span class="nx">pro</span> <span class="o">=</span> <span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">().</span><span class="nx">projection</span><span class="p">()</span>
<span class="linenos">17</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">())</span>
<span class="linenos">18</span><span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">floor</span><span class="p">()</span>
<span class="linenos">19</span><span class="kd">var</span> <span class="nx">right</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">ceil</span><span class="p">()</span>
<span class="linenos">20</span><span class="kd">var</span> <span class="nx">down</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">floor</span><span class="p">()</span>
<span class="linenos">21</span><span class="kd">var</span> <span class="nx">up</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">2</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">ceil</span><span class="p">()</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="c1">//92,236,-30,29</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="kd">var</span> <span class="nx">rec</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">([</span><span class="nx">left</span><span class="p">,</span> <span class="nx">down</span><span class="p">,</span><span class="nx">right</span><span class="p">,</span> <span class="nx">up</span><span class="p">],</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="kd">var</span> <span class="nx">lslat</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">.</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">down</span><span class="p">,</span><span class="nx">up</span><span class="p">)</span>
<span class="linenos">28</span><span class="kd">var</span> <span class="nx">lslng</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">.</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span><span class="nx">right</span><span class="p">)</span>
<span class="linenos">29</span><span class="kd">var</span> <span class="nx">ls</span> <span class="o">=</span> <span class="nx">lslat</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">lat</span><span class="p">){</span>
<span class="linenos">30</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">lslng</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">lng</span><span class="p">){</span>
<span class="linenos">31</span>    <span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="nx">lat</span><span class="p">,</span><span class="nx">lng</span><span class="p">])</span>
<span class="linenos">32</span><span class="p">})</span>
<span class="linenos">33</span><span class="k">return</span> <span class="nx">y</span>
<span class="linenos">34</span><span class="p">})</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Array</span><span class="p">(</span><span class="nx">ls</span><span class="p">).</span><span class="nx">reshape</span><span class="p">([</span><span class="mf">8700</span><span class="p">,</span><span class="mf">2</span><span class="p">])</span>
<span class="linenos">37</span><span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">toList</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">point</span><span class="p">){</span>
<span class="linenos">38</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">point</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span>
<span class="linenos">39</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">point</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">))</span>
<span class="linenos">40</span><span class="kd">var</span> <span class="nx">rec</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">([</span><span class="nx">y</span><span class="p">,</span><span class="nx">x</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span> <span class="p">,</span><span class="nx">y</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span> <span class="nx">x</span><span class="p">],</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
<span class="linenos">41</span><span class="k">return</span> <span class="nx">rec</span>
<span class="linenos">42</span><span class="p">})</span>
<span class="linenos">43</span><span class="c1">//var rectg = ee.List(ee.Geometry.MultiPolygon(rect))</span>
<span class="linenos">44</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">MultiPolygon</span><span class="p">(</span><span class="nx">rect</span><span class="p">))</span>
<span class="linenos">45</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">rect</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fets</span><span class="p">){</span>
<span class="linenos">46</span><span class="kd">var</span> <span class="nx">fet</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">(</span><span class="nx">fets</span><span class="p">)</span>
<span class="linenos">47</span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">clip</span><span class="p">(</span><span class="nx">boun</span><span class="p">).</span><span class="nx">gte</span><span class="p">(</span><span class="mf">3</span><span class="p">))</span>
<span class="linenos">48</span><span class="kd">var</span> <span class="nx">area_imag</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">pixelArea</span><span class="p">())</span>
<span class="linenos">49</span><span class="kd">var</span> <span class="nx">sumarea</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">area_imag</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">(</span>
<span class="linenos">50</span>                <span class="p">{</span><span class="s2">&quot;reducer&quot;</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">(),</span>
<span class="linenos">51</span>                <span class="s2">&quot;scale&quot;</span><span class="o">:</span> <span class="mf">300</span><span class="p">,</span>
<span class="linenos">52</span>                <span class="s2">&quot;geometry&quot;</span><span class="o">:</span><span class="nx">fet</span>
<span class="linenos">53</span>                <span class="p">})</span>
<span class="linenos">54</span>                <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">55</span><span class="k">return</span> <span class="nx">sumarea</span>
<span class="linenos">56</span><span class="p">})</span>
<span class="linenos">57</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">area</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">())</span>
<span class="linenos">58</span><span class="nx">print</span><span class="p">(</span><span class="nx">area</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">bound</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">().</span><span class="nx">coordinates</span><span class="p">().</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">pro</span> <span class="o">=</span> <span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">().</span><span class="nx">projection</span><span class="p">()</span>
<span class="linenos"> 3</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">boun</span><span class="p">.</span><span class="nx">bounds</span><span class="p">())</span>
<span class="linenos"> 4</span><span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">floor</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">right</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">ceil</span><span class="p">()</span>
<span class="linenos"> 6</span><span class="kd">var</span> <span class="nx">down</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">floor</span><span class="p">()</span>
<span class="linenos"> 7</span><span class="kd">var</span> <span class="nx">up</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">bound</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mf">2</span><span class="p">)).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">)).</span><span class="nx">ceil</span><span class="p">()</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1">//92,236,-30,29</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="kd">var</span> <span class="nx">rec</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">([</span><span class="nx">left</span><span class="p">,</span> <span class="nx">down</span><span class="p">,</span><span class="nx">right</span><span class="p">,</span> <span class="nx">up</span><span class="p">],</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">down</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<span class="linenos">13</span><span class="kd">var</span> <span class="nx">lslat</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">.</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">down</span><span class="p">,</span><span class="nx">down</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">14</span><span class="p">),</span><span class="mf">6</span><span class="p">)</span>
<span class="linenos">14</span><span class="kd">var</span> <span class="nx">lslng</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">.</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span><span class="nx">left</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">24</span><span class="p">),</span><span class="mf">6</span><span class="p">)</span>
<span class="linenos">15</span><span class="c1">// var lslat = ee.List.sequence(down,up)</span>
<span class="linenos">16</span><span class="c1">// var lslng = ee.List.sequence(left,right)</span>
<span class="linenos">17</span><span class="kd">var</span> <span class="nx">ls</span> <span class="o">=</span> <span class="nx">lslat</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">lat</span><span class="p">){</span>
<span class="linenos">18</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">lslng</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">lng</span><span class="p">){</span>
<span class="linenos">19</span>    <span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="nx">lat</span><span class="p">,</span><span class="nx">lng</span><span class="p">])</span>
<span class="linenos">20</span><span class="p">})</span>
<span class="linenos">21</span><span class="k">return</span> <span class="nx">y</span>
<span class="linenos">22</span><span class="p">})</span>
<span class="linenos">23</span><span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Array</span><span class="p">(</span><span class="nx">ls</span><span class="p">).</span><span class="nx">reshape</span><span class="p">([</span><span class="mf">15</span><span class="p">,</span><span class="mf">2</span><span class="p">])</span>
<span class="linenos">24</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">toList</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">point</span><span class="p">){</span>
<span class="linenos">27</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">point</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span>
<span class="linenos">28</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">point</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mf">1</span><span class="p">))</span>
<span class="linenos">29</span><span class="kd">var</span> <span class="nx">rec</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">([</span><span class="nx">y</span><span class="p">,</span><span class="nx">x</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="mf">6</span><span class="p">)</span> <span class="p">,</span><span class="nx">y</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">6</span><span class="p">),</span> <span class="nx">x</span><span class="p">],</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
<span class="linenos">30</span><span class="k">return</span> <span class="nx">rec</span>
<span class="linenos">31</span><span class="p">})</span>
<span class="linenos">32</span><span class="c1">//var rectg = ee.List(ee.Geometry.MultiPolygon(rect))</span>
<span class="linenos">33</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">MultiPolygon</span><span class="p">(</span><span class="nx">rect</span><span class="p">))</span>
<span class="linenos">34</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">rect</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fets</span><span class="p">){</span>
<span class="linenos">35</span><span class="kd">var</span> <span class="nx">fet</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">(</span><span class="nx">fets</span><span class="p">)</span>
<span class="linenos">36</span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">clip</span><span class="p">(</span><span class="nx">boun</span><span class="p">).</span><span class="nx">gte</span><span class="p">(</span><span class="mf">3</span><span class="p">))</span>
<span class="linenos">37</span><span class="kd">var</span> <span class="nx">area_imag</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">pixelArea</span><span class="p">())</span>
<span class="linenos">38</span><span class="kd">var</span> <span class="nx">sumarea</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">area_imag</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">(</span>
<span class="linenos">39</span>                <span class="p">{</span><span class="s2">&quot;reducer&quot;</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">(),</span>
<span class="linenos">40</span>                <span class="s2">&quot;scale&quot;</span><span class="o">:</span> <span class="mf">300</span><span class="p">,</span>
<span class="linenos">41</span>                <span class="s2">&quot;geometry&quot;</span><span class="o">:</span><span class="nx">fet</span>
<span class="linenos">42</span>                <span class="p">})</span>
<span class="linenos">43</span>                <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">44</span><span class="k">return</span> <span class="nx">sumarea</span>
<span class="linenos">45</span><span class="p">})</span>
<span class="linenos">46</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">area</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">())</span>
<span class="linenos">47</span><span class="nx">print</span><span class="p">(</span><span class="nx">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3>GAIA 数据提取<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">year_dic</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Dictionary</span><span class="p">({</span><span class="mf">34</span><span class="o">:</span><span class="mf">1985</span><span class="p">,</span><span class="mf">33</span><span class="o">:</span><span class="mf">1986</span><span class="p">,</span><span class="mf">32</span><span class="o">:</span><span class="mf">1987</span><span class="p">,</span><span class="mf">31</span><span class="o">:</span><span class="mf">1988</span><span class="p">,</span>
<span class="linenos"> 2</span>    <span class="mf">30</span><span class="o">:</span><span class="mf">1989</span><span class="p">,</span><span class="mf">29</span><span class="o">:</span><span class="mf">1990</span><span class="p">,</span><span class="mf">28</span><span class="o">:</span><span class="mf">1991</span><span class="p">,</span><span class="mf">27</span><span class="o">:</span><span class="mf">1992</span><span class="p">,</span><span class="mf">26</span><span class="o">:</span><span class="mf">1993</span><span class="p">,</span><span class="mf">25</span><span class="o">:</span><span class="mf">1994</span><span class="p">,</span><span class="mf">24</span><span class="o">:</span><span class="mf">1995</span><span class="p">,</span><span class="mf">23</span><span class="o">:</span><span class="mf">1996</span><span class="p">,</span><span class="mf">22</span><span class="o">:</span><span class="mf">1997</span><span class="p">,</span><span class="mf">21</span><span class="o">:</span><span class="mf">1998</span><span class="p">,</span>
<span class="linenos"> 3</span>    <span class="mf">20</span><span class="o">:</span><span class="mf">1999</span><span class="p">,</span><span class="mf">19</span><span class="o">:</span><span class="mf">2000</span><span class="p">,</span><span class="mf">18</span><span class="o">:</span><span class="mf">2001</span><span class="p">,</span><span class="mf">17</span><span class="o">:</span><span class="mf">2002</span><span class="p">,</span><span class="mf">16</span><span class="o">:</span><span class="mf">2003</span><span class="p">,</span><span class="mf">15</span><span class="o">:</span><span class="mf">2004</span><span class="p">,</span><span class="mf">14</span><span class="o">:</span><span class="mf">2005</span><span class="p">,</span><span class="mf">13</span><span class="o">:</span><span class="mf">2006</span><span class="p">,</span><span class="mf">12</span><span class="o">:</span><span class="mf">2007</span><span class="p">,</span><span class="mf">11</span><span class="o">:</span><span class="mf">2008</span><span class="p">,</span>
<span class="linenos"> 4</span>    <span class="mf">10</span><span class="o">:</span><span class="mf">2009</span><span class="p">,</span> <span class="mf">9</span><span class="o">:</span><span class="mf">2010</span><span class="p">,</span> <span class="mf">8</span><span class="o">:</span><span class="mf">2011</span><span class="p">,</span> <span class="mf">7</span><span class="o">:</span><span class="mf">2012</span><span class="p">,</span> <span class="mf">6</span><span class="o">:</span><span class="mf">2013</span><span class="p">,</span> <span class="mf">5</span><span class="o">:</span><span class="mf">2014</span><span class="p">,</span> <span class="mf">4</span><span class="o">:</span><span class="mf">2015</span><span class="p">,</span> <span class="mf">3</span><span class="o">:</span><span class="mf">2016</span><span class="p">,</span> <span class="mf">2</span><span class="o">:</span><span class="mf">2017</span><span class="p">,</span> <span class="mf">1</span><span class="o">:</span><span class="mf">2018</span><span class="p">,})</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">yDic</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="mf">34</span><span class="p">,</span><span class="mf">29</span><span class="p">,</span><span class="mf">24</span><span class="p">,</span><span class="mf">19</span><span class="p">,</span><span class="mf">14</span><span class="p">,</span><span class="mf">9</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">1</span><span class="p">])</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kd">var</span> <span class="nx">gaia</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/GAIA&quot;</span><span class="p">)</span>
<span class="linenos"> 8</span>    <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">geometry</span><span class="p">).</span><span class="nx">mosaic</span><span class="p">().</span><span class="nx">clip</span><span class="p">(</span><span class="nx">geometry</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="c1">//Map.addLayer(gaia,{min:1,max:34,palette:[&quot;white&quot;,&quot;blue&quot;,&quot;red&quot;]})</span>
<span class="linenos">10</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">gaia</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">33</span><span class="p">))</span> <span class="c1">//  1986年</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>焦点统计 密度计算 转矢量<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// 34年渐变</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">sh</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/shanghai_GAIA&quot;</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="nx">print</span><span class="p">(</span><span class="nx">sh</span><span class="p">);</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">Viz_Color</span> <span class="o">=</span>  <span class="p">{</span><span class="nx">palette</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]}</span>
<span class="linenos"> 6</span><span class="kd">var</span> <span class="nx">Viz_GAIA</span> <span class="o">=</span> <span class="p">{</span><span class="nx">min</span><span class="o">:</span> <span class="mf">1</span><span class="p">,</span> <span class="nx">max</span><span class="o">:</span> <span class="mf">34</span><span class="p">,</span> <span class="nx">palette</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span> <span class="s1">&#39;FF0000&#39;</span><span class="p">]};</span>
<span class="linenos"> 7</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">sh</span><span class="p">,</span><span class="nx">Viz</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1">// 某一年不透水面</span>
<span class="linenos">10</span><span class="kd">var</span> <span class="nx">sh_10</span> <span class="o">=</span> <span class="nx">sh</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">9</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">Viz2</span> <span class="o">=</span> <span class="p">{</span><span class="nx">min</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span> <span class="nx">max</span><span class="o">:</span> <span class="mf">1</span><span class="p">,</span> <span class="nx">palette</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span> <span class="s1">&#39;FF0000&#39;</span><span class="p">]};</span>
<span class="linenos">13</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">sh_10</span><span class="p">,</span><span class="nx">Viz2</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="c1">// 焦点统计</span>
<span class="linenos">16</span><span class="kd">var</span> <span class="nx">ker_sq</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">square</span><span class="p">({</span>
<span class="linenos">17</span><span class="nx">radius</span><span class="o">:</span> <span class="mf">3</span><span class="p">,</span> <span class="nx">units</span><span class="o">:</span> <span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="nx">normalize</span><span class="o">:</span> <span class="kc">false</span>
<span class="linenos">18</span><span class="p">});</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1">// ee.Kernel.circle(7)</span>
<span class="linenos">21</span><span class="kd">var</span> <span class="nx">ker_st</span> <span class="o">=</span> <span class="nx">sh_10</span><span class="p">.</span><span class="nx">reduceNeighborhood</span><span class="p">({</span>
<span class="linenos">22</span><span class="nx">reducer</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>
<span class="linenos">23</span><span class="nx">kernel</span><span class="o">:</span> <span class="nx">ker_sq</span><span class="p">,</span>
<span class="linenos">24</span><span class="p">});</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="kd">var</span> <span class="nx">des_25</span> <span class="o">=</span> <span class="nx">ker_st</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">0.25</span><span class="p">).</span><span class="nx">selfMask</span><span class="p">().</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;Dens_25&#39;</span><span class="p">);</span>
<span class="linenos">27</span><span class="c1">//Map.addLayer(des_25,Viz4)</span>
<span class="linenos">28</span><span class="c1">//print(des_25)</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="c1">// 识别斑块</span>
<span class="linenos">31</span><span class="kd">var</span> <span class="nx">objectId</span> <span class="o">=</span> <span class="nx">des_25</span><span class="p">.</span><span class="nx">connectedComponents</span><span class="p">({</span>
<span class="linenos">32</span><span class="nx">connectedness</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span>
<span class="linenos">33</span><span class="nx">maxSize</span><span class="o">:</span> <span class="mf">256</span>
<span class="linenos">34</span><span class="p">});</span>
<span class="linenos">35</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">objectId</span><span class="p">.</span><span class="nx">randomVisualizer</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;Objects&#39;</span><span class="p">);</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="c1">// 栅格转矢量</span>
<span class="linenos">38</span><span class="kd">var</span> <span class="nx">des_25_v</span> <span class="o">=</span> <span class="nx">des_25</span><span class="p">.</span><span class="nx">reduceToVectors</span><span class="p">({</span>
<span class="linenos">39</span><span class="nx">scale</span><span class="o">:</span> <span class="mf">80</span><span class="p">,</span>
<span class="linenos">40</span><span class="nx">geometryType</span><span class="o">:</span> <span class="s1">&#39;polygon&#39;</span><span class="p">,</span>
<span class="linenos">41</span><span class="nx">eightConnected</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="linenos">42</span><span class="nx">labelProperty</span><span class="o">:</span> <span class="s1">&#39;zone&#39;</span><span class="p">,}</span>
<span class="linenos">43</span><span class="p">);</span>
<span class="linenos">44</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">des_25_v</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>层级焦点统计<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>焦点统计与focal的区别？
kernel种类对focal的影响。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">Viz_GAIA</span> <span class="o">=</span> <span class="p">{</span><span class="nx">min</span><span class="o">:</span> <span class="mf">1</span><span class="p">,</span> <span class="nx">max</span><span class="o">:</span> <span class="mf">34</span><span class="p">,</span> <span class="nx">palette</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span> <span class="s1">&#39;FF0000&#39;</span><span class="p">]};</span>
<span class="linenos"> 2</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">sh</span><span class="p">,</span><span class="nx">Viz_GAIA</span><span class="p">)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kd">var</span> <span class="nx">sh_10</span> <span class="o">=</span> <span class="nx">sh</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">9</span><span class="p">)</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kd">var</span> <span class="nx">ker_sq</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">circle</span><span class="p">({</span>
<span class="linenos"> 7</span><span class="nx">radius</span><span class="o">:</span> <span class="mf">10</span><span class="p">,</span> <span class="nx">units</span><span class="o">:</span> <span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="nx">normalize</span><span class="o">:</span> <span class="kc">false</span>
<span class="linenos"> 8</span><span class="p">});</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1">// ee.Kernel.circle(7)</span>
<span class="linenos">11</span><span class="kd">var</span> <span class="nx">ker_st1</span> <span class="o">=</span> <span class="nx">sh_10</span><span class="p">.</span><span class="nx">reduceNeighborhood</span><span class="p">({</span>
<span class="linenos">12</span><span class="nx">reducer</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>
<span class="linenos">13</span><span class="nx">kernel</span><span class="o">:</span> <span class="nx">ker_sq</span><span class="p">,</span>
<span class="linenos">14</span><span class="p">});</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="kd">var</span> <span class="nx">Viz_Dens</span> <span class="o">=</span> <span class="p">{</span><span class="nx">min</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span> <span class="nx">max</span><span class="o">:</span> <span class="mf">1</span><span class="p">,</span> <span class="nx">palette</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span> <span class="s1">&#39;FF0000&#39;</span><span class="p">]};</span>
<span class="linenos">17</span><span class="kd">var</span> <span class="nx">des_50_1</span> <span class="o">=</span> <span class="nx">ker_st1</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">0.7</span><span class="p">);</span>
<span class="linenos">18</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">des_50_1</span><span class="p">,</span><span class="nx">Viz_Dens</span><span class="p">)</span>
<span class="linenos">19</span><span class="nx">print</span><span class="p">(</span><span class="nx">des_50_1</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="kd">var</span> <span class="nx">ker_st2</span> <span class="o">=</span> <span class="nx">des_50_1</span><span class="p">.</span><span class="nx">reduceNeighborhood</span><span class="p">({</span>
<span class="linenos">22</span><span class="nx">reducer</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>
<span class="linenos">23</span><span class="nx">kernel</span><span class="o">:</span> <span class="nx">ker_sq</span><span class="p">,</span>
<span class="linenos">24</span><span class="p">});</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="kd">var</span> <span class="nx">des_50_2</span> <span class="o">=</span> <span class="nx">ker_st2</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">0.7</span><span class="p">);</span>
<span class="linenos">27</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">des_50_2</span><span class="p">,</span><span class="nx">Viz_Dens</span><span class="p">)</span>
<span class="linenos">28</span><span class="nx">print</span><span class="p">(</span><span class="nx">des_50_2</span><span class="p">)</span>
<span class="linenos">29</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="kd">var</span> <span class="nx">ker_st3</span> <span class="o">=</span> <span class="nx">des_50_2</span><span class="p">.</span><span class="nx">reduceNeighborhood</span><span class="p">({</span>
<span class="linenos">32</span><span class="nx">reducer</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>
<span class="linenos">33</span><span class="nx">kernel</span><span class="o">:</span> <span class="nx">ker_sq</span><span class="p">,</span>
<span class="linenos">34</span><span class="p">});</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="kd">var</span> <span class="nx">des_50_3</span> <span class="o">=</span> <span class="nx">ker_st3</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">0.7</span><span class="p">);</span>
<span class="linenos">37</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">des_50_3</span><span class="p">,</span><span class="nx">Viz_Dens</span><span class="p">)</span>
<span class="linenos">38</span><span class="nx">print</span><span class="p">(</span><span class="nx">des_50_3</span><span class="p">)</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="kd">var</span> <span class="nx">objectId</span> <span class="o">=</span> <span class="nx">des_50_3</span><span class="p">.</span><span class="nx">connectedComponents</span><span class="p">({</span>
<span class="linenos">41</span><span class="nx">connectedness</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span>
<span class="linenos">42</span><span class="nx">maxSize</span><span class="o">:</span> <span class="mf">256</span>
<span class="linenos">43</span><span class="p">});</span>
<span class="linenos">44</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">objectId</span><span class="p">.</span><span class="nx">randomVisualizer</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;Objects&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="buffer">
<h3>城市中心与Buffer<a class="headerlink" href="#buffer" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kd">var</span> <span class="nx">fid</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="mf">857683023</span><span class="p">);</span> <span class="c1">//墨西哥城</span>
<span class="linenos">2</span><span class="kd">var</span> <span class="nx">center</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/city_center&quot;</span><span class="p">)</span>
<span class="linenos">3</span>    <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;wof_id&quot;</span><span class="p">,</span><span class="nx">fid</span><span class="p">)).</span><span class="nx">geometry</span><span class="p">();</span>
<span class="linenos">4</span><span class="kd">var</span> <span class="nx">region</span> <span class="o">=</span> <span class="nx">center</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="mf">31000</span><span class="p">)</span>
<span class="linenos">5</span><span class="kd">var</span> <span class="nx">GAIA</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/GAIA&quot;</span><span class="p">)</span>
<span class="linenos">6</span>    <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">region</span><span class="p">).</span><span class="nx">mosaic</span><span class="p">().</span><span class="nx">clip</span><span class="p">(</span><span class="nx">region</span><span class="p">)</span>
<span class="linenos">7</span><span class="kd">var</span> <span class="nx">gaia_viz</span> <span class="o">=</span> <span class="p">{</span><span class="nx">min</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">34</span><span class="p">,</span><span class="nx">palette</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;FFFFFF&quot;</span><span class="p">,</span><span class="s2">&quot;FF0000&quot;</span><span class="p">]}</span>
<span class="linenos">8</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">GAIA</span><span class="p">,</span><span class="nx">gaia_viz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="function">
<h3>function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">function</span> <span class="nx">func1</span><span class="p">(</span><span class="nx">yIndex</span><span class="p">){</span>
<span class="linenos"> 2</span>    <span class="nx">yIndex</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">yIndex</span><span class="p">)</span>
<span class="linenos"> 3</span>    <span class="kd">var</span> <span class="nx">year</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">year_dic</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">yIndex</span><span class="p">))</span>
<span class="linenos"> 4</span>    <span class="kd">var</span> <span class="nx">GAIA_year</span> <span class="o">=</span> <span class="nx">GAIA</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="nx">yIndex</span><span class="p">)</span>
<span class="linenos"> 5</span>    <span class="kd">var</span> <span class="nx">water</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;JRC/GSW1_1/YearlyHistory&quot;</span><span class="p">)</span>
<span class="linenos"> 6</span>        <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span><span class="nx">year</span><span class="p">)).</span><span class="nx">first</span><span class="p">().</span><span class="nx">neq</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span>
<span class="linenos"> 7</span>    <span class="kd">var</span> <span class="nx">dis_list</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">.</span><span class="nx">sequence</span><span class="p">(</span><span class="mf">1000</span><span class="p">,</span><span class="mf">30000</span><span class="p">,</span><span class="mf">1000</span><span class="p">)</span>
<span class="linenos"> 8</span>    <span class="kd">function</span> <span class="nx">getUrban</span><span class="p">(</span><span class="nx">dis</span><span class="p">){</span>
<span class="linenos"> 9</span>        <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">center</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="nx">dis</span><span class="p">)</span>
<span class="linenos">10</span>        <span class="kd">var</span> <span class="nx">buffer_urban</span> <span class="o">=</span> <span class="nx">GAIA_year</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mf">1</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span>
<span class="linenos">11</span>        <span class="kd">var</span> <span class="nx">area_imag</span> <span class="o">=</span> <span class="nx">buffer_urban</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">pixelArea</span><span class="p">());</span>
<span class="linenos">12</span>        <span class="kd">var</span> <span class="nx">sumarea</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">area_imag</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">({</span><span class="s2">&quot;reducer&quot;</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">(),</span><span class="s2">&quot;scale&quot;</span><span class="o">:</span> <span class="mf">30</span><span class="p">,</span><span class="s2">&quot;maxPixels&quot;</span><span class="o">:</span> <span class="mf">1e9</span><span class="p">}).</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">13</span>        <span class="k">return</span> <span class="nx">sumarea</span>
<span class="linenos">14</span>    <span class="p">}</span>
<span class="linenos">15</span>    <span class="kd">var</span> <span class="nx">areaA_urban</span> <span class="o">=</span> <span class="nx">dis_list</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">getUrban</span><span class="p">)</span>
<span class="linenos">16</span>    <span class="k">return</span> <span class="nx">areaA_urban</span>
<span class="linenos">17</span><span class="p">}</span>
<span class="linenos">18</span><span class="nx">print</span><span class="p">(</span><span class="nx">func1</span><span class="p">(</span><span class="mf">34</span><span class="p">))</span>
<span class="linenos">19</span><span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">yDic</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">func1</span><span class="p">)</span>
<span class="linenos">20</span><span class="nx">print</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h3>获取中心<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="kd">var</span> <span class="nx">imageCollection</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG&quot;</span><span class="p">),</span>
<span class="linenos">  2</span>    <span class="nx">imageCollection2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;NOAA/DMSP-OLS/NIGHTTIME_LIGHTS&quot;</span><span class="p">),</span>
<span class="linenos">  3</span>    <span class="nx">table</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/China_Provinces&quot;</span><span class="p">);</span>
<span class="linenos">  4</span><span class="c1">// // var imgc = imageCollection.filterDate(&quot;2014-01-01&quot;,&quot;2016-01-01&quot;).select(&quot;avg_rad&quot;);</span>
<span class="linenos">  5</span><span class="c1">// var imgc = imageCollection2.filterDate(&quot;2011-01-01&quot;,&quot;2012-01-01&quot;).select(&quot;stable_lights&quot;);</span>
<span class="linenos">  6</span><span class="c1">// var img = imgc.reduce(ee.Reducer.max()).clip(table)</span>
<span class="linenos">  7</span><span class="c1">// //var img = imgc.first()</span>
<span class="linenos">  8</span><span class="c1">// var viz = {min:0,max:60,palette:[&quot;000000&quot;,&quot;0000FF&quot;,&quot;FF0000&quot;]}</span>
<span class="linenos">  9</span><span class="c1">// //Map.addLayer(img,viz);</span>
<span class="linenos"> 10</span><span class="c1">// print(img)</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span><span class="c1">// var ker_sq = ee.Kernel.square({</span>
<span class="linenos"> 13</span><span class="c1">//   radius: 10, units: &#39;pixels&#39;, normalize: false</span>
<span class="linenos"> 14</span><span class="c1">// });</span>
<span class="linenos"> 15</span>
<span class="linenos"> 16</span><span class="c1">//     // ee.Kernel.circle(7)</span>
<span class="linenos"> 17</span><span class="c1">// var ker_st = img.reduceNeighborhood({</span>
<span class="linenos"> 18</span><span class="c1">//   reducer: ee.Reducer.mean(),</span>
<span class="linenos"> 19</span><span class="c1">//   kernel: ker_sq,</span>
<span class="linenos"> 20</span><span class="c1">// }).gte(63).eq(1);</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="c1">// //var viz2 = {min:0,max:1,palette:[&quot;cccccc&quot;,&quot;FF0000&quot;],opacity:0.5}</span>
<span class="linenos"> 23</span><span class="c1">// var viz3 = {min:0,max:1,palette:[&quot;cccccc&quot;,&quot;0000FF&quot;]}</span>
<span class="linenos"> 24</span><span class="c1">// //Map.addLayer(img.gte(63).eq(1),viz2);</span>
<span class="linenos"> 25</span><span class="c1">// Map.addLayer(ker_st,viz3);</span>
<span class="linenos"> 26</span><span class="c1">// print(ker_st);</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span><span class="c1">// // // Define a boxcar or low-pass kernel.</span>
<span class="linenos"> 29</span><span class="c1">// // var boxcar = ee.Kernel.square({</span>
<span class="linenos"> 30</span><span class="c1">// //   radius: 100, units: &#39;pixels&#39;, normalize: true</span>
<span class="linenos"> 31</span><span class="c1">// // });</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span><span class="c1">// // // Smooth the image by convolving with the boxcar kernel.</span>
<span class="linenos"> 34</span><span class="c1">// // var smooth = ker_st.convolve(boxcar);</span>
<span class="linenos"> 35</span><span class="c1">// // Map.addLayer(smooth);</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="c1">// var center_area = ker_st.eq(1).selfMask();</span>
<span class="linenos"> 38</span><span class="c1">// Map.addLayer(center_area, {palette: &#39;FF00FF&#39;});</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span><span class="c1">// var objectId = center_area.connectedComponents({</span>
<span class="linenos"> 41</span><span class="c1">//   connectedness: ee.Kernel.plus(1),</span>
<span class="linenos"> 42</span><span class="c1">//   maxSize: 256</span>
<span class="linenos"> 43</span><span class="c1">// }).select(&quot;stable_lights_max_mean&quot;);</span>
<span class="linenos"> 44</span><span class="c1">// //Map.addLayer(objectId.randomVisualizer(), null, &#39;Objects&#39;);</span>
<span class="linenos"> 45</span><span class="c1">// print(objectId)</span>
<span class="linenos"> 46</span><span class="c1">// // Compute the number of pixels in each object defined by the &quot;labels&quot; band.</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span><span class="c1">// var des_25_v = objectId.reduceToVectors({</span>
<span class="linenos"> 49</span><span class="c1">//   geometry: table,</span>
<span class="linenos"> 50</span><span class="c1">//   scale:3000,</span>
<span class="linenos"> 51</span><span class="c1">//   geometryType: &#39;polygon&#39;,</span>
<span class="linenos"> 52</span><span class="c1">//   eightConnected: false,</span>
<span class="linenos"> 53</span><span class="c1">//   }</span>
<span class="linenos"> 54</span><span class="c1">//   );</span>
<span class="linenos"> 55</span><span class="c1">// // Display object pixel count to the Map.</span>
<span class="linenos"> 56</span><span class="c1">// Map.addLayer(des_25_v);</span>
<span class="linenos"> 57</span><span class="c1">// print(des_25_v)</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span>
<span class="linenos"> 60</span><span class="kd">var</span> <span class="nx">modis</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s1">&#39;OREGONSTATE/PRISM/AN81d&#39;</span><span class="p">).</span><span class="nx">first</span><span class="p">())</span>
<span class="linenos"> 61</span>    <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;ppt&#39;</span><span class="p">);</span>
<span class="linenos"> 62</span><span class="kd">var</span> <span class="nx">proj</span> <span class="o">=</span> <span class="nx">modis</span><span class="p">.</span><span class="nx">projection</span><span class="p">();</span>
<span class="linenos"> 63</span><span class="c1">// Load a Japan boundary from the Large Scale International Boundary dataset.</span>
<span class="linenos"> 64</span><span class="kd">var</span> <span class="nx">japan</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;USDOS/LSIB_SIMPLE/2017&#39;</span><span class="p">)</span>
<span class="linenos"> 65</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;country_na&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">));</span>
<span class="linenos"> 66</span>
<span class="linenos"> 67</span><span class="c1">// Load a 2012 nightlights image, clipped to the Japan border.</span>
<span class="linenos"> 68</span><span class="c1">// var nl2012 = ee.Image(&#39;NOAA/DMSP-OLS/NIGHTTIME_LIGHTS/F182013&#39;)</span>
<span class="linenos"> 69</span><span class="c1">//   .select(&#39;stable_lights&#39;)</span>
<span class="linenos"> 70</span><span class="c1">//   .clipToCollection(japan)</span>
<span class="linenos"> 71</span><span class="c1">// //  .reproject({crs:&quot;SR-ORG:6974&quot;});</span>
<span class="linenos"> 72</span><span class="c1">// Map.addLayer(nl2012)</span>
<span class="linenos"> 73</span><span class="kd">var</span> <span class="nx">nl</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s1">&#39;NOAA/DMSP-OLS/NIGHTTIME_LIGHTS/F182013&#39;</span><span class="p">)</span>
<span class="linenos"> 74</span><span class="kd">var</span> <span class="nx">projnl</span> <span class="o">=</span> <span class="nx">nl</span><span class="p">.</span><span class="nx">projection</span><span class="p">()</span>
<span class="linenos"> 75</span>
<span class="linenos"> 76</span>
<span class="linenos"> 77</span><span class="kd">var</span> <span class="nx">nl2012</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s1">&#39;NOAA/DMSP-OLS/NIGHTTIME_LIGHTS&#39;</span><span class="p">)</span>
<span class="linenos"> 78</span>    <span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s2">&quot;1993-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">)</span>
<span class="linenos"> 79</span>    <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;stable_lights&#39;</span><span class="p">)</span>
<span class="linenos"> 80</span>    <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">())</span>
<span class="linenos"> 81</span>    <span class="p">.</span><span class="nx">reproject</span><span class="p">({</span><span class="nx">crs</span><span class="o">:</span><span class="nx">projnl</span><span class="p">})</span>
<span class="linenos"> 82</span>    <span class="p">.</span><span class="nx">clipToCollection</span><span class="p">(</span><span class="nx">japan</span><span class="p">)</span>
<span class="linenos"> 83</span><span class="nx">print</span><span class="p">(</span><span class="nx">nl2012</span><span class="p">.</span><span class="nx">projection</span><span class="p">())</span>
<span class="linenos"> 84</span><span class="c1">//</span>
<span class="linenos"> 85</span><span class="c1">// .reduce(ee.Reducer.mean()) )</span>
<span class="linenos"> 86</span><span class="c1">// .clipToCollection(japan)</span>
<span class="linenos"> 87</span><span class="c1">//  .reproject({crs:&quot;SR-ORG:6974&quot;});</span>
<span class="linenos"> 88</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">nl2012</span><span class="p">)</span>
<span class="linenos"> 89</span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span><span class="kd">var</span> <span class="nx">zones2</span> <span class="o">=</span> <span class="nx">nl2012</span><span class="p">.</span><span class="nx">reduceResolution</span><span class="p">({</span>
<span class="linenos"> 92</span><span class="nx">reducer</span><span class="o">:</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>
<span class="linenos"> 93</span><span class="nx">maxPixels</span><span class="o">:</span><span class="mf">1024</span><span class="p">,}).</span><span class="nx">reproject</span><span class="p">({</span>
<span class="linenos"> 94</span>    <span class="nx">crs</span><span class="o">:</span><span class="nx">proj</span>
<span class="linenos"> 95</span><span class="p">});</span>
<span class="linenos"> 96</span>
<span class="linenos"> 97</span><span class="kd">var</span> <span class="nx">zones3</span> <span class="o">=</span> <span class="nx">zones2</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="mf">60</span><span class="p">).</span><span class="nx">selfMask</span><span class="p">()</span>
<span class="linenos"> 98</span><span class="c1">// Define arbitrary thresholds on the 6-bit nightlights image.</span>
<span class="linenos"> 99</span><span class="nx">print</span><span class="p">(</span><span class="nx">zones3</span><span class="p">);</span>
<span class="linenos">100</span><span class="c1">//Map.addLayer(zones3,{min:0,max:1,palette:[&quot;000000&quot;,&quot;FF00FF&quot;]});</span>
<span class="linenos">101</span>
<span class="linenos">102</span><span class="c1">//SR-ORG:6974</span>
<span class="linenos">103</span>
<span class="linenos">104</span><span class="kd">var</span> <span class="nx">objectId</span> <span class="o">=</span> <span class="nx">zones3</span><span class="p">.</span><span class="nx">connectedComponents</span><span class="p">({</span>
<span class="linenos">105</span>    <span class="nx">connectedness</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span>
<span class="linenos">106</span>    <span class="nx">maxSize</span><span class="o">:</span> <span class="mf">256</span>
<span class="linenos">107</span>    <span class="p">}).</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;stable_lights_mean&quot;</span><span class="p">);</span>
<span class="linenos">108</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">objectId</span><span class="p">.</span><span class="nx">randomVisualizer</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;Objects&#39;</span><span class="p">);</span>
<span class="linenos">109</span><span class="nx">print</span><span class="p">(</span><span class="nx">objectId</span><span class="p">);</span>
<span class="linenos">110</span><span class="c1">// Compute the number of pixels in each object defined by the &quot;labels&quot; band.</span>
<span class="linenos">111</span>
<span class="linenos">112</span><span class="kd">var</span> <span class="nx">des_25_v</span> <span class="o">=</span> <span class="nx">objectId</span><span class="p">.</span><span class="nx">reduceToVectors</span><span class="p">({</span>
<span class="linenos">113</span>    <span class="nx">geometry</span><span class="o">:</span> <span class="nx">japan</span><span class="p">,</span>
<span class="linenos">114</span>    <span class="nx">scale</span><span class="o">:</span><span class="mf">3000</span><span class="p">,</span>
<span class="linenos">115</span>    <span class="nx">tileScale</span> <span class="o">:</span><span class="mf">4</span><span class="p">,</span>
<span class="linenos">116</span>    <span class="nx">geometryType</span><span class="o">:</span> <span class="s1">&#39;polygon&#39;</span><span class="p">,</span>
<span class="linenos">117</span>    <span class="nx">eightConnected</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="linenos">118</span><span class="p">})</span>
<span class="linenos">119</span><span class="c1">// Display object pixel count to the Map.</span>
<span class="linenos">120</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">des_25_v</span><span class="p">,{</span><span class="nx">palette</span><span class="o">:</span><span class="s2">&quot;ffffff&quot;</span><span class="p">});</span>
<span class="linenos">121</span><span class="nx">print</span><span class="p">(</span><span class="nx">des_25_v</span><span class="p">)</span>
<span class="linenos">122</span>
<span class="linenos">123</span><span class="kd">var</span> <span class="nx">getCentroid</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">feature</span><span class="p">){</span>
<span class="linenos">124</span>    <span class="c1">//var keepProperties = [&#39;name&#39;, &#39;huc6&#39;, &#39;tnmid&#39;, &#39;areasqkm&#39;];</span>
<span class="linenos">125</span>    <span class="c1">// Get the centroid of the feature&#39;s geometry.</span>
<span class="linenos">126</span>    <span class="kd">var</span> <span class="nx">centroid</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">centroid</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">ErrorMargin</span><span class="p">(</span><span class="mf">10000</span><span class="p">));</span>
<span class="linenos">127</span>    <span class="c1">// Return a new Feature, copying properties from the old Feature.</span>
<span class="linenos">128</span>    <span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span><span class="nx">centroid</span><span class="p">)</span><span class="c1">//.copyProperties(feature, keepProperties);</span>
<span class="linenos">129</span><span class="p">};</span>
<span class="linenos">130</span>
<span class="linenos">131</span><span class="c1">// Map the centroid getting function over the features.</span>
<span class="linenos">132</span><span class="kd">var</span> <span class="nx">centroids</span> <span class="o">=</span> <span class="nx">des_25_v</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">getCentroid</span><span class="p">);</span>
<span class="linenos">133</span>
<span class="linenos">134</span><span class="c1">// Display the results.</span>
<span class="linenos">135</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">centroids</span><span class="p">,</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;FF0000&#39;</span><span class="p">},</span> <span class="s1">&#39;centroids&#39;</span><span class="p">);</span>
<span class="linenos">136</span>
<span class="linenos">137</span><span class="nx">print</span><span class="p">(</span><span class="nx">centroids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3>下载数据<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">water1</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s2">&quot;JRC/GSW1_1/YearlyHistory/1995&quot;</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">water2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s2">&quot;JRC/GSW1_1/YearlyHistory/1996&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="kd">var</span> <span class="nx">image</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">([</span><span class="nx">water1</span><span class="p">,</span><span class="nx">water2</span><span class="p">])</span>
<span class="linenos"> 4</span>    <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">()).</span><span class="nx">rename</span><span class="p">(</span><span class="s2">&quot;FVC&quot;</span><span class="p">).</span><span class="nx">toFloat</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="nx">print</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="kd">var</span> <span class="nx">geometry</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">([</span><span class="mf">179</span><span class="p">,</span> <span class="mf">90</span><span class="p">,</span> <span class="mf">180</span><span class="p">,</span> <span class="mf">89.9</span><span class="p">]);</span>
<span class="linenos"> 7</span><span class="nx">Export</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">toDrive</span><span class="p">({</span>
<span class="linenos"> 8</span>    <span class="nx">image</span><span class="o">:</span> <span class="nx">image</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YearlyHistory/1995&#39;</span><span class="p">,</span>
<span class="linenos">10</span>    <span class="nx">scale</span><span class="o">:</span> <span class="mf">30</span><span class="p">,</span>
<span class="linenos">11</span>    <span class="nx">region</span><span class="o">:</span> <span class="nx">geometry</span><span class="p">,</span>
<span class="linenos">12</span>    <span class="nx">fileFormat</span><span class="o">:</span> <span class="s1">&#39;GeoTIFF&#39;</span><span class="p">,</span>
<span class="linenos">13</span><span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="gallery">
<h2>Gallery<a class="headerlink" href="#gallery" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id12">
<h3>区域均值<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">point</span> <span class="o">=</span> <span class="cm">/* color: #98ff00 */</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Point</span><span class="p">([</span><span class="mf">114.3362584771894</span><span class="p">,</span> <span class="mf">30.54952805541824</span><span class="p">]),</span>
<span class="linenos"> 2</span>    <span class="nx">l8</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC08/C01/T1_TOA&quot;</span><span class="p">),</span>
<span class="linenos"> 3</span>    <span class="nx">bare</span> <span class="o">=</span> <span class="cm">/* color: #c24823 */</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Polygon</span><span class="p">(</span>
<span class="linenos"> 4</span>        <span class="p">[[[</span><span class="mf">114.30517811719619</span><span class="p">,</span> <span class="mf">30.554663336996253</span><span class="p">],</span>
<span class="linenos"> 5</span>        <span class="p">[</span><span class="mf">114.30161614362441</span><span class="p">,</span> <span class="mf">30.552224189574872</span><span class="p">],</span>
<span class="linenos"> 6</span>        <span class="p">[</span><span class="mf">114.30958338525011</span><span class="p">,</span> <span class="mf">30.55368954007891</span><span class="p">],</span>
<span class="linenos"> 7</span>        <span class="p">[</span><span class="mf">114.30803843285753</span><span class="p">,</span> <span class="mf">30.5546134528199</span><span class="p">]]]),</span>
<span class="linenos"> 8</span>    <span class="nx">veget</span> <span class="o">=</span> <span class="cm">/* color: #ff0000 */</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Polygon</span><span class="p">(</span>
<span class="linenos"> 9</span>        <span class="p">[[[</span><span class="mf">114.48716604174274</span><span class="p">,</span> <span class="mf">30.507213819178254</span><span class="p">],</span>
<span class="linenos">10</span>        <span class="p">[</span><span class="mf">114.4845928059624</span><span class="p">,</span> <span class="mf">30.5054401948097</span><span class="p">],</span>
<span class="linenos">11</span>        <span class="p">[</span><span class="mf">114.48682294356126</span><span class="p">,</span> <span class="mf">30.505144587441116</span><span class="p">],</span>
<span class="linenos">12</span>        <span class="p">[</span><span class="mf">114.4883667488358</span><span class="p">,</span> <span class="mf">30.505144633458844</span><span class="p">],</span>
<span class="linenos">13</span>        <span class="p">[</span><span class="mf">114.49162631694242</span><span class="p">,</span> <span class="mf">30.504848979348527</span><span class="p">],</span>
<span class="linenos">14</span>        <span class="p">[</span><span class="mf">114.49368490531106</span><span class="p">,</span> <span class="mf">30.506622614826078</span><span class="p">]]]),</span>
<span class="linenos">15</span>    <span class="nx">water</span> <span class="o">=</span> <span class="cm">/* color: #00ff00 */</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Polygon</span><span class="p">(</span>
<span class="linenos">16</span>        <span class="p">[[[</span><span class="mf">114.28774101355862</span><span class="p">,</span> <span class="mf">30.565245523015815</span><span class="p">],</span>
<span class="linenos">17</span>        <span class="p">[</span><span class="mf">114.28482277015041</span><span class="p">,</span> <span class="mf">30.561845853255953</span><span class="p">],</span>
<span class="linenos">18</span>        <span class="p">[</span><span class="mf">114.28516609290432</span><span class="p">,</span> <span class="mf">30.5602198821312</span><span class="p">],</span>
<span class="linenos">19</span>        <span class="p">[</span><span class="mf">114.28774101355862</span><span class="p">,</span> <span class="mf">30.559480795340228</span><span class="p">],</span>
<span class="linenos">20</span>        <span class="p">[</span><span class="mf">114.29237587073635</span><span class="p">,</span> <span class="mf">30.563619608862606</span><span class="p">]]]);</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="kd">var</span> <span class="nx">bands</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span><span class="s2">&quot;B5&quot;</span><span class="p">,</span><span class="s2">&quot;B6&quot;</span><span class="p">,</span><span class="s2">&quot;B7&quot;</span><span class="p">];</span>
<span class="linenos">23</span><span class="kd">var</span> <span class="nx">image</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">l8</span>
<span class="linenos">24</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">point</span><span class="p">)</span>
<span class="linenos">25</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="s2">&quot;CLOUD_COVER&quot;</span><span class="p">)</span>
<span class="linenos">26</span><span class="p">.</span><span class="nx">first</span><span class="p">())</span>
<span class="linenos">27</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">bands</span><span class="p">);</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">image</span><span class="p">,{</span><span class="nx">bands</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span><span class="s2">&quot;B2&quot;</span><span class="p">],</span><span class="nx">max</span><span class="o">:</span><span class="mf">0.3</span><span class="p">},</span><span class="s2">&quot;image&quot;</span><span class="p">);</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="kd">var</span> <span class="nx">bareMean</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">({</span>
<span class="linenos">32</span><span class="nx">reducer</span><span class="o">:</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>
<span class="linenos">33</span><span class="nx">geometry</span><span class="o">:</span><span class="nx">bare</span><span class="p">,</span>
<span class="linenos">34</span><span class="nx">scale</span><span class="o">:</span><span class="mf">30</span><span class="p">,</span>
<span class="linenos">35</span><span class="p">}).</span><span class="nx">values</span><span class="p">();</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="kd">var</span> <span class="nx">vegetMean</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">({</span>
<span class="linenos">38</span><span class="nx">reducer</span><span class="o">:</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>
<span class="linenos">39</span><span class="nx">geometry</span><span class="o">:</span><span class="nx">veget</span><span class="p">,</span>
<span class="linenos">40</span><span class="nx">scale</span><span class="o">:</span><span class="mf">30</span><span class="p">,</span>
<span class="linenos">41</span><span class="p">}).</span><span class="nx">values</span><span class="p">();</span>
<span class="linenos">42</span>
<span class="linenos">43</span><span class="kd">var</span> <span class="nx">waterMean</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">({</span>
<span class="linenos">44</span><span class="nx">reducer</span><span class="o">:</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>
<span class="linenos">45</span><span class="nx">geometry</span><span class="o">:</span><span class="nx">water</span><span class="p">,</span>
<span class="linenos">46</span><span class="nx">scale</span><span class="o">:</span><span class="mf">30</span><span class="p">,</span>
<span class="linenos">47</span><span class="p">}).</span><span class="nx">values</span><span class="p">();</span>
<span class="linenos">48</span>
<span class="linenos">49</span><span class="kd">var</span> <span class="nx">chart</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Chart</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">regions</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">([</span>
<span class="linenos">50</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span><span class="nx">bare</span><span class="p">,</span> <span class="p">{</span><span class="nx">label</span><span class="o">:</span><span class="s2">&quot;bare&quot;</span><span class="p">}),</span>
<span class="linenos">51</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span><span class="nx">veget</span><span class="p">,{</span><span class="nx">label</span><span class="o">:</span><span class="s2">&quot;vaget&quot;</span><span class="p">}),</span>
<span class="linenos">52</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span><span class="nx">water</span><span class="p">,{</span><span class="nx">label</span><span class="o">:</span><span class="s2">&quot;water&quot;</span><span class="p">})]),</span>
<span class="linenos">53</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span><span class="mf">30</span><span class="p">,</span><span class="s2">&quot;label&quot;</span><span class="p">,[</span><span class="mf">0.48</span><span class="p">,</span><span class="mf">0.56</span><span class="p">,</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.86</span><span class="p">,</span><span class="mf">1.61</span><span class="p">,</span><span class="mf">2.2</span><span class="p">]</span>
<span class="linenos">54</span><span class="p">);</span>
<span class="linenos">55</span><span class="nx">print</span><span class="p">(</span><span class="nx">chart</span><span class="p">);</span>
<span class="linenos">56</span>
<span class="linenos">57</span><span class="kd">var</span> <span class="nx">endmembers</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">cat</span><span class="p">([</span><span class="nx">bareMean</span><span class="p">,</span><span class="nx">vegetMean</span><span class="p">,</span><span class="nx">waterMean</span><span class="p">],</span><span class="mf">1</span><span class="p">);</span>
<span class="linenos">58</span><span class="kd">var</span> <span class="nx">arrayImage</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">toArray</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<span class="linenos">59</span><span class="kd">var</span> <span class="nx">unmixed</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">endmembers</span><span class="p">).</span><span class="nx">matrixSolve</span><span class="p">(</span><span class="nx">arrayImage</span><span class="p">);</span>
<span class="linenos">60</span><span class="kd">var</span> <span class="nx">unmixedImage</span> <span class="o">=</span> <span class="nx">unmixed</span><span class="p">.</span><span class="nx">arrayProject</span><span class="p">([</span><span class="mf">0</span><span class="p">])</span>
<span class="linenos">61</span>                        <span class="p">.</span><span class="nx">arrayFlatten</span><span class="p">([[</span><span class="s2">&quot;bare&quot;</span><span class="p">,</span><span class="s2">&quot;veget&quot;</span><span class="p">,</span><span class="s2">&quot;water&quot;</span><span class="p">]]);</span>
<span class="linenos">62</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">unmixedImage</span><span class="p">,{},</span><span class="s2">&quot;fractions&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="landsat">
<h3>landsat可视化<a class="headerlink" href="#landsat" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">//loading the image using the image ID</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">Souht_Texas</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC8_L1T/LC80260412016037LGN00&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">//zoom to the image</span>
<span class="linenos"> 5</span><span class="nx">Map</span><span class="p">.</span><span class="nx">centerObject</span><span class="p">(</span><span class="nx">Souht_Texas</span><span class="p">,</span><span class="mf">10</span><span class="p">);</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kd">var</span> <span class="nx">Color</span> <span class="o">=</span> <span class="p">{</span><span class="nx">bands</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;B5&quot;</span><span class="p">,</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span><span class="s2">&quot;B3&quot;</span><span class="p">],</span><span class="nx">min</span><span class="o">:</span> <span class="mf">5000</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span> <span class="mf">15000</span><span class="p">,</span><span class="nx">gamma</span><span class="o">:</span> <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1</span><span class="p">]};</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1">//add the image to the map at</span>
<span class="linenos">10</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">Souht_Texas</span><span class="p">,</span><span class="nx">Color</span><span class="p">,</span><span class="s2">&quot;True Color&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">//Location for bounds, in this case the city of El Paso,Use the inspector tool</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">city</span><span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="mf">114.3</span><span class="p">,</span><span class="mf">30.6</span><span class="p">);</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Create a variable using the Geometry function Point,lat and lon</span>
<span class="linenos"> 5</span><span class="c1">//Add the point to the map</span>
<span class="linenos"> 6</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">city</span><span class="p">);</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1">//Datas of intrest</span>
<span class="linenos"> 9</span><span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">(</span><span class="s2">&quot;2013-5-30&quot;</span><span class="p">);</span>
<span class="linenos">10</span><span class="kd">var</span> <span class="nx">finish</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">(</span><span class="s2">&quot;2015-12-1&quot;</span><span class="p">);</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">//create image collection</span>
<span class="linenos">13</span><span class="kd">var</span> <span class="nx">Wuhan</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC08/C01/T1&quot;</span><span class="p">)</span>
<span class="linenos">14</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">city</span><span class="p">)</span>
<span class="linenos">15</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span><span class="nx">finish</span><span class="p">)</span>
<span class="linenos">16</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="s2">&quot;CLOUD_COVER&quot;</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1">// Get the number of image</span>
<span class="linenos">19</span><span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="nx">Wuhan</span><span class="p">.</span><span class="nx">size</span><span class="p">();</span>
<span class="linenos">20</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;size of collection Wuhan&quot;</span><span class="p">,</span><span class="nx">count</span><span class="p">);</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1">//Sort by a cloud cover property,get the least cloud image</span>
<span class="linenos">23</span><span class="kd">var</span> <span class="nx">Best</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">Wuhan</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="s2">&quot;CLOUD_COVER&quot;</span><span class="p">).</span><span class="nx">first</span><span class="p">());</span>
<span class="linenos">24</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;size of collection Wuhan&quot;</span><span class="p">,</span><span class="nx">Best</span><span class="p">);</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="c1">//get metadata</span>
<span class="linenos">27</span><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">Best</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DATE_ACQUIRED&quot;</span><span class="p">)</span>
<span class="linenos">28</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;date taken&quot;</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="nx">Map</span><span class="p">.</span><span class="nx">centerObject</span><span class="p">(</span><span class="nx">Wuhan</span><span class="p">,</span><span class="mf">10</span><span class="p">);</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="kd">var</span> <span class="nx">Color</span> <span class="o">=</span> <span class="p">{</span><span class="nx">bands</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span><span class="s2">&quot;B2&quot;</span><span class="p">],</span><span class="nx">min</span><span class="o">:</span> <span class="mf">5000</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span> <span class="mf">15000</span><span class="p">,</span><span class="nx">gamma</span><span class="o">:</span> <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1</span><span class="p">]};</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="c1">//add the image to the map at</span>
<span class="linenos">35</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">Best</span><span class="p">,</span><span class="nx">Color</span><span class="p">,</span><span class="s2">&quot;True Color&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="ndvi">
<h3>NDVI<a class="headerlink" href="#ndvi" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">//Location for bounds, in this case the city of El Paso,Use the inspector tool</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">city</span><span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="mf">114.3</span><span class="p">,</span><span class="mf">30.6</span><span class="p">);</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Create a variable using the Geometry function Point,lat and lon</span>
<span class="linenos"> 5</span><span class="c1">//Add the point to the map</span>
<span class="linenos"> 6</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">city</span><span class="p">);</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1">//Datas of intrest</span>
<span class="linenos"> 9</span><span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">(</span><span class="s2">&quot;2013-5-30&quot;</span><span class="p">);</span>
<span class="linenos">10</span><span class="kd">var</span> <span class="nx">finish</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">(</span><span class="s2">&quot;2015-12-1&quot;</span><span class="p">);</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">//create image collection</span>
<span class="linenos">13</span><span class="kd">var</span> <span class="nx">Wuhan</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC08/C01/T1&quot;</span><span class="p">)</span>
<span class="linenos">14</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">city</span><span class="p">)</span>
<span class="linenos">15</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span><span class="nx">finish</span><span class="p">)</span>
<span class="linenos">16</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="s2">&quot;CLOUD_COVER&quot;</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1">// Get the number of image</span>
<span class="linenos">19</span><span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="nx">Wuhan</span><span class="p">.</span><span class="nx">size</span><span class="p">();</span>
<span class="linenos">20</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;size of collection Wuhan&quot;</span><span class="p">,</span><span class="nx">count</span><span class="p">);</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1">//Sort by a cloud cover property,get the least cloud image</span>
<span class="linenos">23</span><span class="kd">var</span> <span class="nx">Best</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">Wuhan</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="s2">&quot;CLOUD_COVER&quot;</span><span class="p">).</span><span class="nx">first</span><span class="p">());</span>
<span class="linenos">24</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;size of collection Wuhan&quot;</span><span class="p">,</span><span class="nx">Best</span><span class="p">);</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="c1">//get metadata</span>
<span class="linenos">27</span><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">Best</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DATE_ACQUIRED&quot;</span><span class="p">)</span>
<span class="linenos">28</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;date taken&quot;</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="nx">Map</span><span class="p">.</span><span class="nx">centerObject</span><span class="p">(</span><span class="nx">Wuhan</span><span class="p">,</span><span class="mf">10</span><span class="p">);</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="kd">var</span> <span class="nx">Color</span> <span class="o">=</span> <span class="p">{</span><span class="nx">bands</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span><span class="s2">&quot;B2&quot;</span><span class="p">],</span><span class="nx">min</span><span class="o">:</span> <span class="mf">5000</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span> <span class="mf">15000</span><span class="p">,</span><span class="nx">gamma</span><span class="o">:</span> <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1</span><span class="p">]};</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="c1">//add the image to the map at</span>
<span class="linenos">35</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">Best</span><span class="p">,</span><span class="nx">Color</span><span class="p">,</span><span class="s2">&quot;True Color&quot;</span><span class="p">);</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="c1">//----------------------------------------------------------------</span>
<span class="linenos">38</span><span class="kd">var</span> <span class="nx">B4_Red</span> <span class="o">=</span> <span class="nx">Best</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;B4&quot;</span><span class="p">);</span>
<span class="linenos">39</span><span class="kd">var</span> <span class="nx">B5_NIR</span> <span class="o">=</span> <span class="nx">Best</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;B5&quot;</span><span class="p">);</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="kd">var</span> <span class="nx">ndvi1</span> <span class="o">=</span> <span class="nx">B5_NIR</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="nx">B4_Red</span><span class="p">).</span><span class="nx">divide</span><span class="p">(</span><span class="nx">B5_NIR</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">B4_Red</span><span class="p">));</span>
<span class="linenos">42</span>
<span class="linenos">43</span><span class="kd">var</span> <span class="nx">ndvi2</span> <span class="o">=</span> <span class="nx">Best</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">44</span>    <span class="s2">&quot;(B5-B4)/(B5+B4&quot;</span><span class="p">,{</span>
<span class="linenos">45</span>        <span class="s2">&quot;B5&quot;</span><span class="o">:</span> <span class="nx">B5_NIR</span><span class="p">,</span>
<span class="linenos">46</span>        <span class="s2">&quot;B4&quot;</span><span class="o">:</span> <span class="nx">B4_Red</span>
<span class="linenos">47</span><span class="p">});</span>
<span class="linenos">48</span><span class="kd">var</span> <span class="nx">ndvi_palette</span> <span class="o">=</span>
<span class="linenos">49</span><span class="s1">&#39;FFFFFF, CE7E45, DF923D, F1B555, FCD163, 99B718, 74A901, 66A000, 529400,&#39;</span><span class="o">+</span>
<span class="linenos">50</span><span class="s1">&#39;3E8601, 207401, 056201, 004C00, 023B01, 012E01, 011D01, 011301&#39;</span><span class="p">;</span>
<span class="linenos">51</span>
<span class="linenos">52</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ndvi1</span><span class="p">,{</span><span class="nx">min</span><span class="o">:-</span><span class="mf">0.1</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">0.1</span><span class="p">,</span><span class="nx">palette</span><span class="o">:</span><span class="nx">ndvi_palette</span><span class="p">},</span><span class="s2">&quot;NDVI 1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h3>火灾<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s1">&#39;MODIS/006/MCD64A1&#39;</span><span class="p">)</span>
<span class="linenos"> 2</span>                <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">date</span><span class="p">(</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-01-01&#39;</span><span class="p">));</span>
<span class="linenos"> 3</span><span class="kd">var</span> <span class="nx">burnedArea</span> <span class="o">=</span> <span class="nx">dataset</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;BurnDate&#39;</span><span class="p">);</span>
<span class="linenos"> 4</span><span class="kd">var</span> <span class="nx">burnedAreaVis</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 5</span><span class="nx">min</span><span class="o">:</span> <span class="mf">30.0</span><span class="p">,</span>
<span class="linenos"> 6</span><span class="nx">max</span><span class="o">:</span> <span class="mf">365.0</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="nx">palette</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;4e0400&#39;</span><span class="p">,</span> <span class="s1">&#39;951003&#39;</span><span class="p">,</span> <span class="s1">&#39;c61503&#39;</span><span class="p">,</span> <span class="s1">&#39;ff1901&#39;</span><span class="p">],</span>
<span class="linenos"> 8</span><span class="p">};</span>
<span class="linenos"> 9</span><span class="nx">Map</span><span class="p">.</span><span class="nx">setCenter</span><span class="p">(</span><span class="mf">6.746</span><span class="p">,</span> <span class="mf">46.529</span><span class="p">,</span> <span class="mf">2</span><span class="p">);</span>
<span class="linenos">10</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">burnedArea</span><span class="p">,</span> <span class="nx">burnedAreaVis</span><span class="p">,</span> <span class="s1">&#39;Burned Area&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="function-compute-area">
<h3>function compute area<a class="headerlink" href="#function-compute-area" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">Cities</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/China_Cities&quot;</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="nx">print</span><span class="p">(</span><span class="nx">Cities</span><span class="p">);</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kd">function</span> <span class="nx">Add_Area</span><span class="p">(</span><span class="nx">feature</span><span class="p">){</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">the_Area</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">area</span><span class="p">())</span>
<span class="linenos"> 6</span><span class="k">return</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Area_km2&quot;</span><span class="p">,</span><span class="nx">the_Area</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span><span class="mf">1000</span><span class="o">*</span><span class="mf">1000</span><span class="p">))</span>
<span class="linenos"> 7</span><span class="p">}</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kd">var</span> <span class="nx">City_with_Area</span> <span class="o">=</span> <span class="nx">Cities</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">Add_Area</span><span class="p">);</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="nx">print</span><span class="p">(</span><span class="nx">Cities</span><span class="p">.</span><span class="nx">first</span><span class="p">(),</span><span class="nx">City_with_Area</span><span class="p">.</span><span class="nx">first</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="section" id="function-compute-ndvi">
<h3>function compute NDVI<a class="headerlink" href="#function-compute-ndvi" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">L8</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC08/C01/T1_TOA&quot;</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="mf">107.193</span><span class="p">,</span><span class="mf">29.1373</span><span class="p">))</span>
<span class="linenos"> 3</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s2">&quot;2019-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;B[4,5]&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mf">3</span><span class="p">);</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kd">function</span> <span class="nx">add_NDVI</span><span class="p">(</span><span class="nx">image</span><span class="p">){</span>
<span class="linenos"> 8</span><span class="kd">var</span> <span class="nx">NDVI</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">normalizedDifference</span><span class="p">([</span><span class="s2">&quot;B5&quot;</span><span class="p">,</span><span class="s2">&quot;B4&quot;</span><span class="p">]);</span>
<span class="linenos"> 9</span><span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">NDVI</span><span class="p">);</span>
<span class="linenos">10</span><span class="p">}</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">L8_NDVI</span> <span class="o">=</span> <span class="nx">L8</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">add_NDVI</span><span class="p">);</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="nx">print</span><span class="p">(</span><span class="nx">L8</span><span class="p">.</span><span class="nx">first</span><span class="p">(),</span><span class="nx">L8_NDVI</span><span class="p">.</span><span class="nx">first</span><span class="p">());</span>
<span class="linenos">15</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">L8_NDVI</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;nd&quot;</span><span class="p">));</span>
<span class="linenos">16</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">L8</span><span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mf">1</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;B[4,5]&quot;</span><span class="p">).</span><span class="nx">mean</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="section" id="focal">
<h3>focal 斑块<a class="headerlink" href="#focal" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">table2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/UrbanDensity50_2015&quot;</span><span class="p">),</span>
<span class="linenos"> 2</span>    <span class="nx">table</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/UrbanDensity100_2015&quot;</span><span class="p">),</span>
<span class="linenos"> 3</span>    <span class="nx">geometry</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Polygon</span><span class="p">(</span>
<span class="linenos"> 4</span>        <span class="p">[[[</span><span class="mf">100.99709998976684</span><span class="p">,</span> <span class="mf">33.5381776358804</span><span class="p">],</span>
<span class="linenos"> 5</span>        <span class="p">[</span><span class="mf">100.99709998976684</span><span class="p">,</span> <span class="mf">22.143132836963183</span><span class="p">],</span>
<span class="linenos"> 6</span>        <span class="p">[</span><span class="mf">126.17776405226684</span><span class="p">,</span> <span class="mf">22.143132836963183</span><span class="p">],</span>
<span class="linenos"> 7</span>        <span class="p">[</span><span class="mf">126.17776405226684</span><span class="p">,</span> <span class="mf">33.5381776358804</span><span class="p">]]],</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="kd">var</span> <span class="nx">demo</span> <span class="o">=</span> <span class="nx">table2</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">geometry</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">feature</span><span class="p">){</span>
<span class="linenos"> 9</span>    <span class="k">return</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span><span class="nx">demo</span><span class="o">:</span><span class="mf">1</span><span class="p">}).</span><span class="nx">centroid</span><span class="p">();</span>
<span class="linenos">10</span><span class="p">})</span>
<span class="linenos">11</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">table2</span><span class="p">)</span>
<span class="linenos">12</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">demo</span><span class="p">)</span>
<span class="linenos">13</span><span class="kd">var</span> <span class="nx">demo2</span> <span class="o">=</span> <span class="nx">table2</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">geometry</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">feature</span><span class="p">){</span>
<span class="linenos">14</span>    <span class="k">return</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span><span class="nx">demo</span><span class="o">:</span><span class="mf">1</span><span class="p">});</span>
<span class="linenos">15</span><span class="p">})</span>
<span class="linenos">16</span><span class="c1">// print(demo.limit(3))</span>
<span class="linenos">17</span><span class="kd">var</span> <span class="nx">image</span> <span class="o">=</span> <span class="nx">demo2</span><span class="p">.</span><span class="nx">reduceToImage</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="s2">&quot;demo&quot;</span><span class="p">]),</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">anyNonZero</span><span class="p">())</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="kd">var</span> <span class="nx">focal_2</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">focal_min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="s2">&quot;plus&quot;</span><span class="p">,</span><span class="s2">&quot;pixels&quot;</span><span class="p">,</span><span class="mf">15</span><span class="p">)</span>
<span class="linenos">20</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span>
<span class="linenos">21</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">focal_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h3>双变量循环<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kd">var</span> <span class="nx">X</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">])</span>
<span class="linenos">2</span><span class="kd">var</span> <span class="nx">Y</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">])</span>
<span class="linenos">3</span><span class="kd">var</span> <span class="nx">Z</span> <span class="o">=</span> <span class="nx">X</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span>
<span class="linenos">4</span><span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">y</span><span class="p">){</span>
<span class="linenos">5</span>    <span class="k">return</span> <span class="nx">x</span><span class="o">+</span><span class="nx">y</span>
<span class="linenos">6</span><span class="p">})</span>
<span class="linenos">7</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="iterate">
<h3>iterate<a class="headerlink" href="#iterate" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kd">var</span> <span class="nx">table</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/rawailnaeem/CA&quot;</span><span class="p">);</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">S1</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S1_GRD&quot;</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">table</span><span class="p">);</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">table</span><span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mf">1000</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="nx">print</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span>
<span class="linenos"> 7</span><span class="kd">var</span> <span class="nx">Sentinel1</span> <span class="o">=</span> <span class="nx">S1</span><span class="p">.</span><span class="nx">filterMetadata</span><span class="p">(</span><span class="s1">&#39;instrumentMode&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;IW&#39;</span><span class="p">)</span>
<span class="linenos"> 8</span>                <span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2016-04-01&#39;</span><span class="p">,</span><span class="s1">&#39;2016-08-30&#39;</span> <span class="p">)</span>
<span class="linenos"> 9</span>                <span class="p">.</span><span class="nx">filterMetadata</span><span class="p">(</span><span class="s1">&#39;resolution_meters&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span> <span class="p">,</span> <span class="mf">10</span><span class="p">)</span>
<span class="linenos">10</span>                <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">S1dates</span> <span class="o">=</span> <span class="nx">Sentinel1</span><span class="p">.</span><span class="nx">toList</span><span class="p">(</span><span class="nx">Sentinel1</span><span class="p">.</span><span class="nx">size</span><span class="p">()).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">img</span><span class="p">){</span>
<span class="linenos">13</span><span class="kd">var</span> <span class="nx">idate</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">img</span><span class="p">).</span><span class="nx">date</span><span class="p">();</span>
<span class="linenos">14</span><span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">.</span><span class="nx">fromYMD</span><span class="p">(</span>
<span class="linenos">15</span>    <span class="nx">idate</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span>
<span class="linenos">16</span>    <span class="nx">idate</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">),</span>
<span class="linenos">17</span>    <span class="nx">idate</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
<span class="linenos">18</span><span class="p">).</span><span class="nx">millis</span><span class="p">()</span>
<span class="linenos">19</span><span class="p">});</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="c1">// print images dates</span>
<span class="linenos">22</span><span class="nx">print</span><span class="p">(</span><span class="nx">S1dates</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">millis</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">23</span><span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">(</span><span class="nx">millis</span><span class="p">).</span><span class="nx">format</span><span class="p">();</span>
<span class="linenos">24</span><span class="p">}));</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="kd">var</span> <span class="nx">newfc</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">iterate</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">feat</span><span class="p">,</span> <span class="nx">ini</span><span class="p">){</span>
<span class="linenos">27</span><span class="c1">// cast</span>
<span class="linenos">28</span><span class="kd">var</span> <span class="nx">ini</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">(</span><span class="nx">ini</span><span class="p">);</span>
<span class="linenos">29</span><span class="kd">var</span> <span class="nx">feat</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span><span class="nx">feat</span><span class="p">);</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="c1">// get src date</span>
<span class="linenos">32</span><span class="kd">var</span> <span class="nx">srcd</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">String</span><span class="p">(</span><span class="nx">feat</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;SrcImgDate&#39;</span><span class="p">));</span>
<span class="linenos">33</span><span class="kd">var</span> <span class="nx">year</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">srcd</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">4</span><span class="p">));</span>
<span class="linenos">34</span><span class="kd">var</span> <span class="nx">month</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">srcd</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span> <span class="mf">6</span><span class="p">));</span>
<span class="linenos">35</span><span class="kd">var</span> <span class="nx">day</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">srcd</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">6</span><span class="p">,</span> <span class="mf">8</span><span class="p">));</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">.</span><span class="nx">fromYMD</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="p">).</span><span class="nx">millis</span><span class="p">();</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="kd">var</span> <span class="nx">condition</span> <span class="o">=</span> <span class="nx">S1dates</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">date</span><span class="p">);</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Algorithms</span><span class="p">.</span><span class="nx">If</span><span class="p">(</span><span class="nx">condition</span><span class="p">,</span> <span class="nx">ini</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">feat</span><span class="p">),</span> <span class="nx">ini</span><span class="p">);</span>
<span class="linenos">42</span><span class="p">},</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([])));</span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="kd">var</span> <span class="nx">newfc</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="nx">newfc</span><span class="p">);</span>
<span class="linenos">45</span>
<span class="linenos">46</span><span class="nx">print</span><span class="p">(</span><span class="nx">newfc</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="courses">
<h2>Courses<a class="headerlink" href="#courses" title="Permalink to this headline">¶</a></h2>
<div class="section" id="string">
<h3>string<a class="headerlink" href="#string" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// create</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">string</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">String</span><span class="p">(</span><span class="s2">&quot;helloworld&quot;</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="c1">// display</span>
<span class="linenos"> 4</span><span class="nx">print</span><span class="p">(</span><span class="nx">string</span><span class="p">);</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1">// change</span>
<span class="linenos"> 7</span><span class="kd">var</span> <span class="nx">cat_string</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">cat</span><span class="p">(</span><span class="s2">&quot;demo&quot;</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="nx">print</span><span class="p">(</span><span class="nx">cat_string</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="kd">var</span> <span class="nx">rep_string</span> <span class="o">=</span> <span class="nx">cat_string</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;zz&quot;</span><span class="p">,</span><span class="s2">&quot;g&quot;</span><span class="p">);</span><span class="c1">//global match</span>
<span class="linenos">10</span><span class="nx">print</span><span class="p">(</span><span class="nx">rep_string</span><span class="p">);</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">// split</span>
<span class="linenos">13</span><span class="kd">var</span> <span class="nx">spl_string</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">);</span>
<span class="linenos">14</span><span class="nx">print</span><span class="p">(</span><span class="nx">spl_string</span><span class="p">);</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="c1">// match</span>
<span class="linenos">17</span><span class="kd">var</span> <span class="nx">mat_string</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">);</span>
<span class="linenos">18</span><span class="nx">print</span><span class="p">(</span><span class="nx">mat_string</span><span class="p">);</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1">// slice</span>
<span class="linenos">21</span><span class="kd">var</span> <span class="nx">sli_string</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">5</span><span class="p">);</span>
<span class="linenos">22</span><span class="nx">print</span><span class="p">(</span><span class="nx">sli_string</span><span class="p">);</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1">// length</span>
<span class="linenos">25</span><span class="kd">var</span> <span class="nx">len_string</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">()</span>
<span class="linenos">26</span><span class="nx">print</span><span class="p">(</span><span class="nx">string</span><span class="p">,</span> <span class="nx">len_string</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="c1">// ## number</span>
<span class="linenos">29</span><span class="kd">var</span> <span class="nx">numb1</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="mf">1237834050</span><span class="p">);</span>
<span class="linenos">30</span><span class="kd">var</span> <span class="nx">numb2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="o">-</span><span class="mf">3.1435963</span><span class="p">);</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="c1">// transfer</span>
<span class="linenos">33</span><span class="kd">var</span> <span class="nx">int_numb2</span> <span class="o">=</span> <span class="nx">numb2</span><span class="p">.</span><span class="nx">int8</span><span class="p">()</span>
<span class="linenos">34</span><span class="c1">// int = toInt double = toDouble float = toFloat</span>
<span class="linenos">35</span><span class="nx">print</span><span class="p">(</span><span class="nx">int_numb2</span><span class="p">)</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="c1">// compare</span>
<span class="linenos">38</span><span class="c1">// eq neq gt gte lt lte</span>
<span class="linenos">39</span><span class="c1">// and or not</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="c1">// calculate</span>
<span class="linenos">42</span><span class="c1">//floor round ceil  abs sqrt exp log log10</span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="c1">// bitwise</span>
<span class="linenos">45</span><span class="kd">var</span> <span class="nx">numb3</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<span class="linenos">46</span><span class="kd">var</span> <span class="nx">numb4</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span>
<span class="linenos">47</span><span class="kd">var</span> <span class="nx">numb_And</span> <span class="o">=</span> <span class="nx">numb3</span><span class="p">.</span><span class="nx">bitwiseAnd</span><span class="p">(</span><span class="nx">numb4</span><span class="p">);</span>
<span class="linenos">48</span><span class="kd">var</span> <span class="nx">num_Or</span> <span class="o">=</span> <span class="nx">numb3</span><span class="p">.</span><span class="nx">bitwiseOr</span><span class="p">(</span><span class="nx">numb4</span><span class="p">);</span>
<span class="linenos">49</span><span class="nx">print</span><span class="p">(</span><span class="nx">numb_And</span><span class="p">,</span><span class="nx">num_Or</span><span class="p">);</span>
<span class="linenos">50</span><span class="c1">// leftshift</span>
<span class="linenos">51</span>
<span class="linenos">52</span><span class="c1">// a great examp</span>
<span class="linenos">53</span>    <span class="c1">// var meal= rice(50).wash(100, fliter).zheng(100).cheng(12,A&gt;B)</span>
</pre></div>
</div>
</div>
<div class="section" id="dictionary">
<h3>dictionary<a class="headerlink" href="#dictionary" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// create ee.Dictionary()</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">Dic_1</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Dictionary</span><span class="p">({</span>
<span class="linenos"> 3</span><span class="nx">Name</span><span class="o">:</span><span class="s2">&quot;demo&quot;</span><span class="p">,</span>
<span class="linenos"> 4</span><span class="nx">Age</span><span class="o">:</span><span class="s2">&quot;20&quot;</span>
<span class="linenos"> 5</span><span class="p">})</span>
<span class="linenos"> 6</span><span class="kd">var</span> <span class="nx">Dic_2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Dictionary</span><span class="p">({</span>
<span class="linenos"> 7</span><span class="nx">Weight</span><span class="o">:</span><span class="s2">&quot;30&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="nx">Hight</span><span class="o">:</span><span class="s2">&quot;30&quot;</span>
<span class="linenos"> 9</span><span class="p">})</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// change dic.combine() dic.set()</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">Dic_combine</span> <span class="o">=</span> <span class="nx">Dic_1</span><span class="p">.</span><span class="nx">combine</span><span class="p">(</span><span class="nx">Dic_2</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span><span class="c1">//use second first when conflict</span>
<span class="linenos">13</span><span class="nx">print</span><span class="p">(</span><span class="nx">Dic_combine</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="kd">var</span> <span class="nx">Dic_3</span> <span class="o">=</span> <span class="nx">Dic_1</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;30&quot;</span><span class="p">);</span> <span class="c1">// add or change</span>
<span class="linenos">16</span><span class="nx">print</span><span class="p">(</span><span class="nx">Dic_3</span><span class="p">);</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1">// iquiry dic.keys dic.get dic.values</span>
<span class="linenos">19</span><span class="nx">print</span><span class="p">(</span><span class="nx">Dic_1</span><span class="p">.</span><span class="nx">keys</span><span class="p">());</span>
<span class="linenos">20</span><span class="nx">print</span><span class="p">(</span><span class="nx">Dic_1</span><span class="p">.</span><span class="nx">values</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">));</span>
<span class="linenos">21</span><span class="nx">print</span><span class="p">(</span><span class="nx">Dic_1</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">));</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="c1">// compare dic.contains</span>
<span class="linenos">24</span><span class="nx">print</span><span class="p">(</span><span class="nx">Dic_1</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="s2">&quot;Height&quot;</span><span class="p">));</span> <span class="c1">// if exsist?</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="c1">// size dic.size()</span>
<span class="linenos">27</span><span class="nx">print</span><span class="p">(</span><span class="nx">Dic_1</span><span class="p">.</span><span class="nx">size</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="section" id="reducer">
<h3>reducer<a class="headerlink" href="#reducer" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">// .count/.countEvery/.first()</span>
<span class="linenos">  2</span><span class="kd">var</span> <span class="nx">Reducer_Count</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">count</span><span class="p">();</span>
<span class="linenos">  3</span><span class="kd">var</span> <span class="nx">Reducer_CountEvery</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">countEvery</span><span class="p">();</span>
<span class="linenos">  4</span><span class="kd">var</span> <span class="nx">Reducer_First</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">first</span><span class="p">();</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="kd">var</span> <span class="nx">Provinces_Number_1</span> <span class="o">=</span> <span class="nx">China_Provinces</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span>
<span class="linenos">  7</span><span class="nx">Reducer_Count</span><span class="p">,[</span><span class="s2">&quot;Name&quot;</span><span class="p">]);</span>
<span class="linenos">  8</span><span class="kd">var</span> <span class="nx">Provinces_Number_2</span> <span class="o">=</span> <span class="nx">China_Provinces</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span>
<span class="linenos">  9</span><span class="nx">Reducer_CountEvery</span><span class="p">,[]);</span> <span class="c1">// count every columns</span>
<span class="linenos"> 10</span><span class="kd">var</span> <span class="nx">Provinces_First</span> <span class="o">=</span> <span class="nx">China_Provinces</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span>
<span class="linenos"> 11</span><span class="nx">Reducer_First</span><span class="p">,[</span><span class="s2">&quot;Name&quot;</span><span class="p">]);</span>
<span class="linenos"> 12</span>
<span class="linenos"> 13</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">China_Provinces</span><span class="p">);</span>
<span class="linenos"> 14</span><span class="nx">print</span><span class="p">(</span><span class="nx">China_Provinces</span><span class="p">);</span>
<span class="linenos"> 15</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Reducer_Count&quot;</span><span class="p">,</span><span class="nx">Provinces_Number_1</span><span class="p">);</span>
<span class="linenos"> 16</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Reducer_CountEvery&quot;</span><span class="p">,</span><span class="nx">Provinces_Number_2</span><span class="p">);</span>
<span class="linenos"> 17</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Refucer_First&quot;</span><span class="p">,</span><span class="nx">Provinces_First</span><span class="p">);</span>
<span class="linenos"> 18</span>
<span class="linenos"> 19</span><span class="c1">// .frequencyHistogram()</span>
<span class="linenos"> 20</span><span class="nx">print</span><span class="p">(</span><span class="nx">China_Cities</span><span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mf">10</span><span class="p">));</span>
<span class="linenos"> 21</span><span class="kd">var</span> <span class="nx">FrequencyHiso_Reducer</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">frequencyHistogram</span><span class="p">();</span>
<span class="linenos"> 22</span><span class="kd">var</span> <span class="nx">City_Frequency</span> <span class="o">=</span> <span class="nx">China_Cities</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span><span class="nx">FrequencyHiso_Reducer</span><span class="p">,[</span><span class="s2">&quot;省份&quot;</span><span class="p">]);</span>
<span class="linenos"> 23</span>
<span class="linenos"> 24</span><span class="kd">var</span> <span class="nx">Fig_Histo</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Chart</span><span class="p">.</span><span class="nx">feature</span><span class="p">.</span><span class="nx">histogram</span><span class="p">(</span><span class="nx">China_Cities</span><span class="p">,</span><span class="s2">&quot;省份&quot;</span><span class="p">);</span>
<span class="linenos"> 25</span><span class="nx">print</span><span class="p">(</span><span class="nx">City_Frequency</span><span class="p">,</span><span class="nx">Fig_Histo</span><span class="p">);</span>
<span class="linenos"> 26</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">China_Cities</span><span class="p">);</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span><span class="c1">// .allNonZero/.anyNonZero()</span>
<span class="linenos"> 29</span><span class="kd">var</span> <span class="nx">No_Zero_Reducer</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">allNonZero</span><span class="p">();</span>
<span class="linenos"> 30</span><span class="kd">var</span> <span class="nx">Any_Non_Zero_Reducer</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">anyNonZero</span><span class="p">();</span>
<span class="linenos"> 31</span><span class="kd">var</span> <span class="nx">List_Test_1</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">9</span><span class="p">]);</span>
<span class="linenos"> 32</span><span class="kd">var</span> <span class="nx">List_Test_2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">6</span><span class="p">,</span><span class="mf">0</span><span class="p">]);</span>
<span class="linenos"> 33</span>
<span class="linenos"> 34</span><span class="kd">var</span> <span class="nx">Result_1</span> <span class="o">=</span> <span class="nx">List_Test_1</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">No_Zero_Reducer</span><span class="p">);</span>
<span class="linenos"> 35</span><span class="kd">var</span> <span class="nx">Result_2</span> <span class="o">=</span> <span class="nx">List_Test_1</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">Any_Non_Zero_Reducer</span><span class="p">);</span>
<span class="linenos"> 36</span><span class="kd">var</span> <span class="nx">Result_3</span> <span class="o">=</span> <span class="nx">List_Test_2</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">No_Zero_Reducer</span><span class="p">);</span>
<span class="linenos"> 37</span><span class="kd">var</span> <span class="nx">Result_4</span> <span class="o">=</span> <span class="nx">List_Test_2</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">Any_Non_Zero_Reducer</span><span class="p">);</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Result_1&quot;</span><span class="p">,</span><span class="nx">Result_1</span><span class="p">);</span>
<span class="linenos"> 40</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Result_2&quot;</span><span class="p">,</span><span class="nx">Result_2</span><span class="p">);</span>
<span class="linenos"> 41</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Result_3&quot;</span><span class="p">,</span><span class="nx">Result_3</span><span class="p">);</span>
<span class="linenos"> 42</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Result_4&quot;</span><span class="p">,</span><span class="nx">Result_4</span><span class="p">);</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span><span class="c1">// .toList()</span>
<span class="linenos"> 45</span><span class="nx">print</span><span class="p">(</span><span class="nx">China_Cities</span><span class="p">.</span><span class="nx">first</span><span class="p">());</span>
<span class="linenos"> 46</span><span class="kd">var</span> <span class="nx">Tolist_Reducer</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">toList</span><span class="p">();</span>
<span class="linenos"> 47</span><span class="kd">var</span> <span class="nx">City_List</span> <span class="o">=</span> <span class="nx">China_Cities</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span><span class="nx">Tolist_Reducer</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Prefecture&quot;</span><span class="p">]);</span>
<span class="linenos"> 48</span><span class="nx">print</span><span class="p">(</span><span class="nx">City_List</span><span class="p">);</span>
<span class="linenos"> 49</span>
<span class="linenos"> 50</span><span class="c1">// .toCollection()</span>
<span class="linenos"> 51</span><span class="kd">var</span> <span class="nx">Reducer_to_Collection</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">toCollection</span><span class="p">([</span><span class="s2">&quot;provinces&quot;</span><span class="p">,</span><span class="s2">&quot;cities&quot;</span><span class="p">]);</span><span class="c1">//rename</span>
<span class="linenos"> 52</span><span class="nx">print</span><span class="p">(</span><span class="nx">Reducer_to_Collection</span><span class="p">);</span>
<span class="linenos"> 53</span><span class="kd">var</span> <span class="nx">City_Collection</span> <span class="o">=</span> <span class="nx">China_Cities</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span><span class="nx">Reducer_to_Collection</span><span class="p">,[</span><span class="s2">&quot;省份&quot;</span><span class="p">,</span><span class="s2">&quot;Prefecture&quot;</span><span class="p">]);</span>
<span class="linenos"> 54</span><span class="nx">print</span><span class="p">(</span><span class="nx">City_Collection</span><span class="p">);</span>
<span class="linenos"> 55</span>
<span class="linenos"> 56</span><span class="c1">// .product/ sum/ mean/variance/sampleVariance/stdDev/sampleStdDev</span>
<span class="linenos"> 57</span><span class="kd">function</span> <span class="nx">Add_Area</span><span class="p">(</span><span class="nx">feature</span><span class="p">){</span>
<span class="linenos"> 58</span><span class="kd">var</span> <span class="nx">The_Area</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">area</span><span class="p">());</span>
<span class="linenos"> 59</span><span class="k">return</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Area_km2&quot;</span><span class="p">,</span> <span class="nx">The_Area</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span><span class="mf">1000</span><span class="o">*</span><span class="mf">1000</span><span class="p">));</span>
<span class="linenos"> 60</span><span class="p">}</span>
<span class="linenos"> 61</span><span class="kd">var</span> <span class="nx">City_WithArea</span> <span class="o">=</span> <span class="nx">China_Cities</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">Add_Area</span><span class="p">);</span>
<span class="linenos"> 62</span><span class="nx">print</span><span class="p">(</span><span class="nx">City_WithArea</span><span class="p">)</span>
<span class="linenos"> 63</span><span class="kd">var</span> <span class="nx">Reducer_Product</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">product</span><span class="p">();</span>
<span class="linenos"> 64</span><span class="c1">//var Reducer_Product = ee.Reducer.product();sum,mean,variance,sampleVariance,stdDev</span>
<span class="linenos"> 65</span><span class="kd">var</span> <span class="nx">Area_Product</span> <span class="o">=</span> <span class="nx">City_WithArea</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span><span class="nx">Reducer_Product</span><span class="p">,[</span><span class="s2">&quot;Area_km2&quot;</span><span class="p">]);</span>
<span class="linenos"> 66</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Area_Product&quot;</span><span class="p">,</span> <span class="nx">Area_Product</span><span class="p">)</span>
<span class="linenos"> 67</span>
<span class="linenos"> 68</span><span class="c1">// .max/min/minMax/median/mode</span>
<span class="linenos"> 69</span><span class="kd">var</span> <span class="nx">Reducer_Max</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">max</span><span class="p">()</span>
<span class="linenos"> 70</span><span class="kd">var</span> <span class="nx">Area_Max</span> <span class="o">=</span> <span class="nx">City_WithArea</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span><span class="nx">Reducer_Max</span><span class="p">,[</span><span class="s2">&quot;Area_km2&quot;</span><span class="p">])</span>
<span class="linenos"> 71</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Area_Max&quot;</span><span class="p">,</span><span class="nx">Area_Max</span><span class="p">)</span>
<span class="linenos"> 72</span>
<span class="linenos"> 73</span><span class="c1">// image max</span>
<span class="linenos"> 74</span><span class="kd">var</span> <span class="nx">image</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">select</span><span class="p">([</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span><span class="s2">&quot;B2&quot;</span><span class="p">]);</span>
<span class="linenos"> 75</span><span class="kd">var</span> <span class="nx">maxValue</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">max</span><span class="p">());</span>
<span class="linenos"> 76</span><span class="nx">Map</span><span class="p">.</span><span class="nx">centerObject</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="mf">8</span><span class="p">);</span><span class="c1">//zoom</span>
<span class="linenos"> 77</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">maxValue</span><span class="p">,{</span><span class="nx">max</span><span class="o">:</span><span class="mf">13000</span><span class="p">},</span><span class="s2">&quot;Maximum value image&quot;</span><span class="p">);</span>
<span class="linenos"> 78</span>
<span class="linenos"> 79</span><span class="c1">// intervalMean/percentile</span>
<span class="linenos"> 80</span><span class="c1">// 0, 50 mean</span>
<span class="linenos"> 81</span>
<span class="linenos"> 82</span><span class="c1">// linearFit()</span>
<span class="linenos"> 83</span><span class="kd">var</span> <span class="nx">Data_X</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="mf">12</span><span class="p">,</span><span class="mf">13</span><span class="p">,</span><span class="mf">14</span><span class="p">,</span><span class="mf">5</span><span class="p">]);</span>
<span class="linenos"> 84</span><span class="kd">var</span> <span class="nx">Data_Y</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="mf">14</span><span class="p">,</span><span class="mf">12</span><span class="p">,</span><span class="mf">41</span><span class="p">,</span><span class="mf">14</span><span class="p">]);</span>
<span class="linenos"> 85</span>
<span class="linenos"> 86</span><span class="kd">var</span> <span class="nx">Linear_Reducer</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">linearFit</span><span class="p">();</span>
<span class="linenos"> 87</span><span class="kd">var</span> <span class="nx">Fited</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">List</span><span class="p">([</span><span class="nx">Data_X</span><span class="p">,</span><span class="nx">Data_Y</span><span class="p">]).</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">Linear_Reducer</span><span class="p">);</span>
<span class="linenos"> 88</span><span class="nx">print</span><span class="p">(</span><span class="nx">Fited</span><span class="p">);</span>
<span class="linenos"> 89</span>
<span class="linenos"> 90</span><span class="c1">// linearFit use to pridict weather</span>
<span class="linenos"> 91</span><span class="kd">var</span> <span class="nx">createTimeBand</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">image</span><span class="p">){</span>
<span class="linenos"> 92</span><span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">metadata</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">).</span><span class="nx">divide</span><span class="p">(</span><span class="mf">1e18</span><span class="p">));</span>
<span class="linenos"> 93</span><span class="p">}</span>
<span class="linenos"> 94</span><span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;NASA/NEX-DCP30_ENSEMBLE_STATS&quot;</span><span class="p">)</span>
<span class="linenos"> 95</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;scenario&quot;</span><span class="p">,</span><span class="s2">&quot;rcp85&quot;</span><span class="p">))</span>
<span class="linenos"> 96</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">(</span><span class="s2">&quot;2006-01-01&quot;</span><span class="p">),</span><span class="nx">ee</span><span class="p">.</span><span class="nb">Date</span><span class="p">(</span><span class="s2">&quot;2050-01-01&quot;</span><span class="p">))</span>
<span class="linenos"> 97</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">createTimeBand</span><span class="p">);</span>
<span class="linenos"> 98</span><span class="kd">var</span> <span class="nx">linearFit</span> <span class="o">=</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">select</span><span class="p">([</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span><span class="s2">&quot;pr_mean&quot;</span><span class="p">])</span>
<span class="linenos"> 99</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">linearFit</span><span class="p">());</span>
<span class="linenos">100</span><span class="nx">print</span><span class="p">(</span><span class="nx">linearFit</span><span class="p">);</span>
<span class="linenos">101</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">linearFit</span><span class="p">,</span>
<span class="linenos">102</span><span class="p">{</span><span class="nx">min</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span>
<span class="linenos">103</span><span class="nx">max</span><span class="o">:</span><span class="p">[</span><span class="o">-</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">8e-5</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span>
<span class="linenos">104</span><span class="nx">bands</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span><span class="s2">&quot;scale&quot;</span><span class="p">]},</span>
<span class="linenos">105</span><span class="s2">&quot;fit&quot;</span><span class="p">);</span>
<span class="linenos">106</span><span class="c1">// setOutputs/getOutputs</span>
<span class="linenos">107</span><span class="kd">var</span> <span class="nx">Reducer_Original</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">minMax</span><span class="p">();</span>
<span class="linenos">108</span><span class="kd">var</span> <span class="nx">Reducer_Modified</span> <span class="o">=</span> <span class="nx">Reducer_Original</span><span class="p">.</span><span class="nx">setOutputs</span><span class="p">([</span><span class="s2">&quot;Range_Low&quot;</span><span class="p">,</span><span class="s2">&quot;Range_High&quot;</span><span class="p">]);</span>
<span class="linenos">109</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span><span class="nx">Reducer_Original</span><span class="p">.</span><span class="nx">getOutputs</span><span class="p">());</span>
<span class="linenos">110</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Modified&quot;</span><span class="p">,</span><span class="nx">Reducer_Modified</span><span class="p">.</span><span class="nx">getOutputs</span><span class="p">());</span>
<span class="linenos">111</span>
<span class="linenos">112</span><span class="c1">// combine</span>
<span class="linenos">113</span><span class="kd">var</span> <span class="nx">Reducer_Max</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">max</span><span class="p">();</span>
<span class="linenos">114</span><span class="kd">var</span> <span class="nx">Reducer_Min</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">min</span><span class="p">();</span>
<span class="linenos">115</span><span class="kd">var</span> <span class="nx">Reducer_Combine</span> <span class="o">=</span> <span class="nx">Reducer_Max</span><span class="p">.</span><span class="nx">combine</span><span class="p">(</span><span class="nx">Reducer_Min</span><span class="p">);</span>
<span class="linenos">116</span>
<span class="linenos">117</span><span class="kd">var</span> <span class="nx">Array_Example</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Array</span><span class="p">([[</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span>
<span class="linenos">118</span>                            <span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">]]);</span> <span class="c1">// axis = 0 updown</span>
<span class="linenos">119</span>
<span class="linenos">120</span><span class="kd">var</span> <span class="nx">Combine_Reduced_1</span> <span class="o">=</span> <span class="nx">Array_Example</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span>
<span class="linenos">121</span><span class="nx">Reducer_Combine</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="mf">1</span><span class="p">);</span><span class="c1">// direction 0 field axis</span>
<span class="linenos">122</span><span class="kd">var</span> <span class="nx">Combine_Reduced_2</span> <span class="o">=</span> <span class="nx">Array_Example</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span>
<span class="linenos">123</span><span class="nx">Reducer_Combine</span><span class="p">,</span> <span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="mf">0</span><span class="p">);</span>
<span class="linenos">124</span>
<span class="linenos">125</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Max of [1,3] and min of [2,4]&quot;</span><span class="p">,</span><span class="nx">Combine_Reduced_1</span><span class="p">);</span>
<span class="linenos">126</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Max of [1,2] and min of [3,4]&quot;</span><span class="p">,</span><span class="nx">Combine_Reduced_2</span><span class="p">);</span>
<span class="linenos">127</span>
<span class="linenos">128</span><span class="c1">// repeat</span>
<span class="linenos">129</span><span class="kd">var</span> <span class="nx">China_Cities</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/China_Cities&quot;</span><span class="p">);</span>
<span class="linenos">130</span><span class="kd">var</span> <span class="nx">Reducer_Repeat</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">frequencyHistogram</span><span class="p">().</span><span class="nx">repeat</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span>
<span class="linenos">131</span><span class="kd">var</span> <span class="nx">Province_City_Frequency</span> <span class="o">=</span> <span class="nx">China_Cities</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span><span class="nx">Reducer_Repeat</span><span class="p">,[</span><span class="s2">&quot;Prefecture&quot;</span><span class="p">,</span><span class="s2">&quot;省份&quot;</span><span class="p">]);</span>
<span class="linenos">132</span><span class="nx">print</span><span class="p">(</span><span class="nx">Province_City_Frequency</span><span class="p">);</span>
<span class="linenos">133</span>
<span class="linenos">134</span><span class="c1">// group</span>
<span class="linenos">135</span><span class="kd">var</span> <span class="nx">countries</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1S4EB6319wWW2sWQDPhDvmSBIVrD3iEmCLYB7nMM&quot;</span><span class="p">);</span>
<span class="linenos">136</span><span class="kd">var</span> <span class="nx">sums</span> <span class="o">=</span> <span class="nx">countries</span>
<span class="linenos">137</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
<span class="linenos">138</span>    <span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
<span class="linenos">139</span>    <span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">neq</span><span class="p">(</span><span class="s2">&quot;Census 2000 Population&quot;</span><span class="p">,</span><span class="kc">null</span><span class="p">),</span>
<span class="linenos">140</span>    <span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">neq</span><span class="p">(</span><span class="s2">&quot;Census 2000 Housing Units&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">))</span>
<span class="linenos">141</span><span class="p">)</span>
<span class="linenos">142</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">({</span>
<span class="linenos">143</span>    <span class="nx">selectors</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;Census 2000 Population&quot;</span><span class="p">,</span>
<span class="linenos">144</span>    <span class="s2">&quot;Census 2000 Housing Units&quot;</span><span class="p">,</span><span class="s2">&quot;StateName&quot;</span><span class="p">],</span>
<span class="linenos">145</span>    <span class="nx">reducer</span><span class="o">:</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">().</span><span class="nx">repeat</span><span class="p">(</span><span class="mf">2</span><span class="p">).</span><span class="nx">group</span><span class="p">({</span>
<span class="linenos">146</span>    <span class="nx">groupField</span><span class="o">:</span><span class="mf">2</span><span class="p">,</span>
<span class="linenos">147</span>    <span class="nx">groupName</span><span class="o">:</span><span class="s2">&quot;state&quot;</span><span class="p">,})</span>
<span class="linenos">148</span><span class="p">});</span>
<span class="linenos">149</span><span class="nx">print</span><span class="p">(</span><span class="nx">sums</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="kernel">
<h3>kernel<a class="headerlink" href="#kernel" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// DEM_Roberts</span>
<span class="linenos"> 2</span><span class="kd">var</span> <span class="nx">Provinces</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;users/zhouzz400/Boundries/China_Provinces&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="kd">var</span> <span class="nx">CQ_table</span> <span class="o">=</span> <span class="nx">Provinces</span><span class="p">.</span><span class="nx">reduceColumns</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">frequencyHistogram</span><span class="p">(),[</span><span class="s2">&quot;Name&quot;</span><span class="p">])</span>
<span class="linenos"> 4</span><span class="kd">var</span> <span class="nx">CQ</span> <span class="o">=</span> <span class="nx">Provinces</span><span class="p">.</span><span class="nx">filterMetadata</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span><span class="s2">&quot;equals&quot;</span><span class="p">,</span><span class="s2">&quot;上海市&quot;</span><span class="p">).</span><span class="nx">geometry</span><span class="p">()</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kd">var</span> <span class="nx">DEM</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s2">&quot;CGIAR/SRTM90_V4&quot;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">CQ</span><span class="p">);</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kd">var</span> <span class="nx">DEM_Roberts</span> <span class="o">=</span> <span class="nx">DEM</span><span class="p">.</span><span class="nx">convolve</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">roberts</span><span class="p">());</span><span class="c1">//卷积</span>
<span class="linenos"> 9</span><span class="kd">var</span> <span class="nx">DEM_prewitt</span> <span class="o">=</span> <span class="nx">DEM</span><span class="p">.</span><span class="nx">convolve</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">prewitt</span><span class="p">());</span>
<span class="linenos">10</span><span class="kd">var</span> <span class="nx">DEM_sobel</span> <span class="o">=</span> <span class="nx">DEM</span><span class="p">.</span><span class="nx">convolve</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">sobel</span><span class="p">());</span>
<span class="linenos">11</span><span class="kd">var</span> <span class="nx">DEM_compass</span> <span class="o">=</span> <span class="nx">DEM</span><span class="p">.</span><span class="nx">convolve</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">compass</span><span class="p">());</span>
<span class="linenos">12</span><span class="kd">var</span> <span class="nx">DEM_kirsch</span> <span class="o">=</span> <span class="nx">DEM</span><span class="p">.</span><span class="nx">convolve</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">kirsch</span><span class="p">());</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">DEM</span><span class="p">,{</span><span class="nx">min</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">2000</span><span class="p">},</span><span class="s2">&quot;DEM&quot;</span><span class="p">);</span>
<span class="linenos">15</span><span class="nx">Map</span><span class="p">.</span><span class="nx">centerObject</span><span class="p">(</span><span class="nx">CQ</span><span class="p">,</span><span class="mf">7</span><span class="p">)</span>
<span class="linenos">16</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">DEM_Roberts</span><span class="p">,{</span><span class="nx">min</span><span class="o">:-</span><span class="mf">60</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">60</span><span class="p">},</span><span class="s2">&quot;DEM_Roberts&quot;</span><span class="p">)</span>
<span class="linenos">17</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">DEM_prewitt</span><span class="p">,{</span><span class="nx">min</span><span class="o">:-</span><span class="mf">270</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">270</span><span class="p">},</span><span class="s2">&quot;DEM_prewitt&quot;</span><span class="p">)</span>
<span class="linenos">18</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">DEM_sobel</span><span class="p">,{</span><span class="nx">min</span><span class="o">:-</span><span class="mf">370</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">370</span><span class="p">},</span><span class="s2">&quot;DEM_sobel&quot;</span><span class="p">)</span>
<span class="linenos">19</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">DEM_compass</span><span class="p">,{</span><span class="nx">min</span><span class="o">:-</span><span class="mf">300</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">300</span><span class="p">},</span><span class="s2">&quot;DEM_compass&quot;</span><span class="p">)</span>
<span class="linenos">20</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">DEM_kirsch</span><span class="p">,{</span><span class="nx">min</span><span class="o">:-</span><span class="mf">1100</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="mf">1100</span><span class="p">},</span><span class="s2">&quot;DEM_kirsch&quot;</span><span class="p">)</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1">// laplacian4 laplacian8</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1">// based on distance</span>
<span class="linenos">25</span><span class="c1">// euclidean/gaussian/manhattan/chebyshev</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="c1">// shape kernel</span>
<span class="linenos">28</span><span class="c1">// circle octagon square diamond cross plus fied</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="c1">// operation</span>
<span class="linenos">31</span><span class="c1">// rotate 90*   add</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="c1">// print kernel</span>
<span class="linenos">34</span><span class="nx">print</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">euclidean</span><span class="p">(</span><span class="mf">1</span><span class="p">))</span>
<span class="linenos">35</span><span class="nx">print</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Kernel</span><span class="p">.</span><span class="nx">gaussian</span><span class="p">(</span><span class="mf">1</span><span class="p">))</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="c1">// function name(parameters){operation}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="apps">
<h2>APPs<a class="headerlink" href="#apps" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id15">
<h3>获取landsat 数据列表与统计<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">// Load Feature Collections ############################</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="c1">// Country Fusion Table</span>
<span class="linenos">  4</span><span class="kd">var</span> <span class="nx">countries</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;ft:1tdSwUL7MVpOauSgRzqVTOwdfy17KDbw-1d9omPw&#39;</span><span class="p">);</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="c1">// Footprint of Landsat WRS2</span>
<span class="linenos">  7</span><span class="kd">var</span> <span class="nx">wrs2_descending</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;ft:1_RZgjlcqixp-L9hyS6NYGqLaKOlnhSC35AB5M5Ll&#39;</span><span class="p">);</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="c1">// Load Landsat Image Collections ######################</span>
<span class="linenos"> 10</span><span class="kd">var</span> <span class="nx">l4_coll</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LT4_L1T_TOA&#39;</span><span class="p">);</span>  <span class="c1">//Aug 22, 1982 - Dec 14, 1993</span>
<span class="linenos"> 11</span><span class="kd">var</span> <span class="nx">l5_coll</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LT5_L1T_TOA&#39;</span><span class="p">);</span>  <span class="c1">//Jan 1, 1984 - May 5, 2012</span>
<span class="linenos"> 12</span><span class="kd">var</span> <span class="nx">l7_coll</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LE7_L1T_TOA&#39;</span><span class="p">);</span>  <span class="c1">//Jan 1, 1999 - Apr 30, 2017</span>
<span class="linenos"> 13</span><span class="kd">var</span> <span class="nx">l8_coll</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC8_L1T_TOA&#39;</span><span class="p">);</span>  <span class="c1">//Apr 11, 2013 - Apr 30, 2017</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="c1">// Add Functions ########################################</span>
<span class="linenos"> 16</span><span class="kd">function</span> <span class="nx">redraw</span><span class="p">(</span><span class="nx">key</span><span class="p">){</span>
<span class="linenos"> 17</span>    <span class="kd">var</span> <span class="nx">selectedCountry</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span><span class="nx">countries</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="nx">key</span><span class="p">)).</span><span class="nx">first</span><span class="p">());</span>
<span class="linenos"> 18</span>    <span class="nx">Map</span><span class="p">.</span><span class="nx">centerObject</span><span class="p">(</span><span class="nx">selectedCountry</span><span class="p">);</span>
<span class="linenos"> 19</span>    <span class="kd">var</span> <span class="nx">selectedCountry_Strg</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">String</span><span class="p">(</span><span class="nx">selectedCountry</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">))</span>
<span class="linenos"> 20</span>
<span class="linenos"> 21</span>    <span class="c1">// Show country</span>
<span class="linenos"> 22</span>    <span class="kd">var</span> <span class="nx">layer0</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Map</span><span class="p">.</span><span class="nx">Layer</span><span class="p">(</span><span class="nx">selectedCountry</span><span class="p">,</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span><span class="s1">&#39;purple&#39;</span><span class="p">},</span> <span class="s1">&#39;Selected country&#39;</span><span class="p">);</span>
<span class="linenos"> 23</span>    <span class="nx">Map</span><span class="p">.</span><span class="nx">layers</span><span class="p">().</span><span class="nx">set</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="nx">layer0</span><span class="p">);</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span>    <span class="c1">// show WRS2 footprint</span>
<span class="linenos"> 26</span>    <span class="kd">var</span> <span class="nx">wrs2_filtered</span> <span class="o">=</span> <span class="nx">wrs2_descending</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">selectedCountry</span><span class="p">.</span><span class="nx">geometry</span><span class="p">());</span>
<span class="linenos"> 27</span>    <span class="kd">var</span> <span class="nx">layer1</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Map</span><span class="p">.</span><span class="nx">Layer</span><span class="p">(</span><span class="nx">wrs2_filtered</span><span class="p">,</span> <span class="nx">vizParams</span><span class="p">,</span> <span class="s1">&#39;WRS2 filtered&#39;</span><span class="p">);</span>
<span class="linenos"> 28</span>    <span class="nx">Map</span><span class="p">.</span><span class="nx">layers</span><span class="p">().</span><span class="nx">set</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="nx">layer1</span><span class="p">);</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span>    <span class="c1">// filter the ImageCollection with the boundary of the selected country</span>
<span class="linenos"> 31</span>    <span class="kd">var</span> <span class="nx">iC</span> <span class="o">=</span> <span class="nx">merged_collection</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">selectedCountry</span><span class="p">.</span><span class="nx">geometry</span><span class="p">());</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span>    <span class="nx">iC</span> <span class="o">=</span> <span class="nx">iC</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">img</span><span class="p">){</span>
<span class="linenos"> 34</span>        <span class="kd">var</span> <span class="nx">year</span>  <span class="o">=</span> <span class="nx">img</span><span class="p">.</span><span class="nx">date</span><span class="p">().</span><span class="nx">format</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">);</span>            <span class="c1">// get the acquisition year</span>
<span class="linenos"> 35</span>        <span class="kd">var</span> <span class="nx">CC</span> <span class="o">=</span> <span class="nx">img</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;CLOUD_COVER&#39;</span><span class="p">)</span>
<span class="linenos"> 36</span>        <span class="k">return</span> <span class="nx">img</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">year</span><span class="p">)).</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;clouds&#39;</span><span class="p">,</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">CC</span><span class="p">));</span> <span class="c1">//</span>
<span class="linenos"> 37</span><span class="p">});</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span><span class="kd">var</span> <span class="nx">iC_FC</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="nx">iC</span><span class="p">);</span>
<span class="linenos"> 40</span><span class="kd">var</span> <span class="nx">iC_FC_size</span> <span class="o">=</span> <span class="nx">iC_FC</span><span class="p">.</span><span class="nx">size</span><span class="p">();</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span><span class="kd">var</span> <span class="nx">options1</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 43</span>    <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Landsat Mission 4-8 - GEE image availability&#39;</span><span class="p">,</span>
<span class="linenos"> 44</span>    <span class="nx">hAxis</span><span class="o">:</span> <span class="p">{</span><span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">},</span>
<span class="linenos"> 45</span>    <span class="nx">vAxis</span><span class="o">:</span> <span class="p">{</span><span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Image count&#39;</span><span class="p">},</span>
<span class="linenos"> 46</span>    <span class="nx">colors</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]</span>
<span class="linenos"> 47</span><span class="p">};</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span><span class="kd">var</span> <span class="nx">options2</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 50</span>    <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Landsat cloud cover&#39;</span><span class="p">,</span>
<span class="linenos"> 51</span>    <span class="nx">hAxis</span><span class="o">:</span> <span class="p">{</span><span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;% Cloud Cover&#39;</span><span class="p">},</span>
<span class="linenos"> 52</span>    <span class="nx">vAxis</span><span class="o">:</span> <span class="p">{</span><span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Image count&#39;</span><span class="p">},</span>
<span class="linenos"> 53</span>    <span class="nx">colors</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">]</span>
<span class="linenos"> 54</span><span class="p">};</span>
<span class="linenos"> 55</span>
<span class="linenos"> 56</span><span class="c1">// Make the histogram, set the options.</span>
<span class="linenos"> 57</span><span class="kd">var</span> <span class="nx">histogram</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Chart</span><span class="p">.</span><span class="nx">feature</span><span class="p">.</span><span class="nx">histogram</span><span class="p">({</span>
<span class="linenos"> 58</span>    <span class="nx">features</span><span class="o">:</span> <span class="nx">iC_FC</span><span class="p">,</span>
<span class="linenos"> 59</span>    <span class="nx">property</span><span class="o">:</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span>
<span class="linenos"> 60</span>    <span class="nx">minBucketWidth</span><span class="o">:</span> <span class="mf">1</span>
<span class="linenos"> 61</span><span class="p">}).</span><span class="nx">setOptions</span><span class="p">(</span><span class="nx">options1</span><span class="p">);</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span>
<span class="linenos"> 64</span><span class="kd">var</span> <span class="nx">histogram_CC</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Chart</span><span class="p">.</span><span class="nx">feature</span><span class="p">.</span><span class="nx">histogram</span><span class="p">({</span>
<span class="linenos"> 65</span>    <span class="nx">features</span><span class="o">:</span> <span class="nx">iC_FC</span><span class="p">,</span>
<span class="linenos"> 66</span>    <span class="nx">property</span><span class="o">:</span> <span class="s1">&#39;clouds&#39;</span><span class="p">,</span>
<span class="linenos"> 67</span>    <span class="nx">minBucketWidth</span><span class="o">:</span> <span class="mf">5</span>
<span class="linenos"> 68</span><span class="p">}).</span><span class="nx">setOptions</span><span class="p">(</span><span class="nx">options2</span><span class="p">);</span>
<span class="linenos"> 69</span><span class="c1">// add text to the panel</span>
<span class="linenos"> 70</span>
<span class="linenos"> 71</span><span class="kd">var</span> <span class="nx">iscoveredby</span> <span class="o">=</span> <span class="s2">&quot; is covered by &quot;</span><span class="p">;</span>
<span class="linenos"> 72</span><span class="kd">var</span> <span class="nx">wrs2_filtered_size</span> <span class="o">=</span> <span class="nx">wrs2_filtered</span><span class="p">.</span><span class="nx">size</span><span class="p">();</span>
<span class="linenos"> 73</span><span class="kd">var</span> <span class="nx">LandsatWRSgridsIntotalwere</span> <span class="o">=</span> <span class="s2">&quot; Landsat WRS-2 grids. During the lifetime of Landsat Mission 4-8 were &quot;</span><span class="p">;</span>
<span class="linenos"> 74</span><span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="s2">&quot; images collected. Their spatial distribution is shown in the map (red circles), the temporal distribution is shown in the first chart.&quot;</span><span class="p">;</span>
<span class="linenos"> 75</span><span class="kd">var</span> <span class="nx">text2</span> <span class="o">=</span> <span class="s2">&quot; The relative average cloud cover for each WRS-2 is shown in the map (orange circles), while the 2nd chart shows a histogram of the overall percentage cloud cover.&quot;</span>
<span class="linenos"> 76</span><span class="kd">var</span> <span class="nx">info_text</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">String</span><span class="p">(</span><span class="nx">selectedCountry_Strg</span><span class="p">).</span><span class="nx">cat</span><span class="p">(</span><span class="nx">iscoveredby</span><span class="p">).</span><span class="nx">cat</span><span class="p">(</span><span class="nx">wrs2_filtered_size</span><span class="p">)</span>
<span class="linenos"> 77</span>    <span class="p">.</span><span class="nx">cat</span><span class="p">(</span><span class="nx">LandsatWRSgridsIntotalwere</span><span class="p">).</span><span class="nx">cat</span><span class="p">(</span><span class="nx">iC_FC_size</span><span class="p">).</span><span class="nx">cat</span><span class="p">(</span><span class="nx">text</span><span class="p">).</span><span class="nx">cat</span><span class="p">(</span><span class="nx">text2</span><span class="p">);</span>
<span class="linenos"> 78</span>
<span class="linenos"> 79</span><span class="nx">panel</span><span class="p">.</span><span class="nx">widgets</span><span class="p">().</span><span class="nx">set</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="nx">histogram</span><span class="p">);</span>
<span class="linenos"> 80</span><span class="nx">panel</span><span class="p">.</span><span class="nx">widgets</span><span class="p">().</span><span class="nx">set</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="nx">histogram_CC</span><span class="p">);</span>
<span class="linenos"> 81</span>
<span class="linenos"> 82</span><span class="c1">// create centroids</span>
<span class="linenos"> 83</span><span class="kd">var</span> <span class="nx">centroids</span> <span class="o">=</span> <span class="nx">wrs2_filtered</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">getCentroid</span><span class="p">);</span>
<span class="linenos"> 84</span><span class="kd">var</span> <span class="nx">fC</span>        <span class="o">=</span> <span class="nx">centroids</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">addField</span><span class="p">);</span>
<span class="linenos"> 85</span>
<span class="linenos"> 86</span><span class="c1">// buffer centroid according to image counts</span>
<span class="linenos"> 87</span><span class="kd">var</span> <span class="nx">buffered_points</span> <span class="o">=</span> <span class="nx">fC</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">buffer_count</span><span class="p">).</span><span class="nx">flatten</span><span class="p">();</span>
<span class="linenos"> 88</span>
<span class="linenos"> 89</span><span class="c1">// buffer centroid according to cloud percentage</span>
<span class="linenos"> 90</span><span class="kd">var</span> <span class="nx">buffered_points_cloud</span> <span class="o">=</span> <span class="nx">fC</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">buffer_cloud</span><span class="p">).</span><span class="nx">flatten</span><span class="p">();</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span><span class="kd">var</span> <span class="nx">outlines</span> <span class="o">=</span> <span class="nx">empty</span><span class="p">.</span><span class="nx">paint</span><span class="p">({</span><span class="nx">featureCollection</span><span class="o">:</span> <span class="nx">buffered_points</span><span class="p">,</span> <span class="nx">color</span><span class="o">:</span> <span class="mf">1</span><span class="p">,</span> <span class="nx">width</span><span class="o">:</span> <span class="mf">2</span><span class="p">});</span>
<span class="linenos"> 93</span>
<span class="linenos"> 94</span><span class="c1">// show image count circles</span>
<span class="linenos"> 95</span><span class="kd">var</span> <span class="nx">filledOutlines</span> <span class="o">=</span> <span class="nx">empty</span><span class="p">.</span><span class="nx">paint</span><span class="p">(</span><span class="nx">buffered_points</span><span class="p">).</span><span class="nx">paint</span><span class="p">(</span><span class="nx">buffered_points</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">wrs2_filtered</span><span class="p">);</span>
<span class="linenos"> 96</span><span class="kd">var</span> <span class="nx">layer2</span>         <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Map</span><span class="p">.</span><span class="nx">Layer</span><span class="p">(</span><span class="nx">filledOutlines</span><span class="p">,</span> <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">palette</span><span class="p">)},</span> <span class="s1">&#39;Landsat image count&#39;</span><span class="p">);</span>
<span class="linenos"> 97</span><span class="nx">Map</span><span class="p">.</span><span class="nx">layers</span><span class="p">().</span><span class="nx">set</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="nx">layer2</span><span class="p">);</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span><span class="kd">var</span> <span class="nx">innerCircles</span> <span class="o">=</span> <span class="nx">empty</span><span class="p">.</span><span class="nx">paint</span><span class="p">(</span><span class="nx">buffered_points_cloud</span><span class="p">).</span><span class="nx">paint</span><span class="p">(</span><span class="nx">buffered_points_cloud</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">wrs2_filtered</span><span class="p">);</span>
<span class="linenos">100</span><span class="kd">var</span> <span class="nx">layer3</span>       <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Map</span><span class="p">.</span><span class="nx">Layer</span><span class="p">(</span><span class="nx">innerCircles</span><span class="p">,</span> <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">palette</span><span class="p">)},</span> <span class="s1">&#39;Cloud percentage (avg.)&#39;</span><span class="p">);</span>
<span class="linenos">101</span><span class="nx">Map</span><span class="p">.</span><span class="nx">layers</span><span class="p">().</span><span class="nx">set</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="nx">layer3</span><span class="p">);</span>
<span class="linenos">102</span>
<span class="linenos">103</span><span class="nx">info_text</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">104</span>    <span class="nx">panel</span><span class="p">.</span><span class="nx">widgets</span><span class="p">().</span><span class="nx">set</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Label</span><span class="p">(</span><span class="nx">result</span><span class="p">));</span>
<span class="linenos">105</span><span class="p">});</span>
<span class="linenos">106</span>
<span class="linenos">107</span><span class="p">}</span>  <span class="c1">// end - redraw</span>
<span class="linenos">108</span>
<span class="linenos">109</span><span class="c1">// ##################################################</span>
<span class="linenos">110</span><span class="c1">// This function creates a new feature from the centroid of the geometry.</span>
<span class="linenos">111</span><span class="kd">var</span> <span class="nx">getCentroid</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">112</span>    <span class="c1">// Keep this list of properties.</span>
<span class="linenos">113</span>    <span class="kd">var</span> <span class="nx">keepProperties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">,</span> <span class="s1">&#39;ROW&#39;</span><span class="p">];</span>
<span class="linenos">114</span>    <span class="c1">// Get the centroid of the feature&#39;s geometry.</span>
<span class="linenos">115</span>    <span class="kd">var</span> <span class="nx">centroid</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">geometry</span><span class="p">().</span><span class="nx">centroid</span><span class="p">();</span>
<span class="linenos">116</span>    <span class="c1">// Return a new Feature, copying properties from the old Feature.</span>
<span class="linenos">117</span>    <span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span><span class="nx">centroid</span><span class="p">).</span><span class="nx">copyProperties</span><span class="p">(</span><span class="nx">feature</span><span class="p">,</span> <span class="nx">keepProperties</span><span class="p">);</span>
<span class="linenos">118</span><span class="p">};</span> <span class="c1">// end - getCentroid</span>
<span class="linenos">119</span>
<span class="linenos">120</span><span class="c1">// ##################################################</span>
<span class="linenos">121</span><span class="kd">var</span> <span class="nx">addField</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">122</span>
<span class="linenos">123</span>    <span class="kd">var</span> <span class="nx">path</span>       <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;PATH&#39;</span><span class="p">);</span>
<span class="linenos">124</span>    <span class="kd">var</span> <span class="nx">row</span>        <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ROW&#39;</span><span class="p">);</span>
<span class="linenos">125</span>    <span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">merged_collection</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;WRS_PATH&#39;</span><span class="p">,</span> <span class="nx">path</span><span class="p">)).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;WRS_ROW&#39;</span><span class="p">,</span> <span class="nx">row</span><span class="p">));</span>
<span class="linenos">126</span>    <span class="kd">var</span> <span class="nx">cloud_mean</span> <span class="o">=</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">aggregate_mean</span><span class="p">(</span><span class="s1">&#39;CLOUD_COVER&#39;</span><span class="p">);</span>
<span class="linenos">127</span>    <span class="nx">cloud_mean</span>     <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nb">Number</span><span class="p">(</span><span class="nx">cloud_mean</span><span class="p">);</span>
<span class="linenos">128</span>    <span class="kd">var</span> <span class="nx">count</span>      <span class="o">=</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">size</span><span class="p">();</span>
<span class="linenos">129</span>    <span class="kd">var</span> <span class="nx">f</span>          <span class="o">=</span> <span class="nx">count</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="mf">100</span><span class="p">).</span><span class="nx">round</span><span class="p">();</span>
<span class="linenos">130</span>    <span class="kd">var</span> <span class="nx">cloud_pct</span>  <span class="o">=</span> <span class="nx">cloud_mean</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">f</span><span class="p">).</span><span class="nx">divide</span><span class="p">(</span><span class="mf">100</span><span class="p">).</span><span class="nx">round</span><span class="p">();</span>
<span class="linenos">131</span>    <span class="kd">var</span> <span class="nx">keepProperties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">,</span> <span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;CLOUD_COVER&#39;</span><span class="p">];</span>
<span class="linenos">132</span>
<span class="linenos">133</span>    <span class="k">return</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span><span class="s1">&#39;count&#39;</span><span class="o">:</span> <span class="nx">f</span><span class="p">}).</span><span class="nx">set</span><span class="p">({</span><span class="s1">&#39;cloud_mean&#39;</span><span class="o">:</span> <span class="nx">cloud_mean</span><span class="p">}).</span><span class="nx">set</span><span class="p">({</span><span class="s1">&#39;cloud_pct&#39;</span><span class="o">:</span> <span class="nx">cloud_pct</span><span class="p">})</span>
<span class="linenos">134</span>        <span class="p">.</span><span class="nx">copyProperties</span><span class="p">(</span><span class="nx">feature</span><span class="p">,</span> <span class="nx">keepProperties</span><span class="p">);</span>
<span class="linenos">135</span><span class="p">};</span> <span class="c1">// end - addField</span>
<span class="linenos">136</span>
<span class="linenos">137</span><span class="c1">// ##################################################</span>
<span class="linenos">138</span><span class="kd">var</span> <span class="nx">buffer_count</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">139</span>    <span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)));</span>
<span class="linenos">140</span><span class="p">};</span> <span class="c1">// end - buffer_count</span>
<span class="linenos">141</span>
<span class="linenos">142</span><span class="c1">// ##################################################</span>
<span class="linenos">143</span><span class="kd">var</span> <span class="nx">buffer_cloud</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">144</span>    <span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;cloud_pct&#39;</span><span class="p">)));</span>
<span class="linenos">145</span><span class="p">};</span> <span class="c1">// end - buffer_cloud</span>
<span class="linenos">146</span>
<span class="linenos">147</span><span class="c1">// ##################################################</span>
<span class="linenos">148</span><span class="nx">ui</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">setLayout</span><span class="p">(</span><span class="nx">ui</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Layout</span><span class="p">.</span><span class="nx">absolute</span><span class="p">());</span>
<span class="linenos">149</span>
<span class="linenos">150</span><span class="c1">// Create a panel with vertical flow layout.</span>
<span class="linenos">151</span><span class="kd">var</span> <span class="nx">panel</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Panel</span><span class="p">({</span>
<span class="linenos">152</span><span class="nx">layout</span><span class="o">:</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Layout</span><span class="p">.</span><span class="nx">flow</span><span class="p">(</span><span class="s1">&#39;vertical&#39;</span><span class="p">),</span>
<span class="linenos">153</span><span class="nx">style</span><span class="o">:</span> <span class="p">{</span><span class="nx">position</span><span class="o">:</span> <span class="s1">&#39;bottom-right&#39;</span><span class="p">,</span> <span class="nx">height</span><span class="o">:</span> <span class="s1">&#39;500px&#39;</span><span class="p">,</span> <span class="nx">width</span><span class="o">:</span><span class="s1">&#39;350px&#39;</span><span class="p">}</span>
<span class="linenos">154</span><span class="p">});</span>
<span class="linenos">155</span>
<span class="linenos">156</span><span class="c1">// Create drop down selection</span>
<span class="linenos">157</span>
<span class="linenos">158</span><span class="kd">var</span> <span class="nx">vizParams</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="nx">opacity</span><span class="o">:</span> <span class="mf">0.1</span> <span class="p">};</span>
<span class="linenos">159</span><span class="kd">var</span> <span class="nx">palette</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FF0000&#39;</span><span class="p">,</span> <span class="s1">&#39;00FF00&#39;</span><span class="p">,</span> <span class="s1">&#39;0000FF&#39;</span><span class="p">];</span>
<span class="linenos">160</span>
<span class="linenos">161</span><span class="c1">// get country names</span>
<span class="linenos">162</span><span class="kd">var</span> <span class="nx">names</span> <span class="o">=</span> <span class="nx">countries</span><span class="p">.</span><span class="nx">aggregate_array</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">);</span>
<span class="linenos">163</span><span class="kd">var</span> <span class="nx">merged_collection</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="nx">l4_coll</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">l5_coll</span><span class="p">).</span><span class="nx">merge</span><span class="p">(</span><span class="nx">l7_coll</span><span class="p">).</span><span class="nx">merge</span><span class="p">(</span><span class="nx">l8_coll</span><span class="p">));</span>
<span class="linenos">164</span><span class="c1">// Create an empty image into which to paint the features, cast to byte.</span>
<span class="linenos">165</span><span class="kd">var</span> <span class="nx">empty</span>   <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">().</span><span class="kr">byte</span><span class="p">();</span>
<span class="linenos">166</span><span class="c1">// initialize combobox and fire up the redraw function</span>
<span class="linenos">167</span><span class="kd">var</span> <span class="nx">select</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Select</span><span class="p">({</span><span class="nx">items</span><span class="o">:</span> <span class="nx">names</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">(),</span> <span class="nx">onChange</span><span class="o">:</span> <span class="nx">redraw</span> <span class="p">});</span>
<span class="linenos">168</span><span class="nx">select</span><span class="p">.</span><span class="nx">setPlaceholder</span><span class="p">(</span><span class="s1">&#39;Choose a country ...&#39;</span><span class="p">);</span>
<span class="linenos">169</span>
<span class="linenos">170</span><span class="nx">Map</span><span class="p">.</span><span class="nx">setCenter</span><span class="p">(</span><span class="mf">10.5</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">4</span><span class="p">);</span>
<span class="linenos">171</span><span class="nx">Map</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">select</span><span class="p">);</span>
<span class="linenos">172</span><span class="nx">ui</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">panel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="landsat-ndvi">
<h3>Landsat NDVI<a class="headerlink" href="#landsat-ndvi" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="kd">var</span> <span class="nx">GJ</span> <span class="o">=</span> <span class="nx">GJ_P</span><span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">point</span><span class="p">).</span><span class="nx">geometry</span><span class="p">();</span>
<span class="linenos">  2</span><span class="kd">var</span> <span class="nx">NDVI_00</span> <span class="o">=</span> <span class="nx">L7_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2000-12-31&#39;</span><span class="p">)</span>
<span class="linenos">  3</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">  4</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">  5</span><span class="kd">var</span> <span class="nx">fvc_00</span> <span class="o">=</span> <span class="nx">NDVI_00</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">  6</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">  7</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_00</span><span class="p">,</span>
<span class="linenos">  8</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.22278</span><span class="p">,</span><span class="c1">//(49)14 0.13089,07 -0.17542,00 -0.05848,19 0.22268</span>
<span class="linenos">  9</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.78478</span><span class="c1">//(30)14 1,07 0.61322,00 0.43351 ,19 0.96473</span>
<span class="linenos"> 10</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 11</span><span class="c1">// print(fvc_00);</span>
<span class="linenos"> 12</span><span class="kd">var</span> <span class="nx">NDVI_01</span> <span class="o">=</span> <span class="nx">L7_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2001-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 13</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 14</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 15</span><span class="kd">var</span> <span class="nx">fvc_01</span> <span class="o">=</span> <span class="nx">NDVI_01</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 16</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 17</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_01</span><span class="p">,</span>
<span class="linenos"> 18</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.26945</span><span class="p">,</span><span class="c1">//14 0.13089,07 -0.17542,00 -0.05848,19 0.22268</span>
<span class="linenos"> 19</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.75373</span><span class="c1">//14 1,07 0.61322,00 0.43351 ,19 0.96473</span>
<span class="linenos"> 20</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 21</span><span class="c1">// print(fvc_01);</span>
<span class="linenos"> 22</span><span class="kd">var</span> <span class="nx">NDVI_02</span> <span class="o">=</span> <span class="nx">L7_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2002-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2002-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 23</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 24</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 25</span><span class="kd">var</span> <span class="nx">fvc_02</span> <span class="o">=</span> <span class="nx">NDVI_02</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 26</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 27</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_02</span><span class="p">,</span>
<span class="linenos"> 28</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.20628</span><span class="p">,</span>
<span class="linenos"> 29</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.76145</span>
<span class="linenos"> 30</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 31</span><span class="c1">// print(fvc_02);</span>
<span class="linenos"> 32</span><span class="kd">var</span> <span class="nx">NDVI_03</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2003-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2003-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 33</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 34</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 35</span><span class="kd">var</span> <span class="nx">fvc_03</span> <span class="o">=</span> <span class="nx">NDVI_03</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 36</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 37</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_03</span><span class="p">,</span>
<span class="linenos"> 38</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.14459</span><span class="p">,</span><span class="c1">//0.17587</span>
<span class="linenos"> 39</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.74578</span><span class="c1">//0.73809</span>
<span class="linenos"> 40</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 41</span><span class="c1">// print(fvc_03);</span>
<span class="linenos"> 42</span><span class="kd">var</span> <span class="nx">NDVI_04</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2004-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2004-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 43</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 44</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 45</span><span class="kd">var</span> <span class="nx">fvc_04</span> <span class="o">=</span> <span class="nx">NDVI_04</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 46</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 47</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_04</span><span class="p">,</span>
<span class="linenos"> 48</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.16053</span><span class="p">,</span>
<span class="linenos"> 49</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.76210</span>
<span class="linenos"> 50</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 51</span><span class="c1">// print(fvc_04);</span>
<span class="linenos"> 52</span><span class="kd">var</span> <span class="nx">NDVI_05</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2005-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2005-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 53</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 54</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 55</span><span class="kd">var</span> <span class="nx">fvc_05</span> <span class="o">=</span> <span class="nx">NDVI_05</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 56</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 57</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_05</span><span class="p">,</span>
<span class="linenos"> 58</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.13683</span><span class="p">,</span>
<span class="linenos"> 59</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.75358</span>
<span class="linenos"> 60</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 61</span><span class="c1">// print(fvc_05);</span>
<span class="linenos"> 62</span><span class="kd">var</span> <span class="nx">NDVI_06</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2006-06-01&#39;</span><span class="p">,</span><span class="s1">&#39;2006-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 63</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 64</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 65</span><span class="kd">var</span> <span class="nx">fvc_06</span> <span class="o">=</span> <span class="nx">NDVI_06</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 66</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 67</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_06</span><span class="p">,</span>
<span class="linenos"> 68</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.13679</span><span class="p">,</span>
<span class="linenos"> 69</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.76178</span>
<span class="linenos"> 70</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 71</span><span class="c1">// print(fvc_06);</span>
<span class="linenos"> 72</span><span class="kd">var</span> <span class="nx">NDVI_07</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2007-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2007-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 73</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 74</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 75</span><span class="kd">var</span> <span class="nx">fvc_07</span> <span class="o">=</span> <span class="nx">NDVI_07</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 76</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 77</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_07</span><span class="p">,</span>
<span class="linenos"> 78</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.15240</span><span class="p">,</span><span class="c1">//0.22274</span>
<span class="linenos"> 79</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.755361</span><span class="c1">//0.76144</span>
<span class="linenos"> 80</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 81</span><span class="c1">// print(fvc_07);</span>
<span class="linenos"> 82</span><span class="kd">var</span> <span class="nx">NDVI_08</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2008-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2008-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 83</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 84</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 85</span><span class="kd">var</span> <span class="nx">fvc_08</span> <span class="o">=</span> <span class="nx">NDVI_08</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 86</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 87</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_08</span><span class="p">,</span>
<span class="linenos"> 88</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.14452</span><span class="p">,</span>
<span class="linenos"> 89</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.72232</span>
<span class="linenos"> 90</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos"> 91</span><span class="c1">// print(fvc_08);</span>
<span class="linenos"> 92</span><span class="kd">var</span> <span class="nx">NDVI_09</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2009-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2009-12-31&#39;</span><span class="p">)</span>
<span class="linenos"> 93</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos"> 94</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos"> 95</span><span class="kd">var</span> <span class="nx">fvc_09</span> <span class="o">=</span> <span class="nx">NDVI_09</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 96</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos"> 97</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_09</span><span class="p">,</span>
<span class="linenos"> 98</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.14457</span><span class="p">,</span>
<span class="linenos"> 99</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.76880</span>
<span class="linenos">100</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">101</span><span class="c1">// print(fvc_09);</span>
<span class="linenos">102</span><span class="kd">var</span> <span class="nx">NDVI_10</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2010-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2010-12-31&#39;</span><span class="p">)</span>
<span class="linenos">103</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">104</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">105</span><span class="kd">var</span> <span class="nx">fvc_10</span> <span class="o">=</span> <span class="nx">NDVI_10</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">106</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">107</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_10</span><span class="p">,</span>
<span class="linenos">108</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.12892</span><span class="p">,</span>
<span class="linenos">109</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.75360</span>
<span class="linenos">110</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">111</span><span class="c1">// print(fvc_10);</span>
<span class="linenos">112</span><span class="kd">var</span> <span class="nx">NDVI_11</span> <span class="o">=</span> <span class="nx">L5_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2011-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2011-12-31&#39;</span><span class="p">)</span>
<span class="linenos">113</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">114</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">115</span><span class="kd">var</span> <span class="nx">fvc_11</span> <span class="o">=</span> <span class="nx">NDVI_11</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">116</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">117</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_11</span><span class="p">,</span>
<span class="linenos">118</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.14458</span><span class="p">,</span>
<span class="linenos">119</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.75363</span>
<span class="linenos">120</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">121</span><span class="c1">// print(fvc_11);</span>
<span class="linenos">122</span><span class="kd">var</span> <span class="nx">NDVI_12</span> <span class="o">=</span> <span class="nx">L7_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2012-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2012-12-31&#39;</span><span class="p">)</span>
<span class="linenos">123</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">124</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">125</span><span class="kd">var</span> <span class="nx">fvc_12</span> <span class="o">=</span> <span class="nx">NDVI_12</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">126</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">127</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_12</span><span class="p">,</span>
<span class="linenos">128</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.18363</span><span class="p">,</span>
<span class="linenos">129</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.78475</span>
<span class="linenos">130</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">131</span><span class="c1">// print(fvc_12);</span>
<span class="linenos">132</span><span class="kd">var</span> <span class="nx">NDVI_13</span> <span class="o">=</span> <span class="nx">L7_NDVI</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2013-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2013-12-31&#39;</span><span class="p">)</span>
<span class="linenos">133</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">134</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">135</span><span class="kd">var</span> <span class="nx">fvc_13</span> <span class="o">=</span> <span class="nx">NDVI_13</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">136</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">137</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_13</span><span class="p">,</span>
<span class="linenos">138</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.20681</span><span class="p">,</span>
<span class="linenos">139</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.80047</span>
<span class="linenos">140</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">141</span><span class="c1">// print(fvc_13);</span>
<span class="linenos">142</span><span class="kd">var</span> <span class="nx">NDVI_14</span> <span class="o">=</span> <span class="nx">L8</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2014-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2014-12-31&#39;</span><span class="p">)</span>
<span class="linenos">143</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">144</span>        <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">145</span>        <span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">]).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">))})</span>
<span class="linenos">146</span>        <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="linenos">147</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">148</span><span class="kd">var</span> <span class="nx">fvc_14</span> <span class="o">=</span> <span class="nx">NDVI_14</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">149</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">150</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_14</span><span class="p">,</span>
<span class="linenos">151</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.27930</span><span class="p">,</span><span class="c1">//14 0.13089,07 -0.17542,00 -0.05848,19 0.22268</span>
<span class="linenos">152</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">1</span><span class="c1">//14 1,07 0.61322,00 0.43351 ,19 0.96473</span>
<span class="linenos">153</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">154</span><span class="c1">// print(fvc_14);</span>
<span class="linenos">155</span><span class="kd">var</span> <span class="nx">NDVI_15</span> <span class="o">=</span> <span class="nx">L8</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2015-12-31&#39;</span><span class="p">)</span>
<span class="linenos">156</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">157</span>        <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">158</span>        <span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">]).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">))})</span>
<span class="linenos">159</span>        <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="linenos">160</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">161</span><span class="kd">var</span> <span class="nx">fvc_15</span> <span class="o">=</span> <span class="nx">NDVI_15</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">162</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">163</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_15</span><span class="p">,</span>
<span class="linenos">164</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.25393</span><span class="p">,</span>
<span class="linenos">165</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">1</span>
<span class="linenos">166</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">167</span><span class="c1">// print(fvc_15);</span>
<span class="linenos">168</span><span class="kd">var</span> <span class="nx">NDVI_16</span> <span class="o">=</span> <span class="nx">L8</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2016-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2016-12-31&#39;</span><span class="p">)</span>
<span class="linenos">169</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">170</span>        <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">171</span>        <span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">]).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">))})</span>
<span class="linenos">172</span>        <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="linenos">173</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">174</span><span class="kd">var</span> <span class="nx">fvc_16</span> <span class="o">=</span> <span class="nx">NDVI_16</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">175</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">176</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_16</span><span class="p">,</span>
<span class="linenos">177</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.24803</span><span class="p">,</span>
<span class="linenos">178</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">1</span>
<span class="linenos">179</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">180</span><span class="c1">// print(fvc_16);</span>
<span class="linenos">181</span><span class="kd">var</span> <span class="nx">NDVI_17</span> <span class="o">=</span> <span class="nx">L8</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2017-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2017-12-31&#39;</span><span class="p">)</span>
<span class="linenos">182</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">183</span>        <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">184</span>        <span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">]).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">))})</span>
<span class="linenos">185</span>        <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="linenos">186</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">187</span><span class="kd">var</span> <span class="nx">fvc_17</span> <span class="o">=</span> <span class="nx">NDVI_17</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">188</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">189</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_17</span><span class="p">,</span>
<span class="linenos">190</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.26367</span><span class="p">,</span>
<span class="linenos">191</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">1</span>
<span class="linenos">192</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">193</span><span class="c1">// print(fvc_17);</span>
<span class="linenos">194</span><span class="kd">var</span> <span class="nx">NDVI_18</span> <span class="o">=</span> <span class="nx">L8</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2018-12-31&#39;</span><span class="p">)</span>
<span class="linenos">195</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">196</span>        <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">197</span>        <span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">]).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">))})</span>
<span class="linenos">198</span>        <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="linenos">199</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">200</span><span class="kd">var</span> <span class="nx">fvc_18</span> <span class="o">=</span> <span class="nx">NDVI_18</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">201</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">202</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_18</span><span class="p">,</span>
<span class="linenos">203</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.24803</span><span class="p">,</span>
<span class="linenos">204</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">1</span>
<span class="linenos">205</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">206</span><span class="c1">// print(fvc_18);</span>
<span class="linenos">207</span><span class="kd">var</span> <span class="nx">NDVI_19</span> <span class="o">=</span> <span class="nx">L8</span><span class="p">.</span><span class="nx">filterDate</span><span class="p">(</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2019-12-31&#39;</span><span class="p">)</span>
<span class="linenos">208</span>        <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">GJ</span><span class="p">)</span>
<span class="linenos">209</span>        <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">210</span>        <span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">]).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">))})</span>
<span class="linenos">211</span>        <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
<span class="linenos">212</span>        <span class="p">.</span><span class="nx">qualityMosaic</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">GJ</span><span class="p">);</span>
<span class="linenos">213</span><span class="kd">var</span> <span class="nx">fvc_19</span> <span class="o">=</span> <span class="nx">NDVI_19</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos">214</span><span class="s1">&#39;(NDVI-NDVIsoil)/(NDVIveg-NDVIsoil)&#39;</span><span class="p">,{</span>
<span class="linenos">215</span><span class="s1">&#39;NDVI&#39;</span><span class="o">:</span><span class="nx">NDVI_19</span><span class="p">,</span>
<span class="linenos">216</span><span class="s1">&#39;NDVIsoil&#39;</span><span class="o">:</span><span class="mf">0.22268</span><span class="p">,</span><span class="c1">//14 0.13089,07 -0.17542,00 -0.05848,19 0.22268</span>
<span class="linenos">217</span><span class="s1">&#39;NDVIveg&#39;</span><span class="o">:</span><span class="mf">0.96473</span><span class="c1">//14 1,07 0.61322,00 0.43351 ,19 0.96473</span>
<span class="linenos">218</span><span class="p">}).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">);</span>
<span class="linenos">219</span><span class="c1">// print(fvc_19);</span>
<span class="linenos">220</span><span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">([</span><span class="nx">fvc_00</span><span class="p">,</span><span class="nx">fvc_01</span><span class="p">,</span><span class="nx">fvc_02</span><span class="p">,</span><span class="nx">fvc_03</span><span class="p">,</span><span class="nx">fvc_04</span><span class="p">,</span><span class="nx">fvc_05</span><span class="p">,</span><span class="nx">fvc_06</span><span class="p">,</span><span class="nx">fvc_07</span><span class="p">,</span><span class="nx">fvc_08</span><span class="p">,</span>
<span class="linenos">221</span><span class="nx">fvc_09</span><span class="p">,</span><span class="nx">fvc_10</span><span class="p">,</span><span class="nx">fvc_11</span><span class="p">,</span><span class="nx">fvc_12</span><span class="p">,</span><span class="nx">fvc_13</span><span class="p">,</span><span class="nx">fvc_14</span><span class="p">,</span><span class="nx">fvc_15</span><span class="p">,</span><span class="nx">fvc_16</span><span class="p">,</span><span class="nx">fvc_17</span><span class="p">,</span><span class="nx">fvc_18</span><span class="p">,</span><span class="nx">fvc_19</span><span class="p">]);</span>
<span class="linenos">222</span><span class="nx">print</span><span class="p">(</span><span class="nx">collection</span><span class="p">);</span>
<span class="linenos">223</span><span class="kd">var</span> <span class="nx">collection_mean</span> <span class="o">=</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">()).</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;FVC&#39;</span><span class="p">).</span><span class="nx">toFloat</span><span class="p">();</span>
<span class="linenos">224</span><span class="nx">print</span><span class="p">(</span><span class="nx">collection_mean</span><span class="p">);</span>
<span class="linenos">225</span><span class="nx">Export</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">toDrive</span><span class="p">({</span>
<span class="linenos">226</span><span class="nx">image</span><span class="o">:</span><span class="nx">collection_mean</span><span class="p">,</span>
<span class="linenos">227</span><span class="nx">description</span><span class="o">:</span><span class="s1">&#39;fvc_mean&#39;</span><span class="p">,</span>
<span class="linenos">228</span><span class="nx">fileNamePrefix</span><span class="o">:</span><span class="s1">&#39;GJ_fvc_mean&#39;</span><span class="p">,</span>
<span class="linenos">229</span><span class="nx">scale</span><span class="o">:</span><span class="mf">30</span><span class="p">,</span>
<span class="linenos">230</span><span class="nx">region</span><span class="o">:</span><span class="nx">GJ</span><span class="p">,</span>
<span class="linenos">231</span><span class="nx">maxPixels</span><span class="o">:</span><span class="mf">1e13</span>
<span class="linenos">232</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="global-urban-extent-from-landsat">
<h3>Global Urban Extent from Landsat<a class="headerlink" href="#global-urban-extent-from-landsat" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="linenos">   1</span><span class="c1">// Global Urban Extent from Landsat</span>
<span class="linenos">   2</span><span class="c1">// by Dr. Paolo Gamba</span>
<span class="linenos">   3</span><span class="c1">// https://groups.google.com/d/msg/google-earth-engine-developers/guLCR1NvNnI/wQfARABvBgAJ</span>
<span class="linenos">   4</span>
<span class="linenos">   5</span><span class="c1">// Global script multi years 2.0</span>
<span class="linenos">   6</span><span class="c1">// ====================================== //</span>
<span class="linenos">   7</span><span class="c1">//          Parameters to be set          //</span>
<span class="linenos">   8</span><span class="c1">// ====================================== //</span>
<span class="linenos">   9</span>
<span class="linenos">  10</span><span class="c1">// General options</span>
<span class="linenos">  11</span><span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="s2">&quot;Center Asia&quot;</span><span class="p">;</span>             <span class="c1">// the name of the region in &quot;Global Shape Table&quot;:</span>
<span class="linenos">  12</span>                                    <span class="c1">//   North America, Center South America,</span>
<span class="linenos">  13</span>                                    <span class="c1">//   North South America, South South America,</span>
<span class="linenos">  14</span>                                    <span class="c1">//   Europe, North Africa, Center South Africa,</span>
<span class="linenos">  15</span>                                    <span class="c1">//   Center Africa, Souht Africa Oceania</span>
<span class="linenos">  16</span>                                    <span class="c1">//   Russia Japan, Center Asia, India, South Est Asia</span>
<span class="linenos">  17</span>                                    <span class="c1">//   Indonesia, Indochina</span>
<span class="linenos">  18</span>                                    <span class="c1">//</span>
<span class="linenos">  19</span><span class="kd">var</span> <span class="nx">convex_hull</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>              <span class="c1">// apply the convex hull to the polygon of the chosen area</span>
<span class="linenos">  20</span>                                    <span class="c1">// NB: it must be true for Russia Japan and Oceania</span>
<span class="linenos">  21</span>                                    <span class="c1">//</span>
<span class="linenos">  22</span>
<span class="linenos">  23</span><span class="kd">var</span> <span class="nx">country_name</span> <span class="o">=</span>  <span class="s2">&quot;Turkey&quot;</span><span class="p">;</span>     <span class="c1">// the name of selected country in Google &quot;Countries of the World&quot; table</span>
<span class="linenos">  24</span>                                    <span class="c1">// (set &quot;&quot; if you want to use the entire area instead of this country alone)</span>
<span class="linenos">  25</span>
<span class="linenos">  26</span><span class="kd">var</span> <span class="nx">province_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>               <span class="c1">// selected province of Indonesia</span>
<span class="linenos">  27</span>                                    <span class="c1">// (set &quot;&quot; if you want to use the entire Indonesia or China, not use for other countries!)</span>
<span class="linenos">  28</span>
<span class="linenos">  29</span><span class="kd">var</span> <span class="nx">center_on</span> <span class="o">=</span> <span class="s2">&quot;Istanbul&quot;</span><span class="p">;</span>            <span class="c1">// Name of city on which center the zoom</span>
<span class="linenos">  30</span>                                    <span class="c1">// (set &quot;&quot; if you want to zoom on entire area)</span>
<span class="linenos">  31</span>
<span class="linenos">  32</span>
<span class="linenos">  33</span><span class="kd">var</span> <span class="nx">year</span> <span class="o">=</span> <span class="mf">2015</span><span class="p">;</span>                      <span class="c1">// starting year of the collection</span>
<span class="linenos">  34</span><span class="kd">var</span> <span class="nx">number_of_years</span> <span class="o">=</span><span class="mf">30</span><span class="p">;</span>             <span class="c1">// total number of years to analyze (MAX 30)</span>
<span class="linenos">  35</span><span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="mf">10</span><span class="p">;</span>                         <span class="c1">// step progress (e.g. 1 year in 1 year, 2 years in 2 years, ecc.)</span>
<span class="linenos">  36</span><span class="kd">var</span> <span class="nx">collection_type</span> <span class="o">=</span> <span class="s2">&quot;greenest&quot;</span><span class="p">;</span>     <span class="c1">// greenest or standard or simplecomposite</span>
<span class="linenos">  37</span><span class="kd">var</span> <span class="nx">sensor</span> <span class="o">=</span> <span class="s2">&quot;L8&quot;</span><span class="p">;</span>                    <span class="c1">// L5, L7, L8 or L45 (only before 1995!)</span>
<span class="linenos">  38</span><span class="kd">var</span> <span class="nx">cloud_cover</span> <span class="o">=</span> <span class="mf">1</span><span class="p">;</span>                  <span class="c1">// % of cloud cover</span>
<span class="linenos">  39</span><span class="kd">var</span> <span class="nx">waterfilter</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>               <span class="c1">// enable/disable water filter in classification</span>
<span class="linenos">  40</span><span class="kd">var</span> <span class="nx">zoom</span> <span class="o">=</span> <span class="mf">7</span><span class="p">;</span>                         <span class="c1">// level of zoom (center_on automatically set zoom+</span>
<span class="linenos">  41</span>
<span class="linenos">  42</span><span class="c1">// NDVI options</span>
<span class="linenos">  43</span><span class="kd">var</span> <span class="nx">mask_ndvi</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>                <span class="c1">// enable/disable the ndvi mask</span>
<span class="linenos">  44</span><span class="kd">var</span> <span class="nx">th_ndvi_high</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>               <span class="c1">// 1st threshold for ndvi, put at zero all points in classification over this value</span>
<span class="linenos">  45</span><span class="kd">var</span> <span class="nx">th_ndvi_low</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">;</span>               <span class="c1">// 2st threshold for ndvi, put at zero all points in classification under this value</span>
<span class="linenos">  46</span>
<span class="linenos">  47</span><span class="c1">// Elevation options</span>
<span class="linenos">  48</span><span class="kd">var</span> <span class="nx">mask_slope</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>               <span class="c1">// enable/disable the slope mask</span>
<span class="linenos">  49</span><span class="kd">var</span> <span class="nx">th_slope</span> <span class="o">=</span> <span class="mf">10</span><span class="p">;</span>                    <span class="c1">// threshold for slope in degrees, put at zero all points in classification over this value</span>
<span class="linenos">  50</span><span class="kd">var</span> <span class="nx">mask_dem</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>                 <span class="c1">// enable/disable the slope mask</span>
<span class="linenos">  51</span><span class="kd">var</span> <span class="nx">th_dem</span> <span class="o">=</span> <span class="mf">2000</span><span class="p">;</span>                    <span class="c1">// threshold for slope in degrees, put at zero all points in classification over this value</span>
<span class="linenos">  52</span><span class="kd">var</span> <span class="nx">use_geometry</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>             <span class="c1">// if false apply dem mask to all image, if true only inside the rectangle</span>
<span class="linenos">  53</span><span class="kd">var</span> <span class="nx">dem_geometry</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mf">106.67450</span><span class="p">,</span><span class="o">-</span><span class="mf">6.79826</span><span class="p">,</span>  <span class="mf">107.08649</span><span class="p">,</span><span class="o">-</span><span class="mf">7.11452</span><span class="p">);</span>
<span class="linenos">  54</span>
<span class="linenos">  55</span><span class="c1">// Morphology options</span>
<span class="linenos">  56</span><span class="kd">var</span> <span class="nx">morphology_on</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>             <span class="c1">// enable/disable morphology</span>
<span class="linenos">  57</span><span class="kd">var</span> <span class="nx">operator</span> <span class="o">=</span> <span class="s1">&#39;Window.min&#39;</span><span class="p">;</span>          <span class="c1">// &#39;Window.min&#39; -&gt; erode; &#39;Window.max&#39; -&gt; dilate</span>
<span class="linenos">  58</span><span class="kd">var</span> <span class="nx">radius1</span> <span class="o">=</span> <span class="mf">400</span><span class="p">;</span>                    <span class="c1">// radius of the kernel closing/opening</span>
<span class="linenos">  59</span><span class="kd">var</span> <span class="nx">radius2</span> <span class="o">=</span> <span class="mf">50</span><span class="p">;</span>                     <span class="c1">// radius of final closing;</span>
<span class="linenos">  60</span><span class="kd">var</span> <span class="nx">kernelType</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">;</span>            <span class="c1">// &#39;circle&#39;, &#39;square&#39;, &#39;cross&#39;, &#39;plus&#39;, &#39;octagon&#39; or &#39;diamond&#39;</span>
<span class="linenos">  61</span><span class="kd">var</span> <span class="nx">units</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">;</span>                 <span class="c1">// units of measure: &#39;meters&#39; or &#39;pixels&#39;</span>
<span class="linenos">  62</span><span class="kd">var</span> <span class="nx">iterations</span> <span class="o">=</span> <span class="mf">1</span><span class="p">;</span>
<span class="linenos">  63</span>
<span class="linenos">  64</span><span class="kd">var</span> <span class="nx">class_or_flag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>             <span class="c1">// enable/disable the new and method correction</span>
<span class="linenos">  65</span><span class="kd">var</span> <span class="nx">class_morph_radius</span> <span class="o">=</span> <span class="mf">7</span><span class="p">;</span>
<span class="linenos">  66</span>
<span class="linenos">  67</span><span class="c1">// Ground Truth</span>
<span class="linenos">  68</span><span class="kd">var</span> <span class="nx">GT_enable</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>                <span class="c1">// enable/disable ground truth</span>
<span class="linenos">  69</span><span class="kd">var</span> <span class="nx">GT_region</span> <span class="o">=</span> <span class="s1">&#39;Southeast Asia&#39;</span><span class="p">;</span>     <span class="c1">// the name of the region in Universe of cities Table:</span>
<span class="linenos">  70</span>                                    <span class="c1">//   Eastern Asia &amp; Pacific</span>
<span class="linenos">  71</span>                                    <span class="c1">//   Southeast Asia</span>
<span class="linenos">  72</span>                                    <span class="c1">//   Western Asia</span>
<span class="linenos">  73</span>                                    <span class="c1">//   South &amp; Central Asia</span>
<span class="linenos">  74</span>                                    <span class="c1">//   Europe &amp; Japan</span>
<span class="linenos">  75</span>                                    <span class="c1">//   Northern Africa</span>
<span class="linenos">  76</span>                                    <span class="c1">//   Sub-Saharan Africa</span>
<span class="linenos">  77</span>                                    <span class="c1">//   Land Rich Developed Count (north america)</span>
<span class="linenos">  78</span>                                    <span class="c1">//   Latin America &amp; the Carib</span>
<span class="linenos">  79</span>
<span class="linenos">  80</span><span class="c1">// Classifier parameters</span>
<span class="linenos">  81</span><span class="kd">var</span> <span class="nx">ts_type</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>                      <span class="c1">// set the type of training set to use:</span>
<span class="linenos">  82</span>                                    <span class="c1">//    0 -&gt; fusion table(s) IMPORTANT! GO TO LINE 1081 TO SET WHICH FUSION TABLES TO USE</span>
<span class="linenos">  83</span>                                    <span class="c1">//    1 -&gt; globcover random points</span>
<span class="linenos">  84</span>                                    <span class="c1">//    2 -&gt; universe of cities random points</span>
<span class="linenos">  85</span>
<span class="linenos">  86</span><span class="kd">var</span> <span class="nx">multiclassifier</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>          <span class="c1">// false for single classification true for three classifiers</span>
<span class="linenos">  87</span><span class="kd">var</span> <span class="nx">multi_random</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>              <span class="c1">// if true generate 3 random sets instead of one using the seeds of the next line</span>
<span class="linenos">  88</span>                                    <span class="c1">// (WORKS ONLY FOR ts_type = 2)</span>
<span class="linenos">  89</span><span class="kd">var</span> <span class="nx">seeds</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span>
<span class="linenos">  90</span>
<span class="linenos">  91</span><span class="kd">var</span> <span class="nx">classifiers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mf">5</span><span class="p">,</span><span class="mf">9</span><span class="p">,</span><span class="mf">6</span><span class="p">);</span>   <span class="c1">// CHOOSE CLASSIFIER(S): (IMPORTANT! if multiclassifier is false only the first one is used)</span>
<span class="linenos">  92</span>                                    <span class="c1">//    0 = &quot;FastNaiveBayes&quot;</span>
<span class="linenos">  93</span>                                    <span class="c1">//    1 = &quot;GmoMaxEnt&quot;</span>
<span class="linenos">  94</span>                                    <span class="c1">//    2 = &quot;Winnow&quot;</span>
<span class="linenos">  95</span>                                    <span class="c1">//    3 = &quot;MultiClassPerceptron&quot;</span>
<span class="linenos">  96</span>                                    <span class="c1">//    4 = &quot;Pegasos&quot;</span>
<span class="linenos">  97</span>                                    <span class="c1">//    5 = &quot;Cart&quot;</span>
<span class="linenos">  98</span>                                    <span class="c1">//    6 = &quot;RifleSerialClassifier&quot; (aka Random Forest)</span>
<span class="linenos">  99</span>                                    <span class="c1">//    7 = &quot;IKPamir&quot;</span>
<span class="linenos"> 100</span>                                    <span class="c1">//    8 = &quot;VotingSvm&quot;</span>
<span class="linenos"> 101</span>                                    <span class="c1">//    9 = &quot;MarginSvm&quot;</span>
<span class="linenos"> 102</span>
<span class="linenos"> 103</span><span class="kd">var</span> <span class="nx">compute_area</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>              <span class="c1">// compute area of classified data</span>
<span class="linenos"> 104</span><span class="kd">var</span> <span class="nx">area_scale</span> <span class="o">=</span> <span class="mf">300</span><span class="p">;</span>                 <span class="c1">// scale factor for area computation</span>
<span class="linenos"> 105</span>
<span class="linenos"> 106</span><span class="c1">// RANDOM POINTS TRAINING SET PARAMETERS</span>
<span class="linenos"> 107</span><span class="kd">var</span> <span class="nx">num_points</span> <span class="o">=</span> <span class="mf">500</span><span class="p">;</span>                 <span class="c1">// num points to generate</span>
<span class="linenos"> 108</span>
<span class="linenos"> 109</span><span class="c1">// Globcover random points parameters</span>
<span class="linenos"> 110</span><span class="kd">var</span> <span class="nx">lng</span> <span class="o">=</span> <span class="o">-</span><span class="mf">48.90564</span><span class="p">;</span>                  <span class="c1">// coordinates of the quad</span>
<span class="linenos"> 111</span><span class="kd">var</span> <span class="nx">lat</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.890311</span><span class="p">;</span>
<span class="linenos"> 112</span><span class="kd">var</span> <span class="nx">radius1</span> <span class="o">=</span> <span class="mf">500</span><span class="p">;</span>                    <span class="c1">// radius of the kernel</span>
<span class="linenos"> 113</span><span class="kd">var</span> <span class="nx">kernelType1</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">;</span>           <span class="c1">//&#39;circle&#39;, &#39;square&#39;, &#39;cross&#39;, &#39;plus&#39;, &#39;octagon&#39; or &#39;diamond&#39;</span>
<span class="linenos"> 114</span>
<span class="linenos"> 115</span>
<span class="linenos"> 116</span><span class="c1">// Universe of cities paramters:</span>
<span class="linenos"> 117</span><span class="c1">// load universe of cities polygons (NOT CHANGE THIS LINE!)</span>
<span class="linenos"> 118</span><span class="kd">var</span> <span class="nx">cities_table</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;ft:1pQ-PrIEGrYa2Y3v9tsN1xwfYuqRIqOoDPARgpwzS&#39;</span><span class="p">);</span>
<span class="linenos"> 119</span>
<span class="linenos"> 120</span><span class="c1">// Choose the city or the cities to use</span>
<span class="linenos"> 121</span><span class="kd">var</span> <span class="nx">selectedCities</span> <span class="o">=</span> <span class="nx">cities_table</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;MAIN_CITY&#39;</span><span class="p">,</span> <span class="s1">&#39;Istanbul&#39;</span><span class="p">));</span> <span class="c1">// use this line only if there is one city!</span>
<span class="linenos"> 122</span><span class="cm">/*var selectedCities = cities_table.filter(ee.Filter.or(ee.Filter.eq(&#39;MAIN_CITY&#39;, &#39;Kunming&#39;), // use this command lines if there are more then one city</span>
<span class="linenos"> 123</span><span class="cm">                                                    ee.Filter.eq(&#39;MAIN_CITY&#39;, &#39;Yuxi&#39;),</span>
<span class="linenos"> 124</span><span class="cm">                                                    ee.Filter.eq(&#39;MAIN_CITY&#39;, &#39;Qujing&#39;)));</span>
<span class="linenos"> 125</span><span class="cm">*/</span>
<span class="linenos"> 126</span><span class="kd">var</span> <span class="nx">use_all_cities</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>              <span class="c1">// set true to use all the cities of the current provice</span>
<span class="linenos"> 127</span>                                        <span class="c1">// instead of the selected ones</span>
<span class="linenos"> 128</span>
<span class="linenos"> 129</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 130</span><span class="c1">//          Loading basic data            //</span>
<span class="linenos"> 131</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 132</span>
<span class="linenos"> 133</span><span class="c1">// LOAD POLYGONS</span>
<span class="linenos"> 134</span><span class="c1">// find area in the world</span>
<span class="linenos"> 135</span><span class="kd">var</span> <span class="nx">shapes</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1rYMVQMw3hTr8IC2d3Ad8nHzHmQy8iBJCqAN20l_O&quot;</span><span class="p">);</span>
<span class="linenos"> 136</span><span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="nx">shapes</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;Area&#39;</span><span class="p">,</span> <span class="nx">area</span><span class="p">));</span>
<span class="linenos"> 137</span>
<span class="linenos"> 138</span><span class="c1">// Find Countries in the world</span>
<span class="linenos"> 139</span><span class="kd">var</span> <span class="nx">countries</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;ft:1tdSwUL7MVpOauSgRzqVTOwdfy17KDbw-1d9omPw&#39;</span><span class="p">);</span>
<span class="linenos"> 140</span><span class="kd">var</span> <span class="nx">country</span> <span class="o">=</span> <span class="nx">countries</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="nx">country_name</span><span class="p">));</span>
<span class="linenos"> 141</span>
<span class="linenos"> 142</span>
<span class="linenos"> 143</span><span class="c1">// Find provinces in the selected country</span>
<span class="linenos"> 144</span><span class="kd">var</span> <span class="nx">province</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="linenos"> 145</span><span class="kd">var</span> <span class="nx">provinces_table</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="linenos"> 146</span><span class="k">if</span><span class="p">(</span><span class="nx">country_name</span> <span class="o">===</span> <span class="s2">&quot;Indonesia&quot;</span><span class="p">)</span>
<span class="linenos"> 147</span><span class="p">{</span>
<span class="linenos"> 148</span><span class="c1">// find province of Indonesia</span>
<span class="linenos"> 149</span><span class="nx">provinces_table</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;ft:1ep1h4bOMUOEg0jwjmmn78T-L32zLbILZotS2lwUC&#39;</span><span class="p">);</span>
<span class="linenos"> 150</span><span class="nx">province</span> <span class="o">=</span> <span class="nx">provinces_table</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nx">province_name</span><span class="p">));</span>
<span class="linenos"> 151</span><span class="p">}</span>
<span class="linenos"> 152</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">country_name</span> <span class="o">===</span> <span class="s2">&quot;China&quot;</span><span class="p">)</span>
<span class="linenos"> 153</span><span class="p">{</span>
<span class="linenos"> 154</span><span class="c1">// Find Province of China</span>
<span class="linenos"> 155</span><span class="nx">provinces_table</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;ft:1h7DGU8yXMYqULLM3F4AsvLPOXiR5WTRswSgWLeHH&#39;</span><span class="p">);</span>
<span class="linenos"> 156</span><span class="nx">province</span> <span class="o">=</span> <span class="nx">provinces_table</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;NAME_1&#39;</span><span class="p">,</span> <span class="nx">province_name</span><span class="p">));</span>
<span class="linenos"> 157</span><span class="p">}</span>
<span class="linenos"> 158</span>
<span class="linenos"> 159</span><span class="c1">// load main polygon</span>
<span class="linenos"> 160</span><span class="kd">var</span> <span class="nx">choosen_zone</span> <span class="o">=</span> <span class="p">(</span><span class="nx">province</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nx">country_name</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">filter</span> <span class="o">:</span> <span class="nx">country</span><span class="p">)</span> <span class="o">:</span> <span class="nx">province</span> <span class="p">;</span>
<span class="linenos"> 161</span><span class="kd">var</span> <span class="nx">polygon1</span> <span class="o">=</span> <span class="nx">choosen_zone</span><span class="p">.</span><span class="nx">geometry</span><span class="p">();</span>
<span class="linenos"> 162</span>
<span class="linenos"> 163</span><span class="k">if</span><span class="p">(</span><span class="nx">convex_hull</span><span class="o">===</span><span class="kc">true</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">choosen_zone</span> <span class="o">===</span> <span class="nx">filter</span><span class="p">))</span>
<span class="linenos"> 164</span><span class="nx">polygon1</span> <span class="o">=</span> <span class="nx">polygon1</span><span class="p">.</span><span class="nx">convexHull</span><span class="p">();</span>
<span class="linenos"> 165</span>
<span class="linenos"> 166</span><span class="c1">// classifier types</span>
<span class="linenos"> 167</span><span class="kd">var</span> <span class="nx">classifier_array</span> <span class="o">=</span> <span class="p">[</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">naiveBayes</span><span class="p">(),</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">gmoMaxEnt</span><span class="p">(),</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">winnow</span><span class="p">(),</span>
<span class="linenos"> 168</span>                        <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">perceptron</span><span class="p">(),</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">pegasosLinear</span><span class="p">(),</span>
<span class="linenos"> 169</span>                        <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">cart</span><span class="p">(),</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">randomForest</span><span class="p">(),</span>
<span class="linenos"> 170</span>                        <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">ikpamir</span><span class="p">(),</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">svm</span><span class="p">(),</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">svm</span><span class="p">(</span><span class="s2">&quot;Margin&quot;</span><span class="p">)];</span>
<span class="linenos"> 171</span>
<span class="linenos"> 172</span><span class="c1">// classifier names</span>
<span class="linenos"> 173</span><span class="kd">var</span> <span class="nx">classifier_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NaiveBayes&quot;</span><span class="p">,</span> <span class="s2">&quot;GmoMaxEnt&quot;</span><span class="p">,</span> <span class="s2">&quot;Winnow&quot;</span><span class="p">,</span> <span class="s2">&quot;MultiClassPerceptron&quot;</span><span class="p">,</span> <span class="s2">&quot;PegasosLinear&quot;</span><span class="p">,</span>
<span class="linenos"> 174</span>                        <span class="s2">&quot;Cart&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomForest&quot;</span><span class="p">,</span> <span class="s2">&quot;IKPamir&quot;</span><span class="p">,</span> <span class="s2">&quot;Svm&quot;</span><span class="p">,</span> <span class="s2">&quot;MarginSvm&quot;</span><span class="p">];</span>
<span class="linenos"> 175</span>
<span class="linenos"> 176</span><span class="c1">// load elevation data</span>
<span class="linenos"> 177</span><span class="k">if</span><span class="p">(</span><span class="nx">mask_slope</span><span class="o">===</span><span class="kc">true</span> <span class="o">||</span> <span class="nx">mask_dem</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos"> 178</span>    <span class="kd">var</span> <span class="nx">dem</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s2">&quot;CGIAR/SRTM90_V4&quot;</span><span class="p">);</span>
<span class="linenos"> 179</span>
<span class="linenos"> 180</span><span class="c1">// Load ground truth data</span>
<span class="linenos"> 181</span><span class="k">if</span><span class="p">(</span><span class="nx">GT_enable</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos"> 182</span><span class="p">{</span>
<span class="linenos"> 183</span><span class="kd">var</span> <span class="nx">GT_regions</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;ft:1pQ-PrIEGrYa2Y3v9tsN1xwfYuqRIqOoDPARgpwzS&#39;</span><span class="p">);</span>
<span class="linenos"> 184</span><span class="kd">var</span> <span class="nx">GT_selectedRegions</span> <span class="o">=</span> <span class="nx">GT_regions</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;REGION&#39;</span><span class="p">,</span> <span class="nx">GT_region</span><span class="p">));</span>
<span class="linenos"> 185</span><span class="p">}</span>
<span class="linenos"> 186</span>
<span class="linenos"> 187</span><span class="k">if</span><span class="p">(</span><span class="nx">use_all_cities</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span>
<span class="linenos"> 188</span><span class="p">{</span>
<span class="linenos"> 189</span><span class="cm">/*</span>
<span class="linenos"> 190</span><span class="cm">// Universe of cities paramters:</span>
<span class="linenos"> 191</span><span class="cm">// Join the two collection on their geometries if they&#39;re within 2km.</span>
<span class="linenos"> 192</span><span class="cm">var joinFilter = ee.Filter.intersects(&#39;geometry&#39;, null, &#39;geometry&#39;, null);</span>
<span class="linenos"> 193</span><span class="cm">var selectedCities = ee.Join.simple().apply(cities_table, province, joinFilter);</span>
<span class="linenos"> 194</span><span class="cm">*/</span>
<span class="linenos"> 195</span>
<span class="linenos"> 196</span><span class="c1">// Choose the city or the cities to use</span>
<span class="linenos"> 197</span><span class="kd">var</span> <span class="nx">allCities</span> <span class="o">=</span> <span class="nx">cities_table</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="nx">country_name</span><span class="p">));</span>
<span class="linenos"> 198</span><span class="kd">var</span> <span class="nx">allProvinceCities</span> <span class="o">=</span> <span class="nx">allCities</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos"> 199</span>    <span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Inside&quot;</span><span class="p">,</span>
<span class="linenos"> 200</span>        <span class="nx">ee</span><span class="p">.</span><span class="nx">Algorithms</span><span class="p">.</span><span class="nx">If</span><span class="p">((</span><span class="nx">f</span><span class="p">.</span><span class="nx">geometry</span><span class="p">()).</span><span class="nx">containedIn</span><span class="p">(</span><span class="nx">polygon1</span><span class="p">),</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">));</span>
<span class="linenos"> 201</span><span class="p">});</span>
<span class="linenos"> 202</span><span class="nx">selectedCities</span> <span class="o">=</span> <span class="nx">allProvinceCities</span><span class="p">.</span><span class="nx">filterMetadata</span><span class="p">(</span><span class="s1">&#39;Inside&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="linenos"> 203</span>
<span class="linenos"> 204</span><span class="p">}</span>
<span class="linenos"> 205</span>
<span class="linenos"> 206</span><span class="c1">// check for incorrect parameters</span>
<span class="linenos"> 207</span><span class="k">if</span><span class="p">(</span><span class="nx">ts_type</span><span class="o">!==</span><span class="mf">2</span><span class="p">)</span>
<span class="linenos"> 208</span><span class="nx">multi_random</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 209</span>
<span class="linenos"> 210</span><span class="k">if</span><span class="p">(</span><span class="nx">sensor</span><span class="o">===</span><span class="s2">&quot;L45&quot;</span><span class="p">)</span>
<span class="linenos"> 211</span><span class="nx">collection_type</span> <span class="o">=</span> <span class="s2">&quot;standard&quot;</span><span class="p">;</span>
<span class="linenos"> 212</span>
<span class="linenos"> 213</span>
<span class="linenos"> 214</span><span class="c1">// color palette for classification</span>
<span class="linenos"> 215</span><span class="kd">var</span> <span class="nx">palette_list</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span> <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, ff0000&#39;</span><span class="p">},</span>
<span class="linenos"> 216</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, ffff00&#39;</span><span class="p">},</span>
<span class="linenos"> 217</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 00ff00&#39;</span><span class="p">},</span>
<span class="linenos"> 218</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, ff00ff&#39;</span><span class="p">},</span>
<span class="linenos"> 219</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 00ffff&#39;</span><span class="p">},</span>
<span class="linenos"> 220</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, FFA500&#39;</span><span class="p">},</span>
<span class="linenos"> 221</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 0000ff&#39;</span><span class="p">},</span>
<span class="linenos"> 222</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 800000&#39;</span><span class="p">},</span>
<span class="linenos"> 223</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 8A2BE2&#39;</span><span class="p">},</span>
<span class="linenos"> 224</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, FA8072&#39;</span><span class="p">},</span>
<span class="linenos"> 225</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 32CD32&#39;</span><span class="p">},</span>
<span class="linenos"> 226</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, F4A460&#39;</span><span class="p">},</span>
<span class="linenos"> 227</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 1E90FF&#39;</span><span class="p">},</span>
<span class="linenos"> 228</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, F0E68C&#39;</span><span class="p">},</span>
<span class="linenos"> 229</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 228B22&#39;</span><span class="p">},</span>
<span class="linenos"> 230</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, FFD700&#39;</span><span class="p">},</span>
<span class="linenos"> 231</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, E6E6FA&#39;</span><span class="p">},</span>
<span class="linenos"> 232</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, A0522D&#39;</span><span class="p">},</span>
<span class="linenos"> 233</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, FFC0CB&#39;</span><span class="p">},</span>
<span class="linenos"> 234</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 66CDAA&#39;</span><span class="p">},</span>
<span class="linenos"> 235</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, FF8C00&#39;</span><span class="p">},</span>
<span class="linenos"> 236</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 9932CC&#39;</span><span class="p">},</span>
<span class="linenos"> 237</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 7FFF00&#39;</span><span class="p">},</span>
<span class="linenos"> 238</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 7FFF00&#39;</span><span class="p">},</span>
<span class="linenos"> 239</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, CD853F&#39;</span><span class="p">},</span>
<span class="linenos"> 240</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, FAEBD7&#39;</span><span class="p">},</span>
<span class="linenos"> 241</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, DDA0DD&#39;</span><span class="p">},</span>
<span class="linenos"> 242</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 808000&#39;</span><span class="p">},</span>
<span class="linenos"> 243</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, FFDAB9&#39;</span><span class="p">},</span>
<span class="linenos"> 244</span>                            <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 4169E1&#39;</span><span class="p">});</span>
<span class="linenos"> 245</span>
<span class="linenos"> 246</span>
<span class="linenos"> 247</span><span class="c1">// task name</span>
<span class="linenos"> 248</span><span class="kd">var</span> <span class="nx">task_name</span> <span class="o">=</span> <span class="p">((</span><span class="nx">country_name</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">area</span> <span class="o">:</span> <span class="nx">country_name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_from_&quot;</span> <span class="o">+</span> <span class="nx">year</span> <span class="o">+</span> <span class="s2">&quot;_to_&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">year</span><span class="o">-</span><span class="nx">number_of_years</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span>
<span class="linenos"> 249</span>                <span class="p">(</span><span class="nx">collection_type</span><span class="o">===</span><span class="s2">&quot;greenest&quot;</span> <span class="o">?</span> <span class="s2">&quot;_L7_Annual_Greenest_TOA&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nx">sensor</span> <span class="o">+</span> <span class="s2">&quot;_TOA_cloud_cover_&quot;</span> <span class="o">+</span> <span class="nx">cloud_cover</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">))</span> <span class="o">+</span>
<span class="linenos"> 250</span>                <span class="p">(</span><span class="nx">multiclassifier</span><span class="o">===</span><span class="kc">true</span> <span class="o">?</span> <span class="s2">&quot;_3_Classifiers&quot;</span> <span class="o">:</span> <span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nx">classifier_names</span><span class="p">[</span><span class="nx">classifiers</span><span class="p">[</span><span class="mf">0</span><span class="p">]])</span> <span class="o">+</span>
<span class="linenos"> 251</span>                <span class="p">(</span><span class="nx">morphology_on</span><span class="o">===</span><span class="kc">true</span> <span class="o">?</span> <span class="s2">&quot;_with_morphology&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="linenos"> 252</span>
<span class="linenos"> 253</span>
<span class="linenos"> 254</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 255</span><span class="c1">//              Fusion Tables             //</span>
<span class="linenos"> 256</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 257</span>
<span class="linenos"> 258</span><span class="c1">// Jakarta</span>
<span class="linenos"> 259</span><span class="kd">var</span> <span class="nx">ft1</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1JYib5GQkiNTMnt2rpVteos0jQeYE9jVXIhCE8_M&quot;</span><span class="p">);</span>
<span class="linenos"> 260</span><span class="nx">ft1</span> <span class="o">=</span> <span class="nx">ft1</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">],</span>
<span class="linenos"> 261</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 262</span>
<span class="linenos"> 263</span><span class="c1">// Kota Bandung</span>
<span class="linenos"> 264</span><span class="kd">var</span> <span class="nx">ft2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1Z0VTqrovwUR0iujsgw6Y44_tLpjkFUeyivn2f2A&quot;</span><span class="p">);</span>
<span class="linenos"> 265</span><span class="nx">ft2</span> <span class="o">=</span> <span class="nx">ft2</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">,</span><span class="mf">214</span><span class="p">,</span><span class="mf">215</span><span class="p">,</span><span class="mf">216</span><span class="p">,</span><span class="mf">217</span><span class="p">,</span><span class="mf">218</span><span class="p">,</span><span class="mf">219</span><span class="p">,</span><span class="mf">220</span><span class="p">],</span>
<span class="linenos"> 266</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 267</span>
<span class="linenos"> 268</span><span class="c1">// Kota Manado</span>
<span class="linenos"> 269</span><span class="kd">var</span> <span class="nx">ft3</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1Dd68TvI-rYwNe9BHhDkdcUnUg17PKeLUdtwqTR4&quot;</span><span class="p">);</span>
<span class="linenos"> 270</span><span class="nx">ft3</span> <span class="o">=</span> <span class="nx">ft3</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">300</span><span class="p">,</span><span class="mf">301</span><span class="p">,</span><span class="mf">302</span><span class="p">,</span><span class="mf">400</span><span class="p">,</span><span class="mf">401</span><span class="p">,</span><span class="mf">402</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 271</span>
<span class="linenos"> 272</span><span class="c1">// Kuala Lumpur</span>
<span class="linenos"> 273</span><span class="kd">var</span> <span class="nx">ft4</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1d_HFpj2iM3S8KBHubF5WEERwXaGSChraPbONdC0&quot;</span><span class="p">);</span>
<span class="linenos"> 274</span><span class="nx">ft4</span> <span class="o">=</span> <span class="nx">ft4</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">,</span><span class="mf">214</span><span class="p">,</span><span class="mf">215</span><span class="p">,</span><span class="mf">216</span><span class="p">],</span>
<span class="linenos"> 275</span>            <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 276</span>
<span class="linenos"> 277</span><span class="c1">// Kalimatan</span>
<span class="linenos"> 278</span><span class="kd">var</span> <span class="nx">ft5</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1m3KKK0ApX90x1bLOy-WU_XNitj8fVtw19lXLWZU&quot;</span><span class="p">);</span>
<span class="linenos"> 279</span><span class="nx">ft5</span> <span class="o">=</span> <span class="nx">ft5</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 280</span>
<span class="linenos"> 281</span><span class="c1">// Surabaya</span>
<span class="linenos"> 282</span><span class="kd">var</span> <span class="nx">ft6</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:10IZ12uFHlmGZMuzgOkk3HuvAuHdM2Iu10O7MPxk&quot;</span><span class="p">);</span>
<span class="linenos"> 283</span><span class="nx">ft6</span> <span class="o">=</span> <span class="nx">ft6</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">],</span>
<span class="linenos"> 284</span>            <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 285</span>
<span class="linenos"> 286</span><span class="c1">// San Paolo</span>
<span class="linenos"> 287</span><span class="kd">var</span> <span class="nx">ft7</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1W-iBNcXotAJt06PO0EdANfOveMX8P9Sd_zxUK-w&quot;</span><span class="p">);</span>
<span class="linenos"> 288</span><span class="nx">ft7</span> <span class="o">=</span> <span class="nx">ft7</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">300</span><span class="p">,</span><span class="mf">400</span><span class="p">,</span><span class="mf">500</span><span class="p">,</span><span class="mf">600</span><span class="p">,</span><span class="mf">700</span><span class="p">,</span><span class="mf">701</span><span class="p">,</span><span class="mf">800</span><span class="p">,</span><span class="mf">900</span><span class="p">,</span><span class="mf">901</span><span class="p">,</span><span class="mf">1000</span><span class="p">,</span><span class="mf">1001</span><span class="p">,</span><span class="mf">1100</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 289</span>
<span class="linenos"> 290</span><span class="c1">// Rio</span>
<span class="linenos"> 291</span><span class="kd">var</span> <span class="nx">ft8</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1TvLP4Xe3bJ-dwDyvxudiDxn1BUZieNmDlKelpDU&quot;</span><span class="p">);</span>
<span class="linenos"> 292</span><span class="nx">ft8</span> <span class="o">=</span> <span class="nx">ft8</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 293</span>
<span class="linenos"> 294</span><span class="c1">// Recife</span>
<span class="linenos"> 295</span><span class="kd">var</span> <span class="nx">ft9</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:199COLkTjEFiYW09eF7kS6bCj6Ju-iWUk4pXwOhk&quot;</span><span class="p">);</span>
<span class="linenos"> 296</span><span class="nx">ft9</span> <span class="o">=</span> <span class="nx">ft9</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 297</span>
<span class="linenos"> 298</span><span class="c1">//Curitiba</span>
<span class="linenos"> 299</span><span class="kd">var</span> <span class="nx">ft10</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1lE5JidkBcWPtOf7jDurRezkTv72Ak4ECcCFw6I8&quot;</span><span class="p">);</span>
<span class="linenos"> 300</span><span class="nx">ft10</span> <span class="o">=</span> <span class="nx">ft10</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 301</span>
<span class="linenos"> 302</span><span class="c1">// Buonos Aires</span>
<span class="linenos"> 303</span><span class="kd">var</span> <span class="nx">ft11</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1-z1IpdYWOQe-d3xMTkxViQmWJCNfiX7stOWSf9s&quot;</span><span class="p">);</span>
<span class="linenos"> 304</span><span class="nx">ft11</span> <span class="o">=</span> <span class="nx">ft11</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 305</span>
<span class="linenos"> 306</span><span class="c1">// Mexico City</span>
<span class="linenos"> 307</span><span class="kd">var</span> <span class="nx">ft12</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1zgrzKKI2IUU_NcCIGzfSF9-GmTepsQTknlYNHok&quot;</span><span class="p">);</span>
<span class="linenos"> 308</span><span class="nx">ft12</span> <span class="o">=</span> <span class="nx">ft12</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 309</span>
<span class="linenos"> 310</span><span class="c1">// Shanghai</span>
<span class="linenos"> 311</span><span class="kd">var</span> <span class="nx">ft13</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1DUtGpGJzKiEf63LkUjJj7imQAiK0cxvawP2YQno&quot;</span><span class="p">);</span>
<span class="linenos"> 312</span><span class="nx">ft13</span> <span class="o">=</span> <span class="nx">ft13</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">300</span><span class="p">,</span><span class="mf">301</span><span class="p">,</span><span class="mf">400</span><span class="p">,</span><span class="mf">401</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 313</span>
<span class="linenos"> 314</span><span class="c1">// Jiangsu</span>
<span class="linenos"> 315</span><span class="kd">var</span> <span class="nx">ft14</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1h4dMswHa9OPy4pFsHva8fSOi7ZtfhbkDQgbB3UE&quot;</span><span class="p">);</span>
<span class="linenos"> 316</span><span class="nx">ft14</span> <span class="o">=</span> <span class="nx">ft14</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">300</span><span class="p">,</span><span class="mf">301</span><span class="p">,</span><span class="mf">302</span><span class="p">,</span><span class="mf">303</span><span class="p">,</span><span class="mf">400</span><span class="p">,</span><span class="mf">401</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 317</span>
<span class="linenos"> 318</span><span class="c1">// Cairo</span>
<span class="linenos"> 319</span><span class="kd">var</span> <span class="nx">ft15</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1S5DPVKswvcIczNqZLZXi3-YipExJ7Ez3ySFd3FE&quot;</span><span class="p">);</span>
<span class="linenos"> 320</span><span class="nx">ft15</span> <span class="o">=</span> <span class="nx">ft15</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 321</span>
<span class="linenos"> 322</span><span class="c1">// Kinshasa-Brazzaville</span>
<span class="linenos"> 323</span><span class="kd">var</span> <span class="nx">ft16</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1VmkJ_EKhOdcNjsyeJuH7Wt7AGzjZK0Il3NKJVFE&quot;</span><span class="p">);</span>
<span class="linenos"> 324</span><span class="nx">ft16</span> <span class="o">=</span> <span class="nx">ft16</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 325</span>
<span class="linenos"> 326</span><span class="c1">// Istambul</span>
<span class="linenos"> 327</span><span class="kd">var</span> <span class="nx">ft17</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1SI9e9QIEg2T7ZuBpVmz06VsSbK-Zx4Y-uNnTymo&quot;</span><span class="p">);</span>
<span class="linenos"> 328</span><span class="nx">ft17</span> <span class="o">=</span> <span class="nx">ft17</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">,</span><span class="mf">214</span><span class="p">,</span><span class="mf">215</span><span class="p">,</span><span class="mf">216</span><span class="p">],</span>
<span class="linenos"> 329</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 330</span>
<span class="linenos"> 331</span><span class="c1">// Karachi</span>
<span class="linenos"> 332</span><span class="kd">var</span> <span class="nx">ft18</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1MXNLNoQji75DduserB14ca88O1E2u_ZqrRDAcAI&quot;</span><span class="p">);</span>
<span class="linenos"> 333</span><span class="nx">ft18</span> <span class="o">=</span> <span class="nx">ft18</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 334</span>
<span class="linenos"> 335</span><span class="c1">// Londra</span>
<span class="linenos"> 336</span><span class="kd">var</span> <span class="nx">ft19</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1-ILTTjz3lvURZ7VC8q-zA0MvSln6bDz2dyj9KTc&quot;</span><span class="p">);</span>
<span class="linenos"> 337</span><span class="nx">ft19</span> <span class="o">=</span> <span class="nx">ft19</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">],</span>
<span class="linenos"> 338</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 339</span>
<span class="linenos"> 340</span><span class="c1">// Manila</span>
<span class="linenos"> 341</span><span class="kd">var</span> <span class="nx">ft20</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1VfVvegIbUX-Goi0tqjrLV2AJMxjFR9x5zXlW51c&quot;</span><span class="p">);</span>
<span class="linenos"> 342</span><span class="nx">ft20</span> <span class="o">=</span> <span class="nx">ft20</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 343</span>
<span class="linenos"> 344</span><span class="c1">// Mumbai</span>
<span class="linenos"> 345</span><span class="kd">var</span> <span class="nx">ft21</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:13IcqxzMwTjePC2cCeVcKZy6d6_sM1CqrbPWEGkY&quot;</span><span class="p">);</span>
<span class="linenos"> 346</span><span class="nx">ft21</span> <span class="o">=</span> <span class="nx">ft21</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">,</span><span class="mf">211</span><span class="p">,</span><span class="mf">212</span><span class="p">,</span><span class="mf">213</span><span class="p">,</span><span class="mf">214</span><span class="p">,</span><span class="mf">215</span><span class="p">,</span><span class="mf">216</span><span class="p">],</span>
<span class="linenos"> 347</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 348</span>
<span class="linenos"> 349</span><span class="c1">// New York</span>
<span class="linenos"> 350</span><span class="kd">var</span> <span class="nx">ft22</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1zzRtyA3nIlwQJJl6en4cm6gjrjuOI3iB_N5B9qg&quot;</span><span class="p">);</span>
<span class="linenos"> 351</span><span class="nx">ft22</span> <span class="o">=</span> <span class="nx">ft22</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">210</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 352</span>
<span class="linenos"> 353</span><span class="c1">// Osaka</span>
<span class="linenos"> 354</span><span class="kd">var</span> <span class="nx">ft23</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1gmLE5_GpE5aeamLRPaWgAcTmbzPNROXsLvexNvM&quot;</span><span class="p">);</span>
<span class="linenos"> 355</span><span class="nx">ft23</span> <span class="o">=</span> <span class="nx">ft23</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">,</span><span class="mf">208</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 356</span>
<span class="linenos"> 357</span><span class="c1">// Seul</span>
<span class="linenos"> 358</span><span class="kd">var</span> <span class="nx">ft24</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1hjcTW0AD0qApNiT9LDieZua94UbofkK6Dfd5IRg&quot;</span><span class="p">);</span>
<span class="linenos"> 359</span><span class="nx">ft24</span> <span class="o">=</span> <span class="nx">ft24</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">204</span><span class="p">,</span><span class="mf">205</span><span class="p">,</span><span class="mf">206</span><span class="p">,</span><span class="mf">207</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 360</span>
<span class="linenos"> 361</span><span class="c1">// Vietnam Dong Hoi</span>
<span class="linenos"> 362</span><span class="kd">var</span> <span class="nx">ft25</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1btvyTxRJjrigjoYWt3rB8DakxRkhQPPIbRZp_xo&quot;</span><span class="p">);</span>
<span class="linenos"> 363</span><span class="nx">ft25</span> <span class="o">=</span> <span class="nx">ft25</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 364</span>
<span class="linenos"> 365</span><span class="c1">// Vietnam Ca Mau</span>
<span class="linenos"> 366</span><span class="kd">var</span> <span class="nx">ft26</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1PM7cL_rCRf3cOTzVcWijydFXgWLsnuivyX5PYHw&quot;</span><span class="p">);</span>
<span class="linenos"> 367</span><span class="nx">ft26</span> <span class="o">=</span> <span class="nx">ft26</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 368</span>
<span class="linenos"> 369</span><span class="c1">// Vietnam sud Ca Mau</span>
<span class="linenos"> 370</span><span class="kd">var</span> <span class="nx">ft27</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1ELY75GK8n-6qYQkh87lKrrElQAvJOKhY3s8OM84&quot;</span><span class="p">);</span>
<span class="linenos"> 371</span><span class="nx">ft27</span> <span class="o">=</span> <span class="nx">ft27</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 372</span>
<span class="linenos"> 373</span><span class="c1">// Vietnam confine cina</span>
<span class="linenos"> 374</span><span class="kd">var</span> <span class="nx">ft28</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1-mKabryrKX81T86HEkOQeK9ywbnDwuUKxoPrCJY&quot;</span><span class="p">);</span>
<span class="linenos"> 375</span><span class="nx">ft28</span> <span class="o">=</span> <span class="nx">ft28</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 376</span>
<span class="linenos"> 377</span><span class="c1">// Vietnam Ho Chi Minh</span>
<span class="linenos"> 378</span><span class="kd">var</span> <span class="nx">ft29</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1B-wKLMVl1gJPvB-LG3et4F9ydAKI5A2gghk2eU4&quot;</span><span class="p">);</span>
<span class="linenos"> 379</span><span class="nx">ft29</span> <span class="o">=</span> <span class="nx">ft29</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 380</span>
<span class="linenos"> 381</span><span class="c1">// Vietnam Da Nang</span>
<span class="linenos"> 382</span><span class="kd">var</span> <span class="nx">ft30</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1jQKQJgEoYOKqihLXBEgkiFZ3JoA0jl238Uu4sc8&quot;</span><span class="p">);</span>
<span class="linenos"> 383</span><span class="nx">ft30</span> <span class="o">=</span> <span class="nx">ft30</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 384</span>
<span class="linenos"> 385</span><span class="c1">// Vietnam Quang Tri</span>
<span class="linenos"> 386</span><span class="kd">var</span> <span class="nx">ft31</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:11INXL4EThmczTQuNvH28i33fyKNnEujsKvTxKZQ&quot;</span><span class="p">);</span>
<span class="linenos"> 387</span><span class="nx">ft31</span> <span class="o">=</span> <span class="nx">ft31</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 388</span>
<span class="linenos"> 389</span><span class="c1">// Vietnam Phuroc Hoi</span>
<span class="linenos"> 390</span><span class="kd">var</span> <span class="nx">ft32</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:19tpEczaE170ez6x5ViPNDqeB7-rfoDFSv9mYVKM&quot;</span><span class="p">);</span>
<span class="linenos"> 391</span><span class="nx">ft32</span> <span class="o">=</span> <span class="nx">ft32</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 392</span>
<span class="linenos"> 393</span><span class="c1">// Vietnam Est Ho Chi Minh</span>
<span class="linenos"> 394</span><span class="kd">var</span> <span class="nx">ft33</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1Un2B568D-aG_T30POwgWnIW6NGXFlq6wNs0XhOY&quot;</span><span class="p">);</span>
<span class="linenos"> 395</span><span class="nx">ft33</span> <span class="o">=</span> <span class="nx">ft33</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 396</span>
<span class="linenos"> 397</span><span class="c1">// Vietnam Phan Rang</span>
<span class="linenos"> 398</span><span class="kd">var</span> <span class="nx">ft34</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:16sOtBxUs6lFjIj2426190MO79dObrr51Ksyh0WI&quot;</span><span class="p">);</span>
<span class="linenos"> 399</span><span class="nx">ft34</span> <span class="o">=</span> <span class="nx">ft34</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 400</span>
<span class="linenos"> 401</span><span class="c1">// Vietnam Sud Hanoi</span>
<span class="linenos"> 402</span><span class="kd">var</span> <span class="nx">ft35</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:14TVtC6AD5SVoZF0PlHFS0eV-21BvfBgRbzEx1jQ&quot;</span><span class="p">);</span>
<span class="linenos"> 403</span><span class="nx">ft35</span><span class="o">=</span> <span class="nx">ft35</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 404</span>
<span class="linenos"> 405</span><span class="c1">// Vietnam Ho Chi Minh 2</span>
<span class="linenos"> 406</span><span class="kd">var</span> <span class="nx">ft36</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1amd1UCF4ZYYFv7wipfM7P8c1jtcnC3CKlus23a0&quot;</span><span class="p">);</span>
<span class="linenos"> 407</span><span class="nx">ft36</span> <span class="o">=</span> <span class="nx">ft36</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 408</span>
<span class="linenos"> 409</span><span class="c1">// Vietnam Hanoi</span>
<span class="linenos"> 410</span><span class="kd">var</span> <span class="nx">ft37</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1lnHpA_ZlFoJ1ADqvLRno1PJV31PlTlsUXU9zwVQ&quot;</span><span class="p">);</span>
<span class="linenos"> 411</span><span class="nx">ft37</span> <span class="o">=</span> <span class="nx">ft37</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 412</span>
<span class="linenos"> 413</span><span class="c1">// Africa</span>
<span class="linenos"> 414</span><span class="kd">var</span> <span class="nx">ft38</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1Kh31mKZjrcJWXzG1MEQA00mW0-GJ8qyW4jGhlmw&quot;</span><span class="p">);</span>
<span class="linenos"> 415</span><span class="nx">ft38</span> <span class="o">=</span> <span class="nx">ft38</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span>
<span class="linenos"> 416</span>                <span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span>
<span class="linenos"> 417</span>                <span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">,</span><span class="mf">140</span><span class="p">,</span><span class="mf">141</span><span class="p">,</span><span class="mf">142</span><span class="p">,</span><span class="mf">143</span><span class="p">,</span><span class="mf">144</span><span class="p">,</span><span class="mf">145</span><span class="p">,</span><span class="mf">146</span><span class="p">,</span><span class="mf">147</span><span class="p">,</span><span class="mf">148</span><span class="p">,</span><span class="mf">149</span><span class="p">,</span><span class="mf">150</span><span class="p">,</span><span class="mf">151</span><span class="p">,</span><span class="mf">152</span><span class="p">,</span><span class="mf">153</span><span class="p">],</span>
<span class="linenos"> 418</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span>
<span class="linenos"> 419</span>                <span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 420</span>
<span class="linenos"> 421</span><span class="c1">// Dallas</span>
<span class="linenos"> 422</span><span class="kd">var</span> <span class="nx">ft39</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:10VY57FR5fcevkinyMiYvhv-bfzu-1w7bAWuV59XS&quot;</span><span class="p">);</span>
<span class="linenos"> 423</span><span class="nx">ft39</span> <span class="o">=</span> <span class="nx">ft39</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span>
<span class="linenos"> 424</span>                <span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">,</span><span class="mf">140</span><span class="p">,</span><span class="mf">141</span><span class="p">,</span><span class="mf">142</span><span class="p">],</span>
<span class="linenos"> 425</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 426</span>
<span class="linenos"> 427</span><span class="c1">// Los Angeles</span>
<span class="linenos"> 428</span><span class="kd">var</span> <span class="nx">ft40</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1xTuZ0Cja5BvyEysVGU36rTQolhk_Ad31-UWrD8a5&quot;</span><span class="p">);</span>
<span class="linenos"> 429</span><span class="nx">ft40</span> <span class="o">=</span> <span class="nx">ft40</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span>
<span class="linenos"> 430</span>                <span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">],</span>
<span class="linenos"> 431</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 432</span>
<span class="linenos"> 433</span><span class="c1">// Toronto 1998</span>
<span class="linenos"> 434</span><span class="kd">var</span> <span class="nx">ft41</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:15h2EZU85KFxcnGCgAQq0S39g7Z-ea8iO0h5GJegi&quot;</span><span class="p">);</span>
<span class="linenos"> 435</span><span class="nx">ft41</span> <span class="o">=</span> <span class="nx">ft41</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span>
<span class="linenos"> 436</span>                <span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">],</span>
<span class="linenos"> 437</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 438</span>
<span class="linenos"> 439</span><span class="c1">// Toronto 1999</span>
<span class="linenos"> 440</span><span class="kd">var</span> <span class="nx">ft42</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1lxJbARYUw5AV_ULv_Qd9aYswHdWGJQ8fJ4j31Nor&quot;</span><span class="p">);</span>
<span class="linenos"> 441</span><span class="nx">ft42</span> <span class="o">=</span> <span class="nx">ft42</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span>
<span class="linenos"> 442</span>                <span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">],</span>
<span class="linenos"> 443</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 444</span>
<span class="linenos"> 445</span><span class="c1">// Vancouver 1999</span>
<span class="linenos"> 446</span><span class="kd">var</span> <span class="nx">ft43</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1ln312_c7nvpPMoA648yqqzNJDR0HCKLr9gj7PKUx&quot;</span><span class="p">);</span>
<span class="linenos"> 447</span><span class="nx">ft43</span> <span class="o">=</span> <span class="nx">ft43</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span>
<span class="linenos"> 448</span>                <span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">,</span><span class="mf">140</span><span class="p">,</span><span class="mf">141</span><span class="p">,</span><span class="mf">142</span><span class="p">,</span><span class="mf">143</span><span class="p">,</span><span class="mf">144</span><span class="p">,</span><span class="mf">145</span><span class="p">,</span>
<span class="linenos"> 449</span>                <span class="mf">146</span><span class="p">,</span><span class="mf">147</span><span class="p">,</span><span class="mf">148</span><span class="p">,</span><span class="mf">149</span><span class="p">,</span><span class="mf">150</span><span class="p">,</span><span class="mf">151</span><span class="p">,</span><span class="mf">152</span><span class="p">,</span><span class="mf">153</span><span class="p">,</span><span class="mf">154</span><span class="p">,</span><span class="mf">155</span><span class="p">,</span><span class="mf">156</span><span class="p">,</span><span class="mf">157</span><span class="p">,</span><span class="mf">158</span><span class="p">,</span><span class="mf">159</span><span class="p">,</span><span class="mf">160</span><span class="p">,</span><span class="mf">161</span><span class="p">,</span><span class="mf">162</span><span class="p">,</span><span class="mf">163</span><span class="p">],</span>
<span class="linenos"> 450</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span>
<span class="linenos"> 451</span>                <span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 452</span>
<span class="linenos"> 453</span><span class="c1">// Vancouver 2009</span>
<span class="linenos"> 454</span><span class="kd">var</span> <span class="nx">ft44</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1ln312_c7nvpPMoA648yqqzNJDR0HCKLr9gj7PKUx&quot;</span><span class="p">);</span>
<span class="linenos"> 455</span><span class="nx">ft44</span> <span class="o">=</span> <span class="nx">ft44</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span>
<span class="linenos"> 456</span>                <span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">],</span>
<span class="linenos"> 457</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 458</span>
<span class="linenos"> 459</span><span class="c1">// Dakar - Senegal 2009</span>
<span class="linenos"> 460</span><span class="kd">var</span> <span class="nx">ft45</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1KgybS5ROczVfioCUnxNVXZL1wUHVTuejCmQDeXTs&quot;</span><span class="p">);</span>
<span class="linenos"> 461</span><span class="nx">ft45</span> <span class="o">=</span> <span class="nx">ft45</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">],[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 462</span>
<span class="linenos"> 463</span><span class="c1">// Lagos - Nigeria 2009</span>
<span class="linenos"> 464</span><span class="kd">var</span> <span class="nx">ft46</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1PVyuUjUMpaYIBQqhHSAl9_KG32hStLv_-8g0Z8wE&quot;</span><span class="p">);</span>
<span class="linenos"> 465</span><span class="nx">ft46</span> <span class="o">=</span> <span class="nx">ft46</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span>
<span class="linenos"> 466</span>                <span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">,</span><span class="mf">140</span><span class="p">,</span><span class="mf">141</span><span class="p">,</span>
<span class="linenos"> 467</span>                <span class="mf">142</span><span class="p">,</span><span class="mf">143</span><span class="p">,</span><span class="mf">144</span><span class="p">,</span><span class="mf">145</span><span class="p">,</span><span class="mf">146</span><span class="p">,</span><span class="mf">147</span><span class="p">,</span><span class="mf">148</span><span class="p">,</span><span class="mf">149</span><span class="p">,</span><span class="mf">150</span><span class="p">,</span><span class="mf">151</span><span class="p">,</span><span class="mf">152</span><span class="p">],</span>
<span class="linenos"> 468</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span>
<span class="linenos"> 469</span>                    <span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 470</span>
<span class="linenos"> 471</span><span class="c1">// Bangui - Repubblica Centro Africana 2009</span>
<span class="linenos"> 472</span><span class="kd">var</span> <span class="nx">ft47</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1vNMbsMDdhdmLuy39PFMnzicD11PFCyfScF6UeTTw&quot;</span><span class="p">);</span>
<span class="linenos"> 473</span><span class="nx">ft47</span> <span class="o">=</span> <span class="nx">ft47</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span>
<span class="linenos"> 474</span>                <span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">],</span>
<span class="linenos"> 475</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 476</span>
<span class="linenos"> 477</span><span class="c1">// Addis Abeba - Etiopia 2009</span>
<span class="linenos"> 478</span><span class="kd">var</span> <span class="nx">ft48</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1AujUNqTt7yZBzlkHZmk0JCZyRxShE6HnO_4pJdDu&quot;</span><span class="p">);</span>
<span class="linenos"> 479</span><span class="nx">ft48</span> <span class="o">=</span> <span class="nx">ft48</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">],</span>
<span class="linenos"> 480</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 481</span>
<span class="linenos"> 482</span><span class="c1">// Nairobi - Kenya 2009</span>
<span class="linenos"> 483</span><span class="kd">var</span> <span class="nx">ft49</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1VTTiG4F3uiKhbMKbdjCe41So2Hgk5c7OKls9P4hZ&quot;</span><span class="p">);</span>
<span class="linenos"> 484</span><span class="nx">ft49</span> <span class="o">=</span> <span class="nx">ft49</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span>
<span class="linenos"> 485</span>                <span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">,</span><span class="mf">140</span><span class="p">,</span><span class="mf">141</span><span class="p">],</span>
<span class="linenos"> 486</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 487</span>
<span class="linenos"> 488</span><span class="c1">// Luanda - Angola 2009</span>
<span class="linenos"> 489</span><span class="kd">var</span> <span class="nx">ft50</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1wAFG1OyRRugDsBcIiGl6e3m1k60Syggf9PbQjvwC&quot;</span><span class="p">);</span>
<span class="linenos"> 490</span><span class="nx">ft50</span> <span class="o">=</span> <span class="nx">ft50</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 491</span>
<span class="linenos"> 492</span><span class="c1">// Antanananarivo - Madagascar 2009</span>
<span class="linenos"> 493</span><span class="kd">var</span> <span class="nx">ft51</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1BUB0WKrrgj8oEa4Ct6PXynxlV86JemV55f1-2Mgm&quot;</span><span class="p">);</span>
<span class="linenos"> 494</span><span class="nx">ft51</span> <span class="o">=</span> <span class="nx">ft51</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,],</span>
<span class="linenos"> 495</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 496</span>
<span class="linenos"> 497</span><span class="c1">// Casablanca - Marocco 2009</span>
<span class="linenos"> 498</span><span class="kd">var</span> <span class="nx">ft52</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1w1xp3taWI5lXmrN96PkVvNgU8p8nPSx_MnJS26ey&quot;</span><span class="p">);</span>
<span class="linenos"> 499</span><span class="nx">ft52</span> <span class="o">=</span> <span class="nx">ft52</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span>
<span class="linenos"> 500</span>                <span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">],</span>
<span class="linenos"> 501</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 502</span>
<span class="linenos"> 503</span><span class="c1">// Tamanrasset - Algeria 2009</span>
<span class="linenos"> 504</span><span class="kd">var</span> <span class="nx">ft53</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1F5i8QzejxFjH3o4xmiKD1b5CF9EhtYLzgEYFL5-R&quot;</span><span class="p">);</span>
<span class="linenos"> 505</span><span class="nx">ft53</span> <span class="o">=</span> <span class="nx">ft53</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">],</span>
<span class="linenos"> 506</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 507</span>
<span class="linenos"> 508</span><span class="c1">// Hurgada - Egypt  2009</span>
<span class="linenos"> 509</span><span class="kd">var</span> <span class="nx">ft54</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1RwW2jFBdUEtxlFWQRIM0R1jneXHlXYRlS_k0dCSu&quot;</span><span class="p">);</span>
<span class="linenos"> 510</span><span class="nx">ft54</span> <span class="o">=</span> <span class="nx">ft54</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">],</span>
<span class="linenos"> 511</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 512</span>
<span class="linenos"> 513</span><span class="c1">// Sirte - Lybia  2009</span>
<span class="linenos"> 514</span><span class="kd">var</span> <span class="nx">ft55</span><span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1H8wOhLPCIWYXayXjcwcQu8PDv3m-_tQd-ZN4L6M1&quot;</span><span class="p">);</span>
<span class="linenos"> 515</span><span class="nx">ft55</span> <span class="o">=</span> <span class="nx">ft55</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">],</span>
<span class="linenos"> 516</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 517</span>
<span class="linenos"> 518</span><span class="c1">// Cercle de Dire - Mali  2009</span>
<span class="linenos"> 519</span><span class="kd">var</span> <span class="nx">ft56</span><span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1bkRPcvqxJoEQupltGhx1XSH0sKsivXIH_152-EFF&quot;</span><span class="p">);</span>
<span class="linenos"> 520</span><span class="nx">ft56</span> <span class="o">=</span> <span class="nx">ft56</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">],</span>
<span class="linenos"> 521</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 522</span>
<span class="linenos"> 523</span><span class="c1">// Maputo - Mozambico  2009</span>
<span class="linenos"> 524</span><span class="kd">var</span> <span class="nx">ft57</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1U6j_VE9vGNk6C4tg1wrEV2Hh7KNIB4EjBUIjmJti&quot;</span><span class="p">);</span>
<span class="linenos"> 525</span><span class="nx">ft57</span> <span class="o">=</span> <span class="nx">ft57</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span>
<span class="linenos"> 526</span>                <span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">],</span>
<span class="linenos"> 527</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 528</span>
<span class="linenos"> 529</span><span class="c1">// Harare - Zimbawe  2009</span>
<span class="linenos"> 530</span><span class="kd">var</span> <span class="nx">ft58</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1x4nBwW3-Hn-PVexdWk3nPN49aH8Usd8l0ljJRsa0&quot;</span><span class="p">);</span>
<span class="linenos"> 531</span><span class="nx">ft58</span> <span class="o">=</span> <span class="nx">ft58</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span>
<span class="linenos"> 532</span>                <span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">,</span><span class="mf">140</span><span class="p">,</span><span class="mf">141</span><span class="p">,</span><span class="mf">142</span><span class="p">,</span><span class="mf">143</span><span class="p">,</span><span class="mf">144</span><span class="p">],</span>
<span class="linenos"> 533</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 534</span>
<span class="linenos"> 535</span>
<span class="linenos"> 536</span><span class="c1">// Johannesburg - South Africa  2009</span>
<span class="linenos"> 537</span><span class="kd">var</span> <span class="nx">ft59</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1Ye-K6RsCf4ixpUgwQ4r1OSuPFQ0xjB6CVniZ0NIA&quot;</span><span class="p">);</span>
<span class="linenos"> 538</span><span class="nx">ft59</span> <span class="o">=</span> <span class="nx">ft59</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span>
<span class="linenos"> 539</span>                <span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">,</span><span class="mf">140</span><span class="p">,</span><span class="mf">141</span><span class="p">],</span>
<span class="linenos"> 540</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 541</span>
<span class="linenos"> 542</span>
<span class="linenos"> 543</span><span class="c1">// Durban - South Africa  2009</span>
<span class="linenos"> 544</span><span class="kd">var</span> <span class="nx">ft60</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1fSLrnYRnBmMkZxdrSnIeQr9_TdbKifI-7HPrDk9u&quot;</span><span class="p">);</span>
<span class="linenos"> 545</span><span class="nx">ft60</span> <span class="o">=</span> <span class="nx">ft60</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span>
<span class="linenos"> 546</span>                <span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">],</span>
<span class="linenos"> 547</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 548</span>
<span class="linenos"> 549</span><span class="c1">// Cape Town - South Africa  2009</span>
<span class="linenos"> 550</span><span class="kd">var</span> <span class="nx">ft61</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1om0_icjG1Wz90_ACpOUU4E50IHZgU9-57HH_dNAS&quot;</span><span class="p">);</span>
<span class="linenos"> 551</span><span class="nx">ft61</span> <span class="o">=</span> <span class="nx">ft61</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span>
<span class="linenos"> 552</span>                <span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">],</span>
<span class="linenos"> 553</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 554</span>
<span class="linenos"> 555</span><span class="c1">// Tranining set Andres</span>
<span class="linenos"> 556</span><span class="kd">var</span> <span class="nx">ftA4</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1YZfa286rC-MiQLdGGanFfvoOFcaACq79D_guqeB2&quot;</span><span class="p">);</span>
<span class="linenos"> 557</span><span class="nx">ftA4</span> <span class="o">=</span> <span class="nx">ftA4</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">106</span><span class="p">,</span><span class="mf">107</span><span class="p">,</span><span class="mf">108</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">113</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">116</span><span class="p">,</span><span class="mf">117</span><span class="p">,</span><span class="mf">118</span><span class="p">,</span><span class="mf">119</span><span class="p">,</span><span class="mf">120</span><span class="p">,</span>
<span class="linenos"> 558</span>            <span class="mf">121</span><span class="p">,</span><span class="mf">122</span><span class="p">,</span><span class="mf">123</span><span class="p">,</span><span class="mf">124</span><span class="p">,</span><span class="mf">125</span><span class="p">,</span><span class="mf">126</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">134</span><span class="p">,</span><span class="mf">135</span><span class="p">,</span><span class="mf">136</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">139</span><span class="p">,</span><span class="mf">140</span><span class="p">,</span><span class="mf">141</span><span class="p">,</span><span class="mf">142</span><span class="p">],</span>
<span class="linenos"> 559</span>            <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span>
<span class="linenos"> 560</span>            <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 561</span>
<span class="linenos"> 562</span><span class="kd">var</span> <span class="nx">ftA6</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1E_sQ9l7-uQbuEfGgCcuHlp-fWB6MQJqgFFb0KQqo&quot;</span><span class="p">);</span>
<span class="linenos"> 563</span><span class="nx">ftA6</span> <span class="o">=</span> <span class="nx">ftA6</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">102</span><span class="p">,</span><span class="mf">103</span><span class="p">,</span><span class="mf">104</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">201</span><span class="p">,</span><span class="mf">202</span><span class="p">,</span><span class="mf">300</span><span class="p">,</span><span class="mf">301</span><span class="p">,</span><span class="mf">302</span><span class="p">,</span><span class="mf">400</span><span class="p">,</span><span class="mf">401</span><span class="p">,</span><span class="mf">402</span><span class="p">],</span>
<span class="linenos"> 564</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 565</span>
<span class="linenos"> 566</span><span class="c1">// India FT66 Test punti</span>
<span class="linenos"> 567</span><span class="kd">var</span> <span class="nx">ft66</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;ft:1w65fJ11u4BeJuX0xQDsWCloB5Y1_ZF-h2Cc0qciz&quot;</span><span class="p">);</span>
<span class="linenos"> 568</span><span class="nx">ft66</span> <span class="o">=</span> <span class="nx">ft66</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">100</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">300</span><span class="p">,</span><span class="mf">400</span><span class="p">,</span><span class="mf">500</span><span class="p">,</span><span class="mf">600</span><span class="p">,</span><span class="mf">700</span><span class="p">,</span><span class="mf">800</span><span class="p">,</span><span class="mf">900</span><span class="p">,</span><span class="mf">1000</span><span class="p">,</span><span class="mf">1100</span><span class="p">,</span><span class="mf">1200</span><span class="p">],</span>
<span class="linenos"> 569</span>                <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span> <span class="s2">&quot;Number&quot;</span><span class="p">);</span>
<span class="linenos"> 570</span>
<span class="linenos"> 571</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 572</span><span class="c1">//             General Functions          //</span>
<span class="linenos"> 573</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 574</span>
<span class="linenos"> 575</span><span class="c1">// autocenter map</span>
<span class="linenos"> 576</span><span class="kd">function</span> <span class="nx">autoCenterMap</span><span class="p">(</span><span class="nx">polygon</span><span class="p">,</span> <span class="nx">zoom</span><span class="p">)</span>
<span class="linenos"> 577</span><span class="p">{</span>
<span class="linenos"> 578</span><span class="kd">var</span> <span class="nx">centroid</span> <span class="o">=</span> <span class="nx">polygon</span><span class="p">.</span><span class="nx">centroid</span><span class="p">().</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">coordinates</span><span class="p">;</span>
<span class="linenos"> 579</span>
<span class="linenos"> 580</span><span class="nx">Map</span><span class="p">.</span><span class="nx">setCenter</span><span class="p">(</span><span class="nx">centroid</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="nx">centroid</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="nx">zoom</span><span class="p">);</span>
<span class="linenos"> 581</span><span class="p">}</span>
<span class="linenos"> 582</span>
<span class="linenos"> 583</span><span class="c1">// create a quad polygon from lat and lon</span>
<span class="linenos"> 584</span><span class="kd">function</span> <span class="nx">getPoly</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span> <span class="nx">lat</span><span class="p">)</span>
<span class="linenos"> 585</span><span class="p">{</span>
<span class="linenos"> 586</span><span class="kd">var</span> <span class="nx">poly</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">.</span><span class="nx">Polygon</span><span class="p">([[</span><span class="nx">lng</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="nx">lat</span><span class="o">-</span><span class="mf">1</span><span class="p">],</span>
<span class="linenos"> 587</span>                                <span class="p">[</span><span class="nx">lng</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="nx">lat</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span>
<span class="linenos"> 588</span>                                <span class="p">[</span><span class="nx">lng</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="nx">lat</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span>
<span class="linenos"> 589</span>                                <span class="p">[</span><span class="nx">lng</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="nx">lat</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="p">]);</span>
<span class="linenos"> 590</span><span class="k">return</span> <span class="nx">poly</span><span class="p">;</span>
<span class="linenos"> 591</span><span class="p">}</span>
<span class="linenos"> 592</span>
<span class="linenos"> 593</span>
<span class="linenos"> 594</span><span class="c1">// Return an image in flag is 0 or the median of a collection if flag is 1</span>
<span class="linenos"> 595</span><span class="kd">function</span> <span class="nx">img_or_collection</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">flag</span><span class="p">)</span>
<span class="linenos"> 596</span><span class="p">{</span>
<span class="linenos"> 597</span><span class="k">if</span><span class="p">(</span><span class="nx">flag</span><span class="o">===</span><span class="mf">0</span><span class="p">)</span>
<span class="linenos"> 598</span>    <span class="k">return</span> <span class="nx">input</span><span class="p">;</span>
<span class="linenos"> 599</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">flag</span><span class="o">===</span><span class="mf">1</span><span class="p">)</span>
<span class="linenos"> 600</span>    <span class="k">return</span> <span class="nx">input</span><span class="p">.</span><span class="nx">median</span><span class="p">();</span>
<span class="linenos"> 601</span><span class="p">}</span>
<span class="linenos"> 602</span>
<span class="linenos"> 603</span>
<span class="linenos"> 604</span><span class="c1">// Return an image in flag is 0 or the median of a collection if flag is 1</span>
<span class="linenos"> 605</span><span class="kd">function</span> <span class="nx">input_selector</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">collection_type</span><span class="p">,</span> <span class="nx">sensor</span><span class="p">,</span> <span class="nx">cloud_cover</span><span class="p">,</span> <span class="nx">polygon</span><span class="p">)</span>
<span class="linenos"> 606</span><span class="p">{</span>
<span class="linenos"> 607</span>
<span class="linenos"> 608</span><span class="kd">var</span> <span class="nx">collection</span><span class="p">,</span> <span class="nx">collection1</span><span class="p">,</span> <span class="nx">collection2</span><span class="p">,</span> <span class="nx">collection3</span><span class="p">;</span>
<span class="linenos"> 609</span><span class="kd">var</span> <span class="nx">coll</span><span class="p">;</span>
<span class="linenos"> 610</span>
<span class="linenos"> 611</span><span class="k">if</span><span class="p">(</span><span class="nx">collection_type</span> <span class="o">===</span> <span class="s2">&quot;greenest&quot;</span><span class="p">)</span>
<span class="linenos"> 612</span><span class="p">{</span>
<span class="linenos"> 613</span>    <span class="nx">coll</span> <span class="o">=</span> <span class="p">(</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L5&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;LT5_L1T_ANNUAL_GREENEST_TOA/&#39;</span> <span class="o">:</span>
<span class="linenos"> 614</span>        <span class="p">((</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L7&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;LE7_L1T_ANNUAL_GREENEST_TOA/&#39;</span> <span class="o">:</span> <span class="s1">&#39;LC8_L1T_ANNUAL_GREENEST_TOA/&#39;</span><span class="p">);</span>
<span class="linenos"> 615</span>
<span class="linenos"> 616</span>    <span class="k">return</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="nx">coll</span> <span class="o">+</span> <span class="nx">year</span><span class="p">).</span><span class="nx">clip</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 617</span><span class="p">}</span>
<span class="linenos"> 618</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">collection_type</span> <span class="o">===</span> <span class="s2">&quot;standard&quot;</span><span class="p">)</span>
<span class="linenos"> 619</span><span class="p">{</span>
<span class="linenos"> 620</span>    <span class="nx">coll</span> <span class="o">=</span> <span class="p">(</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L5&#39;</span> <span class="o">||</span> <span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L45&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;LT5_L1T_TOA&#39;</span> <span class="o">:</span> <span class="p">((</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L7&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;LE7_L1T_TOA&#39;</span> <span class="o">:</span> <span class="s1">&#39;LC8_L1T_TOA&#39;</span><span class="p">);</span>
<span class="linenos"> 621</span>
<span class="linenos"> 622</span>        <span class="c1">// check for combo L4-L5</span>
<span class="linenos"> 623</span>    <span class="k">if</span><span class="p">(</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L45&#39;</span><span class="p">)</span>
<span class="linenos"> 624</span>    <span class="p">{</span>
<span class="linenos"> 625</span>        <span class="nx">collection1</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LT5_L1T_TOA&quot;</span><span class="p">).</span><span class="nx">filterDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="o">+</span><span class="s2">&quot;-01-01&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="o">+</span><span class="s2">&quot;-12-31&quot;</span><span class="p">))</span>
<span class="linenos"> 626</span>                                                    <span class="p">.</span><span class="nx">filterMetadata</span><span class="p">(</span><span class="s1">&#39;catalog_cloud_cover&#39;</span><span class="p">,</span> <span class="s1">&#39;less_than&#39;</span><span class="p">,</span> <span class="nx">cloud_cover</span><span class="p">)</span>
<span class="linenos"> 627</span>                                                    <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 628</span>
<span class="linenos"> 629</span>        <span class="nx">collection2</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LT4_L1T_TOA&quot;</span><span class="p">).</span><span class="nx">filterDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="o">+</span><span class="s2">&quot;-01-01&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="o">+</span><span class="s2">&quot;-12-31&quot;</span><span class="p">))</span>
<span class="linenos"> 630</span>                                                    <span class="p">.</span><span class="nx">filterMetadata</span><span class="p">(</span><span class="s1">&#39;catalog_cloud_cover&#39;</span><span class="p">,</span> <span class="s1">&#39;less_than&#39;</span><span class="p">,</span> <span class="nx">cloud_cover</span><span class="p">)</span>
<span class="linenos"> 631</span>                                                    <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 632</span>
<span class="linenos"> 633</span>        <span class="nx">collection</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="nx">collection1</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">collection2</span><span class="p">));</span>
<span class="linenos"> 634</span>        <span class="k">return</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">median</span><span class="p">().</span><span class="nx">clip</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 635</span>
<span class="linenos"> 636</span>    <span class="p">}</span>
<span class="linenos"> 637</span>    <span class="k">else</span>
<span class="linenos"> 638</span>    <span class="p">{</span>
<span class="linenos"> 639</span>        <span class="nx">collection</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="nx">coll</span><span class="p">).</span><span class="nx">filterDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="o">+</span><span class="s2">&quot;-01-01&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="o">+</span><span class="s2">&quot;-12-31&quot;</span><span class="p">))</span>
<span class="linenos"> 640</span>                                            <span class="p">.</span><span class="nx">filterMetadata</span><span class="p">(</span><span class="s1">&#39;catalog_cloud_cover&#39;</span><span class="p">,</span> <span class="s1">&#39;less_than&#39;</span><span class="p">,</span> <span class="nx">cloud_cover</span><span class="p">)</span>
<span class="linenos"> 641</span>                                            <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 642</span>        <span class="k">return</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">median</span><span class="p">().</span><span class="nx">clip</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 643</span>    <span class="p">}</span>
<span class="linenos"> 644</span>
<span class="linenos"> 645</span><span class="p">}</span>
<span class="linenos"> 646</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">collection_type</span> <span class="o">===</span> <span class="s2">&quot;simplecomposite&quot;</span><span class="p">)</span>
<span class="linenos"> 647</span><span class="p">{</span>
<span class="linenos"> 648</span>    <span class="nx">coll</span> <span class="o">=</span> <span class="p">(</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L5&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;LT5_L1T&#39;</span> <span class="o">:</span> <span class="p">((</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L7&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;LE7_L1T&#39;</span> <span class="o">:</span> <span class="s1">&#39;LC8_L1T&#39;</span><span class="p">);</span>
<span class="linenos"> 649</span>
<span class="linenos"> 650</span>    <span class="nx">collection</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">(</span><span class="nx">coll</span><span class="p">).</span><span class="nx">filterDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="o">+</span><span class="s2">&quot;-01-01&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="o">+</span><span class="s2">&quot;-12-31&quot;</span><span class="p">))</span>
<span class="linenos"> 651</span>                <span class="c1">//.filterMetadata(&#39;catalog_cloud_cover&#39;, &#39;less_than&#39;, cloud_cover)</span>
<span class="linenos"> 652</span>                <span class="p">.</span><span class="nx">filterBounds</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 653</span>    <span class="kd">var</span> <span class="nx">simpleComp</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Algorithms</span><span class="p">.</span><span class="nx">Landsat</span><span class="p">.</span><span class="nx">simpleComposite</span><span class="p">(</span><span class="nx">collection</span><span class="p">,</span> <span class="mf">50</span><span class="p">,</span> <span class="mf">10</span><span class="p">);</span>
<span class="linenos"> 654</span>    <span class="k">return</span> <span class="nx">simpleComp</span><span class="p">.</span><span class="nx">clip</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 655</span>
<span class="linenos"> 656</span><span class="p">}</span>
<span class="linenos"> 657</span><span class="p">}</span>
<span class="linenos"> 658</span>
<span class="linenos"> 659</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 660</span><span class="c1">//           Morphology Functions         //</span>
<span class="linenos"> 661</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 662</span>
<span class="linenos"> 663</span><span class="c1">// launch matematical morphology</span>
<span class="linenos"> 664</span><span class="kd">function</span> <span class="nx">morphology</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span> <span class="nx">operator</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">,</span> <span class="nx">iterations</span><span class="p">)</span>
<span class="linenos"> 665</span><span class="p">{</span>
<span class="linenos"> 666</span><span class="kd">var</span> <span class="nx">morph</span><span class="p">;</span>
<span class="linenos"> 667</span>
<span class="linenos"> 668</span><span class="k">if</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">bands</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">data_type</span><span class="p">.</span><span class="nx">precision</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="linenos"> 669</span><span class="p">{</span>
<span class="linenos"> 670</span>    <span class="nx">morph</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">operator</span><span class="p">,</span> <span class="nx">image</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">,</span> <span class="nx">iterations</span><span class="p">);</span>
<span class="linenos"> 671</span><span class="p">}</span>
<span class="linenos"> 672</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">bands</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">data_type</span><span class="p">.</span><span class="nx">precision</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span> <span class="o">||</span> <span class="nx">image</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">bands</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">data_type</span><span class="p">.</span><span class="nx">precision</span> <span class="o">==</span> <span class="s1">&#39;double&#39;</span><span class="p">)</span>
<span class="linenos"> 673</span><span class="p">{</span>
<span class="linenos"> 674</span>    <span class="nx">morph</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">operator</span><span class="p">,</span> <span class="nx">image</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="mf">255</span><span class="p">).</span><span class="nx">toInt</span><span class="p">(),</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">,</span> <span class="nx">iterations</span><span class="p">);</span>
<span class="linenos"> 675</span><span class="p">}</span>
<span class="linenos"> 676</span>
<span class="linenos"> 677</span><span class="k">return</span> <span class="nx">morph</span><span class="p">;</span>
<span class="linenos"> 678</span>
<span class="linenos"> 679</span><span class="p">}</span>
<span class="linenos"> 680</span>
<span class="linenos"> 681</span><span class="c1">// opening function</span>
<span class="linenos"> 682</span><span class="kd">function</span> <span class="nx">opening</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">)</span>
<span class="linenos"> 683</span><span class="p">{</span>
<span class="linenos"> 684</span><span class="kd">var</span> <span class="nx">erode</span> <span class="o">=</span> <span class="nx">morphology</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span> <span class="s1">&#39;Window.min&#39;</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
<span class="linenos"> 685</span><span class="kd">var</span> <span class="nx">open</span> <span class="o">=</span> <span class="nx">morphology</span><span class="p">(</span><span class="nx">erode</span><span class="p">,</span> <span class="s1">&#39;Window.max&#39;</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
<span class="linenos"> 686</span><span class="k">return</span> <span class="nx">open</span><span class="p">;</span>
<span class="linenos"> 687</span><span class="p">}</span>
<span class="linenos"> 688</span>
<span class="linenos"> 689</span><span class="c1">// closing function</span>
<span class="linenos"> 690</span><span class="kd">function</span> <span class="nx">closing</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">)</span>
<span class="linenos"> 691</span><span class="p">{</span>
<span class="linenos"> 692</span><span class="kd">var</span> <span class="nx">dilate</span> <span class="o">=</span> <span class="nx">morphology</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span> <span class="s1">&#39;Window.max&#39;</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
<span class="linenos"> 693</span><span class="kd">var</span> <span class="nx">closure</span> <span class="o">=</span> <span class="nx">morphology</span><span class="p">(</span><span class="nx">dilate</span><span class="p">,</span> <span class="s1">&#39;Window.min&#39;</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
<span class="linenos"> 694</span><span class="k">return</span> <span class="nx">closure</span><span class="p">;</span>
<span class="linenos"> 695</span><span class="p">}</span>
<span class="linenos"> 696</span>
<span class="linenos"> 697</span><span class="c1">// Morphology adjustment</span>
<span class="linenos"> 698</span><span class="kd">function</span> <span class="nx">morph_adjustment</span><span class="p">(</span><span class="nx">img1</span><span class="p">,</span> <span class="nx">radius1</span><span class="p">,</span> <span class="nx">radius2</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">)</span>
<span class="linenos"> 699</span><span class="p">{</span>
<span class="linenos"> 700</span><span class="c1">// Opening</span>
<span class="linenos"> 701</span><span class="kd">var</span> <span class="nx">morph</span> <span class="o">=</span> <span class="nx">closing</span><span class="p">(</span><span class="nx">img1</span><span class="p">,</span> <span class="nx">radius1</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="s2">&quot;meters&quot;</span><span class="p">);</span>
<span class="linenos"> 702</span><span class="nx">morph</span> <span class="o">=</span> <span class="nx">opening</span><span class="p">(</span><span class="nx">morph</span><span class="p">,</span> <span class="nx">radius1</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="s2">&quot;meters&quot;</span><span class="p">);</span>
<span class="linenos"> 703</span><span class="c1">//Map.addLayer(ee.Image(0).mask(morph), {palette: &#39;000000, 77ff00&#39;}, &#39;Classified + clos-op&#39;, false);</span>
<span class="linenos"> 704</span>
<span class="linenos"> 705</span><span class="c1">// And</span>
<span class="linenos"> 706</span><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">img1</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">morph</span><span class="p">);</span>
<span class="linenos"> 707</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">closing</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">radius2</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="s2">&quot;meters&quot;</span><span class="p">);</span>
<span class="linenos"> 708</span>
<span class="linenos"> 709</span><span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="linenos"> 710</span><span class="p">}</span>
<span class="linenos"> 711</span>
<span class="linenos"> 712</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 713</span><span class="c1">//               NDVI Functions           //</span>
<span class="linenos"> 714</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 715</span>
<span class="linenos"> 716</span><span class="c1">// NDVI computing</span>
<span class="linenos"> 717</span><span class="kd">function</span> <span class="nx">NDVI</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span>
<span class="linenos"> 718</span><span class="p">{</span>
<span class="linenos"> 719</span><span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span><span class="s1">&#39;((b(&quot;B4&quot;) - b(&quot;B3&quot;)) / (b(&quot;B4&quot;) + b(&quot;B3&quot;)))&#39;</span><span class="p">);</span>
<span class="linenos"> 720</span><span class="p">}</span>
<span class="linenos"> 721</span>
<span class="linenos"> 722</span>
<span class="linenos"> 723</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 724</span><span class="c1">//               NDSV Functions           //</span>
<span class="linenos"> 725</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 726</span>
<span class="linenos"> 727</span><span class="c1">// NDSV computing</span>
<span class="linenos"> 728</span><span class="kd">function</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span> <span class="nx">b1</span><span class="p">,</span> <span class="nx">b2</span><span class="p">)</span>
<span class="linenos"> 729</span><span class="p">{</span>
<span class="linenos"> 730</span><span class="c1">//print(&#39;((b(\&quot;&#39; + b2 + &#39;\&quot;) - b(\&quot;&#39; + b1 + &#39;\&quot;)) / (b(\&quot;&#39; + b2 + &#39;\&quot;) + b(\&quot;&#39;+ b1 + &#39;\&quot;))) &#39;);</span>
<span class="linenos"> 731</span><span class="k">return</span> <span class="nx">image</span><span class="p">.</span><span class="nx">expression</span><span class="p">(</span>
<span class="linenos"> 732</span>    <span class="s1">&#39;((b(\&quot;&#39;</span> <span class="o">+</span> <span class="nx">b2</span> <span class="o">+</span> <span class="s1">&#39;\&quot;) - b(\&quot;&#39;</span> <span class="o">+</span> <span class="nx">b1</span> <span class="o">+</span> <span class="s1">&#39;\&quot;)) / (b(\&quot;&#39;</span> <span class="o">+</span> <span class="nx">b2</span> <span class="o">+</span> <span class="s1">&#39;\&quot;) + b(\&quot;&#39;</span><span class="o">+</span> <span class="nx">b1</span> <span class="o">+</span> <span class="s1">&#39;\&quot;))) &#39;</span><span class="p">);</span>
<span class="linenos"> 733</span><span class="p">}</span>
<span class="linenos"> 734</span>
<span class="linenos"> 735</span>
<span class="linenos"> 736</span><span class="c1">// Compute all the 15 bands of NDSV</span>
<span class="linenos"> 737</span><span class="kd">function</span> <span class="nx">create_ndsv_img_15</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span>
<span class="linenos"> 738</span><span class="p">{</span>
<span class="linenos"> 739</span><span class="nx">image</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="kr">float</span><span class="p">();</span>
<span class="linenos"> 740</span>
<span class="linenos"> 741</span><span class="c1">//print(&quot;NDSV for L5 or L7&quot;);</span>
<span class="linenos"> 742</span>
<span class="linenos"> 743</span><span class="kd">var</span> <span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">);</span>
<span class="linenos"> 744</span><span class="kd">var</span> <span class="nx">band_1_3_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">);</span>
<span class="linenos"> 745</span><span class="kd">var</span> <span class="nx">band_1_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">);</span>
<span class="linenos"> 746</span><span class="kd">var</span> <span class="nx">band_1_5_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">);</span>
<span class="linenos"> 747</span><span class="kd">var</span> <span class="nx">band_1_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 748</span>
<span class="linenos"> 749</span><span class="kd">var</span> <span class="nx">band_2_3_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">);</span>
<span class="linenos"> 750</span><span class="kd">var</span> <span class="nx">band_2_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">);</span>
<span class="linenos"> 751</span><span class="kd">var</span> <span class="nx">band_2_5_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">);</span>
<span class="linenos"> 752</span><span class="kd">var</span> <span class="nx">band_2_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 753</span>
<span class="linenos"> 754</span><span class="kd">var</span> <span class="nx">band_3_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">);</span>
<span class="linenos"> 755</span><span class="kd">var</span> <span class="nx">band_3_5_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">);</span>
<span class="linenos"> 756</span><span class="kd">var</span> <span class="nx">band_3_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 757</span>
<span class="linenos"> 758</span><span class="kd">var</span> <span class="nx">band_4_5_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">);</span>
<span class="linenos"> 759</span><span class="kd">var</span> <span class="nx">band_4_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 760</span><span class="kd">var</span> <span class="nx">band_5_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 761</span>
<span class="linenos"> 762</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_3_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 763</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 764</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_5_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 765</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 766</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_3_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 767</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 768</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_5_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 769</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 770</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_3_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 771</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_3_5_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 772</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_3_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 773</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_4_5_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 774</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_4_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 775</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_5_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 776</span>
<span class="linenos"> 777</span><span class="kd">var</span> <span class="nx">bandnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ndsv_1_2&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_3&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_4&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_5&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_7&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_3&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_4&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_5&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_7&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_3_4&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_3_5&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_3_7&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_4_5&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_4_7&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_5_7&quot;</span><span class="p">];</span>
<span class="linenos"> 778</span><span class="kd">var</span> <span class="nx">ndsv</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">select</span><span class="p">([</span><span class="s1">&#39;.*&#39;</span><span class="p">],</span> <span class="nx">bandnames</span><span class="p">);</span>
<span class="linenos"> 779</span>
<span class="linenos"> 780</span><span class="k">return</span> <span class="nx">ndsv</span><span class="p">;</span>
<span class="linenos"> 781</span>
<span class="linenos"> 782</span><span class="p">}</span>
<span class="linenos"> 783</span>
<span class="linenos"> 784</span><span class="c1">// Compute all the 15 bands of NDSV for Landsat8</span>
<span class="linenos"> 785</span><span class="kd">function</span> <span class="nx">create_ndsv_img_15_L8</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span>
<span class="linenos"> 786</span><span class="p">{</span>
<span class="linenos"> 787</span><span class="nx">image</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="kr">float</span><span class="p">();</span>
<span class="linenos"> 788</span><span class="c1">//print(&quot;NDSV for L8&quot;);</span>
<span class="linenos"> 789</span><span class="kd">var</span> <span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">);</span>
<span class="linenos"> 790</span><span class="kd">var</span> <span class="nx">band_1_3_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">);</span>
<span class="linenos"> 791</span><span class="kd">var</span> <span class="nx">band_1_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">);</span>
<span class="linenos"> 792</span><span class="kd">var</span> <span class="nx">band_1_5_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B6&#39;</span><span class="p">);</span>
<span class="linenos"> 793</span><span class="kd">var</span> <span class="nx">band_1_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 794</span>
<span class="linenos"> 795</span><span class="kd">var</span> <span class="nx">band_2_3_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">);</span>
<span class="linenos"> 796</span><span class="kd">var</span> <span class="nx">band_2_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">);</span>
<span class="linenos"> 797</span><span class="kd">var</span> <span class="nx">band_2_5_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B6&#39;</span><span class="p">);</span>
<span class="linenos"> 798</span><span class="kd">var</span> <span class="nx">band_2_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 799</span>
<span class="linenos"> 800</span><span class="kd">var</span> <span class="nx">band_3_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">);</span>
<span class="linenos"> 801</span><span class="kd">var</span> <span class="nx">band_3_5_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;B6&#39;</span><span class="p">);</span>
<span class="linenos"> 802</span><span class="kd">var</span> <span class="nx">band_3_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 803</span>
<span class="linenos"> 804</span><span class="kd">var</span> <span class="nx">band_4_5_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B6&#39;</span><span class="p">);</span>
<span class="linenos"> 805</span><span class="kd">var</span> <span class="nx">band_4_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 806</span>
<span class="linenos"> 807</span><span class="kd">var</span> <span class="nx">band_5_7_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">);</span>
<span class="linenos"> 808</span>
<span class="linenos"> 809</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_3_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 810</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 811</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_5_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 812</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 813</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_3_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 814</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 815</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_5_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 816</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 817</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_3_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 818</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_3_5_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 819</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_3_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 820</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_4_5_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 821</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_4_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 822</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_5_7_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 823</span>
<span class="linenos"> 824</span><span class="kd">var</span> <span class="nx">bandnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ndsv_1_2&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_3&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_4&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_5&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_7&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_3&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_4&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_5&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_7&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_3_4&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_3_5&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_3_7&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_4_5&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_4_7&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_5_7&quot;</span><span class="p">];</span>
<span class="linenos"> 825</span><span class="kd">var</span> <span class="nx">ndsv</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">select</span><span class="p">([</span><span class="s1">&#39;.*&#39;</span><span class="p">],</span> <span class="nx">bandnames</span><span class="p">);</span>
<span class="linenos"> 826</span>
<span class="linenos"> 827</span><span class="k">return</span> <span class="nx">ndsv</span><span class="p">;</span>
<span class="linenos"> 828</span>
<span class="linenos"> 829</span><span class="p">}</span>
<span class="linenos"> 830</span>
<span class="linenos"> 831</span><span class="c1">// Compute all the 6 bands of NDSV</span>
<span class="linenos"> 832</span><span class="kd">function</span> <span class="nx">create_ndsv_img_6</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span>
<span class="linenos"> 833</span><span class="p">{</span>
<span class="linenos"> 834</span><span class="nx">image</span> <span class="o">=</span> <span class="nx">image</span><span class="p">.</span><span class="kr">float</span><span class="p">();</span>
<span class="linenos"> 835</span><span class="kd">var</span> <span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos"> 836</span><span class="kd">var</span> <span class="nx">band_1_3_image</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos"> 837</span><span class="kd">var</span> <span class="nx">band_1_4_image</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos"> 838</span>
<span class="linenos"> 839</span><span class="kd">var</span> <span class="nx">band_2_3_image</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos"> 840</span><span class="kd">var</span> <span class="nx">band_2_4_image</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos"> 841</span>
<span class="linenos"> 842</span><span class="kd">var</span> <span class="nx">band_3_4_image</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos"> 843</span>
<span class="linenos"> 844</span><span class="k">if</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">bands</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">id</span> <span class="o">==</span> <span class="mf">1</span><span class="p">)</span>
<span class="linenos"> 845</span><span class="p">{</span>
<span class="linenos"> 846</span>    <span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">);</span>
<span class="linenos"> 847</span>    <span class="nx">band_1_3_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">);</span>
<span class="linenos"> 848</span>    <span class="nx">band_1_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">);</span>
<span class="linenos"> 849</span>
<span class="linenos"> 850</span>    <span class="nx">band_2_3_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">);</span>
<span class="linenos"> 851</span>    <span class="nx">band_2_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">);</span>
<span class="linenos"> 852</span>
<span class="linenos"> 853</span>    <span class="nx">band_3_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">);</span>
<span class="linenos"> 854</span><span class="p">}</span>
<span class="linenos"> 855</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">bands</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">id</span> <span class="o">==</span> <span class="mf">4</span><span class="p">){</span>
<span class="linenos"> 856</span>
<span class="linenos"> 857</span>    <span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">);</span>
<span class="linenos"> 858</span>    <span class="nx">band_1_3_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">);</span>
<span class="linenos"> 859</span>    <span class="nx">band_1_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">);</span>
<span class="linenos"> 860</span>
<span class="linenos"> 861</span>    <span class="nx">band_2_3_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">);</span>
<span class="linenos"> 862</span>    <span class="nx">band_2_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">);</span>
<span class="linenos"> 863</span>
<span class="linenos"> 864</span>    <span class="nx">band_3_4_image</span> <span class="o">=</span> <span class="nx">NDSV</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">);</span>
<span class="linenos"> 865</span>
<span class="linenos"> 866</span><span class="p">}</span>
<span class="linenos"> 867</span>
<span class="linenos"> 868</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_3_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 869</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_1_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 870</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_3_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 871</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_2_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 872</span><span class="nx">band_1_2_image</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">addBands</span><span class="p">(</span><span class="nx">band_3_4_image</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos"> 873</span>
<span class="linenos"> 874</span><span class="kd">var</span> <span class="nx">bandnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ndsv_1_2&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_3&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_1_4&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_3&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_2_4&quot;</span><span class="p">,</span> <span class="s2">&quot;ndsv_3_4&quot;</span><span class="p">];</span>
<span class="linenos"> 875</span><span class="kd">var</span> <span class="nx">ndsv</span> <span class="o">=</span> <span class="nx">band_1_2_image</span><span class="p">.</span><span class="nx">select</span><span class="p">([</span><span class="s1">&#39;.*&#39;</span><span class="p">],</span> <span class="nx">bandnames</span><span class="p">);</span>
<span class="linenos"> 876</span>
<span class="linenos"> 877</span><span class="k">return</span> <span class="nx">ndsv</span><span class="p">;</span>
<span class="linenos"> 878</span>
<span class="linenos"> 879</span><span class="p">}</span>
<span class="linenos"> 880</span>
<span class="linenos"> 881</span><span class="c1">// Compute all the bands of NDSV depending on the image</span>
<span class="linenos"> 882</span><span class="kd">function</span> <span class="nx">create_ndsv_img</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span>
<span class="linenos"> 883</span><span class="p">{</span>
<span class="linenos"> 884</span><span class="k">if</span><span class="p">(</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L8&#39;</span><span class="p">)</span>
<span class="linenos"> 885</span>    <span class="k">return</span> <span class="nx">create_ndsv_img_15_L8</span><span class="p">(</span><span class="nx">image</span><span class="p">);</span>
<span class="linenos"> 886</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L7&#39;</span> <span class="o">||</span> <span class="nx">sensor</span><span class="o">===</span><span class="s1">&#39;L5&#39;</span> <span class="o">||</span> <span class="nx">sensor</span> <span class="o">===</span> <span class="s1">&#39;L45&#39;</span><span class="p">)</span>
<span class="linenos"> 887</span>    <span class="k">return</span> <span class="nx">create_ndsv_img_15</span><span class="p">(</span><span class="nx">image</span><span class="p">);</span>
<span class="linenos"> 888</span><span class="k">else</span>
<span class="linenos"> 889</span>    <span class="k">return</span> <span class="nx">create_ndsv_img_6</span><span class="p">(</span><span class="nx">image</span><span class="p">);</span>
<span class="linenos"> 890</span>
<span class="linenos"> 891</span><span class="p">}</span>
<span class="linenos"> 892</span>
<span class="linenos"> 893</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 894</span><span class="c1">//               Classifier               //</span>
<span class="linenos"> 895</span><span class="c1">// ====================================== //</span>
<span class="linenos"> 896</span>
<span class="linenos"> 897</span><span class="c1">// generate training set of random points (Universe of cities)</span>
<span class="linenos"> 898</span><span class="kd">function</span> <span class="nx">ts_generator</span><span class="p">(</span><span class="nx">poly</span><span class="p">,</span> <span class="nx">numPoints</span><span class="p">,</span> <span class="nx">selectedCities</span><span class="p">,</span><span class="nx">seed</span><span class="p">)</span>
<span class="linenos"> 899</span><span class="p">{</span>
<span class="linenos"> 900</span><span class="nx">seed</span> <span class="o">=</span> <span class="p">(</span><span class="nx">seed</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="o">?</span> <span class="mf">0</span> <span class="o">:</span> <span class="nx">seed</span><span class="p">;</span>
<span class="linenos"> 901</span><span class="kd">var</span> <span class="nx">random_points</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">.</span><span class="nx">randomPoints</span><span class="p">(</span><span class="nx">poly</span><span class="p">,</span> <span class="nx">numPoints</span><span class="p">,</span> <span class="nx">seed</span><span class="p">);</span>
<span class="linenos"> 902</span>
<span class="linenos"> 903</span><span class="kd">var</span> <span class="nx">geom</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span><span class="nx">selectedCities</span><span class="p">.</span><span class="nx">geometry</span><span class="p">());</span>
<span class="linenos"> 904</span>
<span class="linenos"> 905</span><span class="kd">var</span> <span class="nx">training_set</span> <span class="o">=</span> <span class="nx">random_points</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos"> 906</span>    <span class="k">return</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Number&quot;</span><span class="p">,</span>
<span class="linenos"> 907</span>        <span class="nx">ee</span><span class="p">.</span><span class="nx">Algorithms</span><span class="p">.</span><span class="nx">If</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">containedIn</span><span class="p">(</span><span class="nx">geom</span><span class="p">),</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">));</span>
<span class="linenos"> 908</span><span class="p">});</span>
<span class="linenos"> 909</span>
<span class="linenos"> 910</span><span class="kd">var</span> <span class="nx">numPoints_NotUrban</span> <span class="o">=</span> <span class="nx">training_set</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;Number&quot;</span><span class="p">,</span> <span class="mf">0</span><span class="p">)).</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="linenos"> 911</span><span class="c1">//print(&quot;not urban: &quot; + numPoints_NotUrban);</span>
<span class="linenos"> 912</span><span class="kd">var</span> <span class="nx">numPoints_Urban</span> <span class="o">=</span> <span class="nx">training_set</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&quot;Number&quot;</span><span class="p">,</span> <span class="mf">1</span><span class="p">)).</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="linenos"> 913</span><span class="c1">//print(&quot;urban: &quot; + numPoints_Urban);</span>
<span class="linenos"> 914</span><span class="kd">var</span> <span class="nx">numPoits_toAdd</span> <span class="o">=</span> <span class="p">(</span><span class="nx">numPoints_NotUrban</span><span class="o">-</span><span class="nx">numPoints_Urban</span><span class="p">)</span><span class="o">/</span><span class="mf">2</span><span class="p">;</span>
<span class="linenos"> 915</span><span class="nx">random_points</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">.</span><span class="nx">randomPoints</span><span class="p">(</span><span class="nx">selectedCities</span><span class="p">,</span> <span class="nx">numPoits_toAdd</span><span class="p">);</span>
<span class="linenos"> 916</span><span class="kd">var</span> <span class="nx">urban_points</span> <span class="o">=</span> <span class="nx">random_points</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos"> 917</span>        <span class="k">return</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Number&quot;</span><span class="p">,</span><span class="mf">1</span><span class="p">);</span>
<span class="linenos"> 918</span><span class="p">});</span>
<span class="linenos"> 919</span>
<span class="linenos"> 920</span><span class="nx">training_set</span> <span class="o">=</span> <span class="nx">training_set</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">urban_points</span><span class="p">);</span>
<span class="linenos"> 921</span>
<span class="linenos"> 922</span><span class="k">return</span> <span class="nx">training_set</span><span class="p">;</span>
<span class="linenos"> 923</span>
<span class="linenos"> 924</span><span class="p">}</span>
<span class="linenos"> 925</span>
<span class="linenos"> 926</span>
<span class="linenos"> 927</span><span class="c1">// return random point inside a polygon</span>
<span class="linenos"> 928</span><span class="kd">function</span> <span class="nx">getPoints</span><span class="p">(</span><span class="nx">polygon</span><span class="p">,</span> <span class="nx">num</span><span class="p">)</span>
<span class="linenos"> 929</span><span class="p">{</span>
<span class="linenos"> 930</span>
<span class="linenos"> 931</span><span class="kd">var</span> <span class="nx">random_points</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">.</span><span class="nx">randomPoints</span><span class="p">(</span><span class="nx">polygon</span><span class="p">,</span> <span class="nx">num</span><span class="p">);</span>
<span class="linenos"> 932</span>
<span class="linenos"> 933</span><span class="kd">var</span> <span class="nx">input_train_img</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s1">&#39;ESA/GLOBCOVER_L4_200901_200912_V2_3&#39;</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">);</span>
<span class="linenos"> 934</span>
<span class="linenos"> 935</span><span class="kd">var</span> <span class="nx">blank</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
<span class="linenos"> 936</span><span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">blank</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">input_train_img</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
<span class="linenos"> 937</span><span class="kd">var</span> <span class="nx">mask_img</span> <span class="o">=</span> <span class="nx">output</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">input_train_img</span><span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="mf">190</span><span class="p">).</span><span class="nx">or</span><span class="p">(</span><span class="nx">input_train_img</span><span class="p">.</span><span class="nx">gt</span><span class="p">(</span><span class="mf">190</span><span class="p">)),</span><span class="mf">0</span><span class="p">);</span>
<span class="linenos"> 938</span>
<span class="linenos"> 939</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">mask_img</span><span class="p">.</span><span class="nx">clip</span><span class="p">(</span><span class="nx">polygon</span><span class="p">);</span>
<span class="linenos"> 940</span>
<span class="linenos"> 941</span><span class="kd">var</span> <span class="nx">x_erode</span>  <span class="o">=</span> <span class="nx">morphology</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="s1">&#39;Window.min&#39;</span><span class="p">,</span> <span class="nx">radius1</span><span class="p">,</span> <span class="nx">kernelType1</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
<span class="linenos"> 942</span><span class="kd">var</span> <span class="nx">x_dilate</span> <span class="o">=</span> <span class="nx">morphology</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="s1">&#39;Window.max&#39;</span><span class="p">,</span> <span class="nx">radius1</span><span class="p">,</span> <span class="nx">kernelType1</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="mf">1</span><span class="p">);</span>
<span class="linenos"> 943</span>
<span class="linenos"> 944</span><span class="kd">var</span> <span class="nx">morph</span> <span class="o">=</span> <span class="nx">x_erode</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">x_dilate</span><span class="p">);</span>
<span class="linenos"> 945</span><span class="c1">//Map.addLayer(morph, null, &#39;Input data morph&#39;);</span>
<span class="linenos"> 946</span>
<span class="linenos"> 947</span><span class="kd">var</span> <span class="nx">trainingImage_</span> <span class="o">=</span>  <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">cat</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">0</span><span class="p">),</span> <span class="nx">morph</span><span class="p">);</span>
<span class="linenos"> 948</span>
<span class="linenos"> 949</span><span class="kd">var</span> <span class="nx">trainingPoints</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="s2">&quot;ReduceToVectors&quot;</span><span class="p">,{</span>
<span class="linenos"> 950</span>    <span class="nx">image</span><span class="o">:</span> <span class="nx">trainingImage_</span><span class="p">,</span>
<span class="linenos"> 951</span>    <span class="nx">reducer</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">mean</span><span class="p">(),</span>  <span class="c1">// The particular reducer doesn&#39;t matter, since it is a point geometry.</span>
<span class="linenos"> 952</span>    <span class="nx">geometry</span><span class="o">:</span> <span class="nx">random_points</span><span class="p">,</span>
<span class="linenos"> 953</span>    <span class="nx">scale</span><span class="o">:</span> <span class="mf">30</span><span class="p">,</span>                   <span class="c1">// Scale at which the image is sampled.</span>
<span class="linenos"> 954</span>    <span class="nx">geometryType</span><span class="o">:</span> <span class="s1">&#39;centroid&#39;</span>     <span class="c1">// The output will be a point.</span>
<span class="linenos"> 955</span><span class="p">});</span>
<span class="linenos"> 956</span>
<span class="linenos"> 957</span><span class="nx">trainingPoints</span> <span class="o">=</span> <span class="nx">trainingPoints</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">neq</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="mf">1</span><span class="p">));</span>
<span class="linenos"> 958</span><span class="nx">trainingPoints</span> <span class="o">=</span> <span class="nx">trainingPoints</span><span class="p">.</span><span class="nx">remap</span><span class="p">([</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">],[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="s2">&quot;mean&quot;</span><span class="p">);</span>
<span class="linenos"> 959</span>
<span class="linenos"> 960</span><span class="kd">var</span> <span class="nx">renamed_points</span> <span class="o">=</span> <span class="nx">trainingPoints</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos"> 961</span>    <span class="k">return</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Number&quot;</span><span class="p">,</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">));</span>
<span class="linenos"> 962</span><span class="p">});</span>
<span class="linenos"> 963</span>
<span class="linenos"> 964</span><span class="k">return</span> <span class="nx">renamed_points</span><span class="p">;</span>
<span class="linenos"> 965</span>
<span class="linenos"> 966</span><span class="p">}</span>
<span class="linenos"> 967</span>
<span class="linenos"> 968</span><span class="c1">// select and create the fusion tables</span>
<span class="linenos"> 969</span><span class="kd">function</span> <span class="nx">training_selector</span><span class="p">(</span><span class="nx">ft_array</span><span class="p">)</span>
<span class="linenos"> 970</span><span class="p">{</span>
<span class="linenos"> 971</span><span class="kd">var</span> <span class="nx">index</span><span class="p">;</span>
<span class="linenos"> 972</span><span class="kd">var</span> <span class="nx">merge_ft</span> <span class="o">=</span> <span class="nx">ft_array</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
<span class="linenos"> 973</span><span class="k">for</span> <span class="p">(</span><span class="nx">index</span> <span class="o">=</span> <span class="mf">1</span><span class="p">;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="nx">ft_array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">index</span><span class="o">++</span><span class="p">)</span>
<span class="linenos"> 974</span><span class="p">{</span>
<span class="linenos"> 975</span>    <span class="nx">merge_ft</span> <span class="o">=</span> <span class="nx">merge_ft</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">ft_array</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span>
<span class="linenos"> 976</span><span class="p">}</span>
<span class="linenos"> 977</span>
<span class="linenos"> 978</span><span class="k">return</span> <span class="nx">merge_ft</span><span class="p">;</span>
<span class="linenos"> 979</span><span class="p">}</span>
<span class="linenos"> 980</span>
<span class="linenos"> 981</span><span class="c1">// classificiation</span>
<span class="linenos"> 982</span><span class="kd">function</span> <span class="nx">classifier</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">crs</span><span class="p">)</span>
<span class="linenos"> 983</span><span class="p">{</span>
<span class="linenos"> 984</span><span class="nx">crs</span> <span class="o">=</span> <span class="p">(</span><span class="nx">crs</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;EPSG:4326&quot;</span> <span class="o">:</span> <span class="nx">crs</span><span class="p">;</span>
<span class="linenos"> 985</span><span class="kd">var</span> <span class="nx">training</span> <span class="o">=</span> <span class="nx">img</span><span class="p">.</span><span class="nx">sampleRegions</span><span class="p">(</span> <span class="nx">ft</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Number&quot;</span><span class="p">],</span> <span class="kc">null</span><span class="p">,</span>
<span class="linenos"> 986</span>                                    <span class="nx">ee</span><span class="p">.</span><span class="nx">Projection</span><span class="p">(</span><span class="nx">crs</span><span class="p">,</span> <span class="p">[</span><span class="mf">8.9831528411952135e-05</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">180</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.9831528411952135e-05</span><span class="p">,</span> <span class="mf">90</span><span class="p">]));</span>
<span class="linenos"> 987</span><span class="kd">var</span> <span class="nx">trained</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">train</span><span class="p">(</span><span class="nx">training</span><span class="p">,</span> <span class="s2">&quot;Number&quot;</span><span class="p">,</span> <span class="nx">img</span><span class="p">.</span><span class="nx">bandNames</span><span class="p">());</span>
<span class="linenos"> 988</span>
<span class="linenos"> 989</span><span class="cm">/* OLD INSTRUCTION</span>
<span class="linenos"> 990</span><span class="cm">var y = ee.apply(&quot;ClassifyImage&quot;,{</span>
<span class="linenos"> 991</span><span class="cm">                &quot;image&quot;: img,</span>
<span class="linenos"> 992</span><span class="cm">                &quot;classifierImage&quot;: training</span>
<span class="linenos"> 993</span><span class="cm">});</span>
<span class="linenos"> 994</span><span class="cm">*/</span>
<span class="linenos"> 995</span>
<span class="linenos"> 996</span><span class="c1">// NEW INSTRUCTION</span>
<span class="linenos"> 997</span><span class="kd">var</span> <span class="nx">classified</span> <span class="o">=</span> <span class="nx">img</span><span class="p">.</span><span class="nx">classify</span><span class="p">(</span><span class="nx">trained</span><span class="p">);</span>
<span class="linenos"> 998</span>
<span class="linenos"> 999</span><span class="k">return</span> <span class="nx">classified</span><span class="p">;</span>
<span class="linenos">1000</span><span class="p">}</span>
<span class="linenos">1001</span>
<span class="linenos">1002</span><span class="c1">// Choose classification type: single classifier (multi = false) or three and median (multi = true)</span>
<span class="linenos">1003</span><span class="kd">function</span> <span class="nx">multi_classifier</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="nx">multiseed</span><span class="p">,</span> <span class="nx">multiclass</span><span class="p">,</span> <span class="nx">watermask</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span>
<span class="linenos">1004</span><span class="p">{</span>
<span class="linenos">1005</span>
<span class="linenos">1006</span><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">multiclass</span><span class="o">===</span><span class="kc">true</span> <span class="o">?</span> <span class="nx">classifier_array</span><span class="p">[</span><span class="nx">type</span><span class="p">[</span><span class="mf">0</span><span class="p">]]</span> <span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Classifier</span><span class="p">.</span><span class="nx">cart</span><span class="p">();</span>
<span class="linenos">1007</span><span class="kd">var</span> <span class="nx">water</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="s2">&quot;MOD44W/MOD44W_005_2000_02_24&quot;</span><span class="p">).</span><span class="nx">select</span><span class="p">([</span><span class="s2">&quot;water_mask&quot;</span><span class="p">]);</span>
<span class="linenos">1008</span><span class="kd">var</span> <span class="nx">classified</span><span class="p">,</span> <span class="nx">classified1</span><span class="p">,</span> <span class="nx">classified2</span><span class="p">,</span> <span class="nx">classified3</span><span class="p">;</span>
<span class="linenos">1009</span>
<span class="linenos">1010</span><span class="k">if</span><span class="p">(</span><span class="nx">multiseed</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1011</span><span class="p">{</span>
<span class="linenos">1012</span>    <span class="nx">classified1</span> <span class="o">=</span> <span class="nx">classifier</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="nx">name</span><span class="p">);</span>
<span class="linenos">1013</span>    <span class="c1">//Map.addLayer(classified1, {palette: &#39;000000, ff0000&#39;}, &#39;Classified1&#39;, false);</span>
<span class="linenos">1014</span>    <span class="nx">classified2</span> <span class="o">=</span> <span class="nx">classifier</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="nx">name</span><span class="p">);</span>
<span class="linenos">1015</span>    <span class="c1">//Map.addLayer(classified2, {palette: &#39;000000, ff00ff&#39;}, &#39;Classified2&#39;, false);</span>
<span class="linenos">1016</span>    <span class="nx">classified3</span> <span class="o">=</span> <span class="nx">classifier</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span> <span class="nx">name</span><span class="p">);</span>
<span class="linenos">1017</span>    <span class="c1">//Map.addLayer(classified3, {palette: &#39;000000, 00ff00&#39;}, &#39;Classified3&#39;, false);</span>
<span class="linenos">1018</span>    <span class="nx">classified</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">([</span><span class="nx">classified1</span><span class="p">,</span> <span class="nx">classified2</span><span class="p">,</span> <span class="nx">classified3</span><span class="p">]).</span><span class="nx">median</span><span class="p">();</span>
<span class="linenos">1019</span><span class="p">}</span>
<span class="linenos">1020</span><span class="k">else</span>
<span class="linenos">1021</span>    <span class="nx">classified</span> <span class="o">=</span> <span class="nx">classifier</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
<span class="linenos">1022</span>
<span class="linenos">1023</span><span class="k">if</span><span class="p">(</span><span class="nx">multiclass</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span> <span class="c1">// multi classifiers</span>
<span class="linenos">1024</span><span class="p">{</span>
<span class="linenos">1025</span>    <span class="kd">var</span> <span class="nx">tmp1</span><span class="p">,</span> <span class="nx">tmp2</span><span class="p">,</span> <span class="nx">tmp3</span><span class="p">;</span>
<span class="linenos">1026</span>
<span class="linenos">1027</span>    <span class="nx">tmp1</span> <span class="o">=</span> <span class="nx">classified</span><span class="p">;</span>
<span class="linenos">1028</span>    <span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">mask</span><span class="p">(</span><span class="nx">tmp1</span><span class="p">),</span> <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, ff0000&#39;</span><span class="p">},</span> <span class="nx">classifier_names</span><span class="p">[</span><span class="nx">type</span><span class="p">[</span><span class="mf">0</span><span class="p">]],</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos">1029</span>    <span class="nx">tmp2</span> <span class="o">=</span> <span class="nx">classifier</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="nx">classifier_array</span><span class="p">[</span><span class="nx">type</span><span class="p">[</span><span class="mf">1</span><span class="p">]]);</span>
<span class="linenos">1030</span>    <span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">mask</span><span class="p">(</span><span class="nx">tmp2</span><span class="p">),</span> <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, 00ff00&#39;</span><span class="p">},</span> <span class="nx">classifier_names</span><span class="p">[</span><span class="nx">type</span><span class="p">[</span><span class="mf">1</span><span class="p">]],</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos">1031</span>    <span class="nx">tmp3</span> <span class="o">=</span> <span class="nx">classifier</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="nx">classifier_array</span><span class="p">[</span><span class="nx">type</span><span class="p">[</span><span class="mf">2</span><span class="p">]]);</span>
<span class="linenos">1032</span>    <span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">mask</span><span class="p">(</span><span class="nx">tmp3</span><span class="p">),</span> <span class="p">{</span><span class="nx">palette</span><span class="o">:</span> <span class="s1">&#39;000000, ff00ff&#39;</span><span class="p">},</span> <span class="nx">classifier_names</span><span class="p">[</span><span class="nx">type</span><span class="p">[</span><span class="mf">2</span><span class="p">]],</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos">1033</span>    <span class="nx">classified</span> <span class="o">=</span>  <span class="nx">ee</span><span class="p">.</span><span class="nx">ImageCollection</span><span class="p">([</span><span class="nx">tmp1</span><span class="p">,</span> <span class="nx">tmp2</span><span class="p">,</span> <span class="nx">tmp3</span><span class="p">]).</span><span class="nx">median</span><span class="p">();</span>
<span class="linenos">1034</span>
<span class="linenos">1035</span><span class="p">}</span>
<span class="linenos">1036</span>
<span class="linenos">1037</span><span class="k">if</span><span class="p">(</span><span class="nx">watermask</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1038</span><span class="p">{</span>
<span class="linenos">1039</span>    <span class="nx">classified</span> <span class="o">=</span> <span class="nx">classified</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">water</span><span class="p">,</span><span class="mf">0</span><span class="p">);</span>
<span class="linenos">1040</span><span class="p">}</span>
<span class="linenos">1041</span>
<span class="linenos">1042</span><span class="k">return</span> <span class="nx">classified</span><span class="p">;</span>
<span class="linenos">1043</span><span class="p">}</span>
<span class="linenos">1044</span>
<span class="linenos">1045</span><span class="c1">// Mask the image with slope</span>
<span class="linenos">1046</span><span class="kd">function</span> <span class="nx">slope_mask</span><span class="p">(</span><span class="nx">imgIn</span><span class="p">,</span> <span class="nx">th</span><span class="p">)</span>
<span class="linenos">1047</span><span class="p">{</span>
<span class="linenos">1048</span><span class="kd">var</span> <span class="nx">slope</span> <span class="o">=</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Algorithms</span><span class="p">.</span><span class="nx">Terrain</span><span class="p">(</span><span class="nx">dem</span><span class="p">);</span>
<span class="linenos">1049</span><span class="k">return</span> <span class="nx">imgIn</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">slope</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;slope&quot;</span><span class="p">).</span><span class="nx">gt</span><span class="p">(</span><span class="nx">th</span><span class="p">),</span><span class="mf">0</span><span class="p">);</span>
<span class="linenos">1050</span>
<span class="linenos">1051</span><span class="p">}</span>
<span class="linenos">1052</span>
<span class="linenos">1053</span><span class="c1">// Mask the image with dem</span>
<span class="linenos">1054</span><span class="kd">function</span> <span class="nx">dem_mask</span><span class="p">(</span><span class="nx">imgIn</span><span class="p">,</span> <span class="nx">th</span><span class="p">)</span>
<span class="linenos">1055</span><span class="p">{</span>
<span class="linenos">1056</span><span class="k">if</span><span class="p">(</span><span class="nx">use_geometry</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span>
<span class="linenos">1057</span>    <span class="k">return</span> <span class="nx">imgIn</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">dem</span><span class="p">.</span><span class="nx">clip</span><span class="p">(</span><span class="nx">dem_geometry</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;elevation&quot;</span><span class="p">).</span><span class="nx">gt</span><span class="p">(</span><span class="nx">th</span><span class="p">),</span> <span class="mf">0</span><span class="p">);</span>
<span class="linenos">1058</span><span class="k">else</span>
<span class="linenos">1059</span>    <span class="k">return</span> <span class="nx">imgIn</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">dem</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;elevation&quot;</span><span class="p">).</span><span class="nx">gt</span><span class="p">(</span><span class="nx">th</span><span class="p">),</span> <span class="mf">0</span><span class="p">);</span>
<span class="linenos">1060</span><span class="p">}</span>
<span class="linenos">1061</span>
<span class="linenos">1062</span><span class="cm">/***********************************************/</span>
<span class="linenos">1063</span><span class="cm">/*      MAIN IMAGE CLASSIFICATION FUNCTION     */</span>
<span class="linenos">1064</span><span class="cm">/***********************************************/</span>
<span class="linenos">1065</span><span class="kd">function</span> <span class="nx">image_classification</span><span class="p">(</span><span class="nx">image_base</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="nx">year</span><span class="p">)</span>
<span class="linenos">1066</span><span class="p">{</span>
<span class="linenos">1067</span><span class="cm">/*** NDSV ***/</span>
<span class="linenos">1068</span><span class="kd">var</span> <span class="nx">ndsv_img</span> <span class="o">=</span> <span class="nx">create_ndsv_img</span><span class="p">(</span><span class="nx">image_base</span><span class="p">);</span>
<span class="linenos">1069</span>
<span class="linenos">1070</span><span class="c1">//launch single or multi classification</span>
<span class="linenos">1071</span><span class="kd">var</span> <span class="nx">classified1</span> <span class="o">=</span> <span class="nx">multi_classifier</span><span class="p">(</span><span class="nx">ndsv_img</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="nx">multi_random</span><span class="p">,</span> <span class="nx">multiclassifier</span><span class="p">,</span> <span class="nx">waterfilter</span><span class="p">,</span> <span class="nx">classifiers</span><span class="p">);</span>
<span class="linenos">1072</span><span class="c1">//Map.addLayer(classified1, {palette: &#39;000000, ff8800&#39;}, &#39;Classified &#39; + year, false);</span>
<span class="linenos">1073</span>
<span class="linenos">1074</span><span class="k">if</span><span class="p">(</span><span class="nx">mask_ndvi</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span>
<span class="linenos">1075</span><span class="p">{</span>
<span class="linenos">1076</span>    <span class="kd">var</span> <span class="nx">ndvi</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos">1077</span>
<span class="linenos">1078</span>    <span class="k">if</span><span class="p">(</span><span class="nx">collection_type</span> <span class="o">===</span> <span class="s2">&quot;greenest&quot;</span><span class="p">)</span>
<span class="linenos">1079</span>    <span class="nx">ndvi</span> <span class="o">=</span> <span class="nx">image_base</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;greenness&quot;</span><span class="p">);</span>
<span class="linenos">1080</span>    <span class="k">else</span>
<span class="linenos">1081</span>    <span class="nx">ndvi</span> <span class="o">=</span> <span class="nx">NDVI</span><span class="p">(</span><span class="nx">image_base</span><span class="p">);</span>
<span class="linenos">1082</span>
<span class="linenos">1083</span>    <span class="nx">classified1</span> <span class="o">=</span> <span class="nx">classified1</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">ndvi</span><span class="p">.</span><span class="nx">gt</span><span class="p">(</span><span class="nx">th_ndvi_high</span><span class="p">),</span> <span class="mf">0</span><span class="p">);</span>
<span class="linenos">1084</span>    <span class="nx">classified1</span> <span class="o">=</span> <span class="nx">classified1</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">ndvi</span><span class="p">.</span><span class="nx">lte</span><span class="p">(</span><span class="nx">th_ndvi_low</span><span class="p">),</span> <span class="mf">0</span><span class="p">);</span>
<span class="linenos">1085</span>
<span class="linenos">1086</span>    <span class="c1">//Map.addLayer(ee.Image(0).mask(classified1), {palette: &#39;000000, efef00&#39;}, &#39;NDVI Masked&#39;);</span>
<span class="linenos">1087</span>
<span class="linenos">1088</span><span class="p">}</span>
<span class="linenos">1089</span>
<span class="linenos">1090</span><span class="c1">// Slope filtering</span>
<span class="linenos">1091</span><span class="k">if</span><span class="p">(</span><span class="nx">mask_slope</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span>
<span class="linenos">1092</span><span class="p">{</span>
<span class="linenos">1093</span>    <span class="nx">classified1</span> <span class="o">=</span> <span class="nx">slope_mask</span><span class="p">(</span><span class="nx">classified1</span><span class="p">,</span> <span class="nx">th_slope</span><span class="p">);</span>
<span class="linenos">1094</span>    <span class="c1">//Map.addLayer(ee.Image(0).mask(classified1), {palette: &#39;000000, 00ef00&#39;}, &#39;Slope Masked&#39;);</span>
<span class="linenos">1095</span><span class="p">}</span>
<span class="linenos">1096</span>
<span class="linenos">1097</span><span class="c1">// Dem filtering</span>
<span class="linenos">1098</span><span class="k">if</span><span class="p">(</span><span class="nx">mask_dem</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span>
<span class="linenos">1099</span><span class="p">{</span>
<span class="linenos">1100</span>    <span class="nx">classified1</span> <span class="o">=</span> <span class="nx">dem_mask</span><span class="p">(</span><span class="nx">classified1</span><span class="p">,</span> <span class="nx">th_dem</span><span class="p">);</span>
<span class="linenos">1101</span>    <span class="c1">//Map.addLayer(ee.Image(0).mask(classified1), {palette: &#39;000000, ef00ef&#39;}, &#39;Dem Masked&#39;);</span>
<span class="linenos">1102</span><span class="p">}</span>
<span class="linenos">1103</span>
<span class="linenos">1104</span>
<span class="linenos">1105</span><span class="c1">// launch morphology</span>
<span class="linenos">1106</span><span class="k">if</span><span class="p">(</span><span class="nx">morphology_on</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span>
<span class="linenos">1107</span><span class="p">{</span>
<span class="linenos">1108</span>    <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">classified1</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="nx">classified1</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="nx">classified1</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)).</span><span class="nx">toInt</span><span class="p">().</span><span class="nx">clamp</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">);</span>
<span class="linenos">1109</span>    <span class="nx">classified1</span> <span class="o">=</span> <span class="nx">morph_adjustment</span><span class="p">(</span><span class="nx">tmp</span><span class="p">,</span> <span class="nx">radius1</span><span class="p">,</span> <span class="nx">radius2</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">);</span>
<span class="linenos">1110</span><span class="p">}</span>
<span class="linenos">1111</span>
<span class="linenos">1112</span><span class="k">return</span> <span class="nx">classified1</span><span class="p">;</span>
<span class="linenos">1113</span>
<span class="linenos">1114</span><span class="p">}</span>
<span class="linenos">1115</span>
<span class="linenos">1116</span><span class="c1">// compute the area of the classification</span>
<span class="linenos">1117</span><span class="kd">function</span> <span class="nx">computeArea</span><span class="p">(</span><span class="nx">input_img</span><span class="p">,</span> <span class="nx">polygon</span><span class="p">,</span> <span class="nx">year</span><span class="p">)</span>
<span class="linenos">1118</span><span class="p">{</span>
<span class="linenos">1119</span><span class="c1">// Calculate area</span>
<span class="linenos">1120</span><span class="kd">var</span> <span class="nx">areaImage</span> <span class="o">=</span> <span class="nx">input_img</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">pixelArea</span><span class="p">());</span>
<span class="linenos">1121</span><span class="kd">var</span> <span class="nx">stats</span> <span class="o">=</span> <span class="nx">areaImage</span><span class="p">.</span><span class="nx">reduceRegion</span><span class="p">(</span>
<span class="linenos">1122</span>    <span class="p">{</span>
<span class="linenos">1123</span>    <span class="s1">&#39;reducer&#39;</span><span class="o">:</span> <span class="nx">ee</span><span class="p">.</span><span class="nx">Reducer</span><span class="p">.</span><span class="nx">sum</span><span class="p">(),</span>
<span class="linenos">1124</span>    <span class="s1">&#39;geometry&#39;</span><span class="o">:</span> <span class="nx">polygon</span><span class="p">,</span>
<span class="linenos">1125</span>    <span class="s1">&#39;maxPixels&#39;</span><span class="o">:</span> <span class="mf">5e9</span><span class="p">,</span>
<span class="linenos">1126</span>    <span class="s1">&#39;scale&#39;</span><span class="o">:</span> <span class="nx">area_scale</span><span class="p">,</span>
<span class="linenos">1127</span>    <span class="s1">&#39;bestEffort&#39;</span><span class="o">:</span> <span class="kc">true</span>
<span class="linenos">1128</span>    <span class="p">});</span>
<span class="linenos">1129</span><span class="nx">print</span><span class="p">(</span><span class="s1">&#39;Area &#39;</span> <span class="o">+</span> <span class="nx">year</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">stats</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">classification</span><span class="o">/</span><span class="mf">10e5</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; KM^2&#39;</span><span class="p">);</span>
<span class="linenos">1130</span><span class="p">}</span>
<span class="linenos">1131</span>
<span class="linenos">1132</span><span class="c1">// ===================================== //</span>
<span class="linenos">1133</span><span class="c1">//             Main function             //</span>
<span class="linenos">1134</span><span class="c1">// ===================================== //</span>
<span class="linenos">1135</span>
<span class="linenos">1136</span><span class="kd">var</span> <span class="nx">img_min</span> <span class="o">=</span> <span class="p">(</span><span class="nx">collection_type</span><span class="o">===</span><span class="s1">&#39;simplecomposite&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;3&#39;</span><span class="o">:</span> <span class="s1">&#39;0.038&#39;</span><span class="p">;</span>
<span class="linenos">1137</span><span class="kd">var</span> <span class="nx">img_max</span> <span class="o">=</span> <span class="p">(</span><span class="nx">collection_type</span><span class="o">===</span><span class="s1">&#39;simplecomposite&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;63&#39;</span><span class="o">:</span> <span class="s1">&#39;0.23&#39;</span><span class="p">;</span>
<span class="linenos">1138</span><span class="kd">var</span> <span class="nx">red</span> <span class="o">=</span> <span class="nx">sensor</span><span class="o">===</span><span class="s2">&quot;L8&quot;</span> <span class="o">?</span> <span class="s1">&#39;B4&#39;</span> <span class="o">:</span> <span class="s1">&#39;B3&#39;</span><span class="p">;</span>
<span class="linenos">1139</span><span class="kd">var</span> <span class="nx">green</span> <span class="o">=</span> <span class="nx">sensor</span><span class="o">===</span><span class="s2">&quot;L8&quot;</span> <span class="o">?</span> <span class="s1">&#39;B3&#39;</span> <span class="o">:</span> <span class="s1">&#39;B2&#39;</span><span class="p">;</span>
<span class="linenos">1140</span><span class="kd">var</span> <span class="nx">blue</span> <span class="o">=</span> <span class="nx">sensor</span><span class="o">===</span><span class="s2">&quot;L8&quot;</span> <span class="o">?</span> <span class="s1">&#39;B2&#39;</span> <span class="o">:</span> <span class="s1">&#39;B1&#39;</span><span class="p">;</span>
<span class="linenos">1141</span>
<span class="linenos">1142</span><span class="c1">// load the basic image</span>
<span class="linenos">1143</span><span class="kd">var</span> <span class="nx">image_base</span> <span class="o">=</span> <span class="nx">input_selector</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">collection_type</span><span class="p">,</span> <span class="nx">sensor</span><span class="p">,</span> <span class="nx">cloud_cover</span><span class="p">,</span> <span class="nx">polygon1</span><span class="p">);</span>
<span class="linenos">1144</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">image_base</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">red</span><span class="p">,</span><span class="nx">green</span><span class="p">,</span><span class="nx">blue</span><span class="p">),{</span><span class="nx">min</span><span class="o">:</span> <span class="nx">img_min</span><span class="p">,</span> <span class="nx">max</span><span class="o">:</span> <span class="nx">img_max</span><span class="p">},</span><span class="s1">&#39;Year &#39;</span><span class="o">+</span> <span class="nx">year</span><span class="p">);</span>
<span class="linenos">1145</span>
<span class="linenos">1146</span>
<span class="linenos">1147</span><span class="cm">/*** Ground Truth ***/</span>
<span class="linenos">1148</span><span class="k">if</span><span class="p">(</span><span class="nx">GT_enable</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1149</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">GT_selectedRegions</span><span class="p">,</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;900000&#39;</span><span class="p">},</span> <span class="s1">&#39;Ground Truth&#39;</span><span class="p">);</span>
<span class="linenos">1150</span>
<span class="linenos">1151</span><span class="cm">/*** Training set initilization ***/</span>
<span class="linenos">1152</span><span class="kd">var</span> <span class="nx">ft</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos">1153</span>
<span class="linenos">1154</span><span class="k">if</span><span class="p">(</span><span class="nx">ts_type</span><span class="o">===</span><span class="mf">0</span><span class="p">)</span> <span class="c1">// Fusion table ts</span>
<span class="linenos">1155</span><span class="p">{</span>
<span class="linenos">1156</span><span class="kd">var</span> <span class="nx">tables_array</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">ft17</span><span class="p">);</span> <span class="c1">// INSERT THE CODE(S) OF THE FUSION TABLE(S) TO USE</span>
<span class="linenos">1157</span><span class="nx">ft</span> <span class="o">=</span> <span class="nx">training_selector</span><span class="p">(</span><span class="nx">tables_array</span><span class="p">);</span>
<span class="linenos">1158</span>
<span class="linenos">1159</span><span class="p">}</span>
<span class="linenos">1160</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">ts_type</span><span class="o">===</span><span class="mf">1</span><span class="p">)</span> <span class="c1">// Globcover ts</span>
<span class="linenos">1161</span><span class="p">{</span>
<span class="linenos">1162</span><span class="c1">// random training set</span>
<span class="linenos">1163</span><span class="kd">var</span> <span class="nx">trainingPoints</span> <span class="o">=</span> <span class="nx">getPoints</span><span class="p">(</span><span class="nx">getPoly</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span><span class="nx">lat</span><span class="p">),</span> <span class="nx">num_points</span><span class="p">);</span>
<span class="linenos">1164</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">trainingPoints</span><span class="p">,</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;00ffff&#39;</span><span class="p">},</span> <span class="s1">&#39;Random Points&#39;</span><span class="p">);</span>
<span class="linenos">1165</span><span class="nx">ft</span> <span class="o">=</span> <span class="nx">ft</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">trainingPoints</span><span class="p">);</span>
<span class="linenos">1166</span><span class="p">}</span>
<span class="linenos">1167</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">ts_type</span><span class="o">===</span><span class="mf">2</span><span class="p">)</span> <span class="c1">// Universe of cities TS</span>
<span class="linenos">1168</span><span class="p">{</span>
<span class="linenos">1169</span><span class="c1">// visualize cities</span>
<span class="linenos">1170</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">selectedCities</span><span class="p">,</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;900000&#39;</span><span class="p">},</span> <span class="s1">&#39;Cities&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
<span class="linenos">1171</span><span class="c1">// generate training set</span>
<span class="linenos">1172</span>    <span class="c1">// generate training set</span>
<span class="linenos">1173</span><span class="k">if</span><span class="p">(</span><span class="nx">multi_random</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1174</span><span class="p">{</span>
<span class="linenos">1175</span>    <span class="kd">var</span> <span class="nx">ft_1</span> <span class="o">=</span> <span class="nx">ts_generator</span><span class="p">(</span><span class="nx">polygon1</span><span class="p">,</span> <span class="nx">num_points</span><span class="p">,</span> <span class="nx">selectedCities</span><span class="p">,</span> <span class="nx">seeds</span><span class="p">[</span><span class="mf">0</span><span class="p">]);</span>
<span class="linenos">1176</span>    <span class="kd">var</span> <span class="nx">ft_2</span> <span class="o">=</span> <span class="nx">ts_generator</span><span class="p">(</span><span class="nx">polygon1</span><span class="p">,</span> <span class="nx">num_points</span><span class="p">,</span> <span class="nx">selectedCities</span><span class="p">,</span> <span class="nx">seeds</span><span class="p">[</span><span class="mf">1</span><span class="p">]);</span>
<span class="linenos">1177</span>    <span class="kd">var</span> <span class="nx">ft_3</span> <span class="o">=</span> <span class="nx">ts_generator</span><span class="p">(</span><span class="nx">polygon1</span><span class="p">,</span> <span class="nx">num_points</span><span class="p">,</span> <span class="nx">selectedCities</span><span class="p">,</span> <span class="nx">seeds</span><span class="p">[</span><span class="mf">2</span><span class="p">]);</span>
<span class="linenos">1178</span>    <span class="nx">ft</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">ft_1</span><span class="p">,</span> <span class="nx">ft_2</span><span class="p">,</span> <span class="nx">ft_3</span><span class="p">);</span>
<span class="linenos">1179</span><span class="p">}</span><span class="k">else</span>
<span class="linenos">1180</span>    <span class="nx">ft</span> <span class="o">=</span> <span class="nx">ts_generator</span><span class="p">(</span><span class="nx">polygon1</span><span class="p">,</span> <span class="nx">num_points</span><span class="p">,</span> <span class="nx">selectedCities</span><span class="p">);</span>
<span class="linenos">1181</span><span class="p">}</span>
<span class="linenos">1182</span><span class="k">if</span><span class="p">(</span><span class="nx">multi_random</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1183</span><span class="p">{</span>
<span class="linenos">1184</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ft</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span><span class="s2">&quot;00ffff&quot;</span><span class="p">},</span> <span class="s1">&#39;Features Points seed1&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="linenos">1185</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ft</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span><span class="s2">&quot;00ff00&quot;</span><span class="p">},</span> <span class="s1">&#39;Features Points seed2&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="linenos">1186</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ft</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span><span class="s2">&quot;ff00ff&quot;</span><span class="p">},</span> <span class="s1">&#39;Features Points seed3&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="linenos">1187</span><span class="p">}</span>
<span class="linenos">1188</span><span class="k">else</span>
<span class="linenos">1189</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ft</span><span class="p">,</span> <span class="p">{</span><span class="nx">color</span><span class="o">:</span><span class="s2">&quot;00ffff&quot;</span><span class="p">},</span> <span class="s1">&#39;Features Points&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="linenos">1190</span>
<span class="linenos">1191</span><span class="cm">/*** array of classifications ***/</span>
<span class="linenos">1192</span><span class="kd">var</span> <span class="nx">class_array</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos">1193</span>
<span class="linenos">1194</span><span class="cm">/*** first classification ***/</span>
<span class="linenos">1195</span><span class="kd">var</span> <span class="nx">classified</span> <span class="o">=</span> <span class="nx">image_classification</span><span class="p">(</span><span class="nx">image_base</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="nx">year</span><span class="p">);</span>
<span class="linenos">1196</span><span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">mask</span><span class="p">(</span><span class="nx">classified</span><span class="p">),</span> <span class="nx">palette_list</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="s1">&#39;Classified Mask &#39;</span><span class="o">+</span> <span class="nx">year</span><span class="p">);</span>
<span class="linenos">1197</span><span class="nx">class_array</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">classified</span><span class="p">);</span>
<span class="linenos">1198</span><span class="k">if</span><span class="p">(</span><span class="nx">compute_area</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1199</span><span class="nx">computeArea</span><span class="p">(</span><span class="nx">classified</span><span class="p">,</span> <span class="nx">polygon1</span><span class="p">,</span> <span class="nx">year</span><span class="p">);</span>
<span class="linenos">1200</span>
<span class="linenos">1201</span><span class="cm">/*** Loop on all the years ***/</span>
<span class="linenos">1202</span><span class="kd">var</span> <span class="nx">classified_tmp</span><span class="p">;</span>
<span class="linenos">1203</span><span class="kd">var</span> <span class="nx">classified_collection_tmp</span><span class="p">;</span>
<span class="linenos">1204</span><span class="kd">var</span> <span class="nx">palette_index</span> <span class="o">=</span> <span class="mf">1</span><span class="p">;</span>
<span class="linenos">1205</span><span class="kd">var</span> <span class="nx">global_mask</span> <span class="o">=</span> <span class="nx">classified</span><span class="p">;</span>
<span class="linenos">1206</span><span class="kd">var</span> <span class="nx">classified_collection</span><span class="p">;</span>
<span class="linenos">1207</span>
<span class="linenos">1208</span>
<span class="linenos">1209</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="nx">step</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">number_of_years</span><span class="p">;</span> <span class="nx">i</span><span class="o">+=</span><span class="nx">step</span><span class="p">)</span>
<span class="linenos">1210</span><span class="p">{</span>
<span class="linenos">1211</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span>
<span class="linenos">1212</span><span class="k">while</span><span class="p">(</span><span class="nx">x</span><span class="o">&lt;=</span><span class="nx">step</span><span class="p">)</span>
<span class="linenos">1213</span><span class="p">{</span>
<span class="linenos">1214</span>    <span class="k">if</span><span class="p">(</span><span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="o">&gt;=</span><span class="mf">2013</span><span class="p">)</span>
<span class="linenos">1215</span>    <span class="p">{</span>
<span class="linenos">1216</span>    <span class="nx">sensor</span> <span class="o">=</span> <span class="s1">&#39;L8&#39;</span><span class="p">;</span>
<span class="linenos">1217</span>    <span class="p">}</span>
<span class="linenos">1218</span>    <span class="k">if</span><span class="p">(</span><span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="o">&lt;</span><span class="mf">2013</span> <span class="o">&amp;&amp;</span> <span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="o">&gt;</span><span class="mf">2000</span><span class="p">)</span>
<span class="linenos">1219</span>    <span class="p">{</span>
<span class="linenos">1220</span>    <span class="nx">sensor</span> <span class="o">=</span> <span class="s1">&#39;L7&#39;</span><span class="p">;</span>
<span class="linenos">1221</span>    <span class="p">}</span>
<span class="linenos">1222</span>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="o">&lt;=</span><span class="mf">2000</span> <span class="o">&amp;&amp;</span> <span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="o">&gt;</span><span class="mf">1995</span><span class="p">)</span>
<span class="linenos">1223</span>    <span class="p">{</span>
<span class="linenos">1224</span>    <span class="nx">sensor</span> <span class="o">=</span> <span class="s1">&#39;L5&#39;</span><span class="p">;</span>
<span class="linenos">1225</span>    <span class="p">}</span>
<span class="linenos">1226</span>    <span class="k">else</span>
<span class="linenos">1227</span>    <span class="p">{</span>
<span class="linenos">1228</span>    <span class="nx">sensor</span> <span class="o">=</span> <span class="s1">&#39;L45&#39;</span><span class="p">;</span>
<span class="linenos">1229</span>    <span class="nx">collection_type</span> <span class="o">=</span> <span class="s1">&#39;standard&#39;</span><span class="p">;</span>
<span class="linenos">1230</span>    <span class="p">}</span>
<span class="linenos">1231</span>
<span class="linenos">1232</span>    <span class="nx">image_base</span> <span class="o">=</span> <span class="nx">input_selector</span><span class="p">((</span><span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="p">),</span> <span class="nx">collection_type</span><span class="p">,</span> <span class="nx">sensor</span><span class="p">,</span> <span class="nx">cloud_cover</span><span class="p">,</span> <span class="nx">polygon1</span><span class="p">);</span>
<span class="linenos">1233</span>
<span class="linenos">1234</span>    <span class="k">if</span><span class="p">(</span><span class="nx">image_base</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">().</span><span class="nx">bands</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mf">0</span><span class="p">)</span>
<span class="linenos">1235</span>    <span class="p">{</span>
<span class="linenos">1236</span>
<span class="linenos">1237</span>    <span class="nx">classified_tmp</span> <span class="o">=</span> <span class="nx">image_classification</span><span class="p">(</span><span class="nx">image_base</span><span class="p">,</span> <span class="nx">ft</span><span class="p">,</span> <span class="p">(</span><span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="p">));</span>
<span class="linenos">1238</span>
<span class="linenos">1239</span>    <span class="k">if</span><span class="p">(</span><span class="nx">class_or_flag</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1240</span>    <span class="p">{</span>
<span class="linenos">1241</span>        <span class="nx">class_array</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">classified_tmp</span><span class="p">);</span>
<span class="linenos">1242</span>        <span class="nx">global_mask</span> <span class="o">=</span> <span class="nx">global_mask</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">classified_tmp</span><span class="p">);</span>
<span class="linenos">1243</span>
<span class="linenos">1244</span>    <span class="p">}</span><span class="k">else</span>
<span class="linenos">1245</span>    <span class="p">{</span>
<span class="linenos">1246</span>        <span class="c1">// logical AND with the previous year classification</span>
<span class="linenos">1247</span>        <span class="nx">classified</span> <span class="o">=</span> <span class="nx">classified_tmp</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">classified</span><span class="p">);</span>
<span class="linenos">1248</span>        <span class="k">if</span><span class="p">(</span><span class="nx">compute_area</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1249</span>        <span class="nx">computeArea</span><span class="p">(</span><span class="nx">classified</span><span class="p">,</span> <span class="nx">polygon1</span><span class="p">,</span> <span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="p">);</span>
<span class="linenos">1250</span>        <span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">mask</span><span class="p">(</span><span class="nx">classified</span><span class="p">),</span> <span class="nx">palette_list</span><span class="p">[</span><span class="nx">palette_index</span><span class="p">],</span> <span class="s1">&#39;Classified AND Mask &#39;</span><span class="o">+</span> <span class="p">(</span><span class="nx">year</span><span class="o">-</span><span class="nx">i</span><span class="p">));</span>
<span class="linenos">1251</span>    <span class="p">}</span>
<span class="linenos">1252</span>    <span class="nx">x</span> <span class="o">=</span> <span class="nx">step</span><span class="o">+</span><span class="mf">1</span><span class="p">;</span>
<span class="linenos">1253</span>    <span class="nx">palette_index</span><span class="o">++</span><span class="p">;</span>
<span class="linenos">1254</span>    <span class="p">}</span>
<span class="linenos">1255</span>    <span class="k">else</span>
<span class="linenos">1256</span>    <span class="p">{</span>
<span class="linenos">1257</span>    <span class="nx">x</span><span class="o">++</span><span class="p">;</span>
<span class="linenos">1258</span>    <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
<span class="linenos">1259</span>    <span class="p">}</span>
<span class="linenos">1260</span>
<span class="linenos">1261</span><span class="p">}</span>
<span class="linenos">1262</span><span class="p">}</span>
<span class="linenos">1263</span>
<span class="linenos">1264</span><span class="k">if</span><span class="p">(</span><span class="nx">class_or_flag</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1265</span><span class="p">{</span>
<span class="linenos">1266</span><span class="c1">// update global mask</span>
<span class="linenos">1267</span><span class="nx">global_mask</span> <span class="o">=</span> <span class="nx">global_mask</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">closing</span><span class="p">(</span><span class="nx">class_array</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="nx">class_morph_radius</span><span class="p">,</span> <span class="nx">kernelType</span><span class="p">,</span> <span class="nx">units</span><span class="p">));</span>
<span class="linenos">1268</span><span class="c1">// visualize the corrected classified images</span>
<span class="linenos">1269</span><span class="kd">var</span> <span class="nx">dim</span> <span class="o">=</span> <span class="nx">class_array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="linenos">1270</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mf">1</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">dim</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">1271</span><span class="p">{</span>
<span class="linenos">1272</span>    <span class="nx">classified</span> <span class="o">=</span> <span class="nx">class_array</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">and</span><span class="p">(</span><span class="nx">global_mask</span><span class="p">);</span>
<span class="linenos">1273</span>    <span class="nx">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Image</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">mask</span><span class="p">(</span><span class="nx">classified</span><span class="p">),</span> <span class="nx">palette_list</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span> <span class="s1">&#39;Classified AND Mask &#39;</span><span class="o">+</span> <span class="p">(</span><span class="nx">year</span><span class="o">-</span><span class="p">(</span><span class="nx">step</span><span class="o">*</span><span class="nx">j</span><span class="p">)));</span>
<span class="linenos">1274</span>    <span class="k">if</span><span class="p">(</span><span class="nx">compute_area</span><span class="o">===</span><span class="kc">true</span><span class="p">)</span>
<span class="linenos">1275</span>    <span class="nx">computeArea</span><span class="p">(</span><span class="nx">classified</span><span class="p">,</span> <span class="nx">polygon1</span><span class="p">,</span> <span class="nx">year</span><span class="o">-</span><span class="p">(</span><span class="nx">step</span><span class="o">*</span><span class="nx">j</span><span class="p">));</span>
<span class="linenos">1276</span><span class="p">}</span>
<span class="linenos">1277</span>
<span class="linenos">1278</span><span class="p">}</span>
<span class="linenos">1279</span>
<span class="linenos">1280</span><span class="c1">// autocenter map</span>
<span class="linenos">1281</span><span class="k">if</span><span class="p">(</span><span class="nx">center_on</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="linenos">1282</span><span class="nx">autoCenterMap</span><span class="p">(</span><span class="nx">polygon1</span><span class="p">,</span> <span class="nx">zoom</span><span class="p">);</span>
<span class="linenos">1283</span><span class="k">else</span>
<span class="linenos">1284</span><span class="nx">autoCenterMap</span><span class="p">(</span><span class="nx">cities_table</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;MAIN_CITY&#39;</span><span class="p">,</span> <span class="nx">center_on</span><span class="p">)).</span><span class="nx">geometry</span><span class="p">(),</span> <span class="nx">zoom</span><span class="o">+</span><span class="mf">4</span><span class="p">);</span>
<span class="linenos">1285</span>
<span class="linenos">1286</span><span class="c1">//多行注释</span>
<span class="linenos">1287</span><span class="cm">/*</span>
<span class="linenos">1288</span><span class="cm">// download</span>
<span class="linenos">1289</span><span class="cm">exportImage(result_morph, task_name,</span>
<span class="linenos">1290</span><span class="cm">{</span>
<span class="linenos">1291</span><span class="cm">&#39;crs&#39;:&#39;EPSG:4326&#39;,</span>
<span class="linenos">1292</span><span class="cm">&#39;scale&#39;:30,</span>
<span class="linenos">1293</span><span class="cm">&#39;region&#39;:JSON.stringify(polygon1.getInfo().coordinates),</span>
<span class="linenos">1294</span><span class="cm">&#39;maxPixels&#39;:13000000000,</span>
<span class="linenos">1295</span><span class="cm">&#39;driveFolder&#39;:&#39;prova&#39;</span>
<span class="linenos">1296</span><span class="cm">});</span>
<span class="linenos">1297</span><span class="cm">*/</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="50_plots.html" class="btn btn-neutral float-right" title="Scientific Plots" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="10_sphinx_rst.html" class="btn btn-neutral" title="Sphinx" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, AdamZhou.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ❤️  using a custom <a href="https://github.com/LinxiFan/Stanford-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>